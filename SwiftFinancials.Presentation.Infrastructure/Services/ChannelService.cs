using Infrastructure.Crosscutting.Framework.Logging;
using System;
using System.Collections.Generic;
using System.ComponentModel.Composition;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using SwiftFinancials.Presentation.Contracts.MembershipModule;
using Infrastructure.Crosscutting.Framework.Utils;
using System.Collections.ObjectModel;
using Application.MainBoundedContext.DTO.AdministrationModule;
using SwiftFinancials.Presentation.Contracts.AdministrationModule;
using Application.MainBoundedContext.DTO;
using SwiftFinancials.Presentation.Contracts.MicroCreditModule;
using Application.MainBoundedContext.DTO.MicroCreditModule;
using SwiftFinancials.Presentation.Contracts.MessagingModule;
using Application.MainBoundedContext.DTO.MessagingModule;
using Infrastructure.Crosscutting.Framework.Extensions;
using Application.MainBoundedContext.DTO.RegistryModule;
using SwiftFinancials.Presentation.Contracts.RegistryModule;
using Application.MainBoundedContext.DTO.HumanResourcesModule;
using SwiftFinancials.Presentation.Contracts.HumanResourcesModule;
using System.ServiceModel;
using Application.MainBoundedContext.DTO.AccountsModule;
using SwiftFinancials.Presentation.Contracts.AccountsModule;
using Application.MainBoundedContext.DTO.BackOfficeModule;
using SwiftFinancials.Presentation.Contracts.BackOfficeModule;
using SwiftFinancials.Presentation.Contracts.FrontOfficeModule;
using Application.MainBoundedContext.DTO.FrontOfficeModule;
using SwiftFinancials.Presentation.Infrastructure.Models;
using System.ServiceModel.Description;
using SwiftFinancials.Presentation.Contracts;
using DistributedServices.Seedwork.ErrorHandlers;
using SwiftFinancials.Presentation.Infrastructure.Disposable;
using DistributedServices.Seedwork.EndpointBehaviors;

namespace SwiftFinancials.Presentation.Infrastructure.Services
{
    [Export(typeof(IChannelService))]
    public class ChannelService : IChannelService
    {
        private static readonly object SyncRoot = new object();

        private readonly Dictionary<string, object> _channelFactoryHashtable;

#if SILVERLIGHT
        private readonly SwiftFinancials.Common.Notification.IMessageService _messageService;

        public ChannelService(SwiftFinancials.Common.Notification.IMessageService messageService)
        {
            Microsoft.Practices.Unity.Utility.Guard.ArgumentNotNull(messageService, nameof(messageService));

            _messageService = messageService;

            _channelFactoryHashtable = new Dictionary<string, object>();
        }
#else
        private readonly ILogger _logger;

        [ImportingConstructor]
        public ChannelService(ILogger logger)
        {
            if (logger == null)
                throw new ArgumentNullException(nameof(logger));

            _logger = logger;
            _channelFactoryHashtable = new Dictionary<string, object>();
        }
#endif

        #region Membership

        public Task<bool> AuthenticateAsync(string domain, string userName, string password, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            DefaultSettings.Instance.CurrentAppDomainName = domain;

            DefaultSettings.Instance.CurrentAppUserName = userName;

            DefaultSettings.Instance.CurrentAppUserPassword = password;

            IUserManagerService service = GetService<IUserManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUserManagerService)result.AsyncState).EndAuthenticate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        DefaultSettings.Instance.CurrentAppUserName = null;

                        DefaultSettings.Instance.CurrentAppUserPassword = null;

                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthenticate(userName, password, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<string>> GetRolesForUserAsync(string userName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<string>>();

            IUserManagerService service = GetService<IUserManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string[] response = ((IUserManagerService)result.AsyncState).EndGetRoles(result);

                    tcs.TrySetResult(new ObservableCollection<string>(response ?? new string[] { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetRoles(userName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<PermissionWrapperDTO>> IsUserAuthorizedToAccessNavigationItemsAsync(string userName, List<PermissionWrapperDTO> permissionWrappers, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<PermissionWrapperDTO>>();

            IUserManagerService service = GetService<IUserManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PermissionWrapperDTO> response = ((IUserManagerService)result.AsyncState).EndIsUserAuthorizedToAccessNavigationItems(result);

                    tcs.TrySetResult(new ObservableCollection<PermissionWrapperDTO>(response ?? permissionWrappers));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginIsUserAuthorizedToAccessNavigationItems(userName, permissionWrappers, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> IsUserAuthorizedToAccessSystemPermissionTypeAsync(string userName, int systemPermissionType, Guid? targetBranchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUserManagerService service = GetService<IUserManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUserManagerService)result.AsyncState).EndIsUserAuthorizedToAccessSystemPermissionType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginIsUserAuthorizedToAccessSystemPermissionType(userName, systemPermissionType, targetBranchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> IsUserAuthorizedToAccessCustomerFileAsync(string userName, Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUserManagerService service = GetService<IUserManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUserManagerService)result.AsyncState).EndIsUserAuthorizedToAccessCustomerFile(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginIsUserAuthorizedToAccessCustomerFile(userName, customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDTO> GetUserInfoAsync(string userName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDTO>();

            IMembershipManagerService service = GetService<IMembershipManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDTO response = ((IMembershipManagerService)result.AsyncState).EndGetUserInfo(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetUserInfo(userName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EmployeeDTO>> GetUserInfoCollectionAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployeeDTO>>();

            IMembershipManagerService service = GetService<IMembershipManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeDTO> response = ((IMembershipManagerService)result.AsyncState).EndGetUserInfoCollection(result);

                    tcs.TrySetResult(new ObservableCollection<EmployeeDTO>(response ?? new List<EmployeeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetUserInfoCollection(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EmployeeDTO>> GetUserInfoCollectionInRoleAsync(string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployeeDTO>>();

            IMembershipManagerService service = GetService<IMembershipManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeDTO> response = ((IMembershipManagerService)result.AsyncState).EndGetUserInfoCollectionInRole(result);

                    tcs.TrySetResult(new ObservableCollection<EmployeeDTO>(response ?? new List<EmployeeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetUserInfoCollectionInRole(roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDTO>> GetUserInfoCollectionInPageAsync(int pageIndex, int pageSize, string filter, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDTO>>();

            IMembershipManagerService service = GetService<IMembershipManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDTO> response = ((IMembershipManagerService)result.AsyncState).EndGetUserInfoCollectionInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetUserInfoCollectionInPage(pageIndex, pageSize, filter, asyncCallback, service);

            return tcs.Task;
        }

        public Task<int> CreateUserAsync(EmployeeDTO employeeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<int>();

            IMembershipManagerService service = GetService<IMembershipManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    int response = ((IMembershipManagerService)result.AsyncState).EndCreateUser(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCreateUser(employeeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateUserAsync(EmployeeDTO employeeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMembershipManagerService service = GetService<IMembershipManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMembershipManagerService)result.AsyncState).EndUpdateUser(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateUser(employeeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<string>> GetAllRolesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<string>>();

            IRoleManagerService service = GetService<IRoleManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string[] response = ((IRoleManagerService)result.AsyncState).EndGetAllRoles(result);

                    tcs.TrySetResult(new ObservableCollection<string>(response ?? new string[] { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetAllRoles(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<string>> GetUsersInRoleAsync(string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<string>>();

            IRoleManagerService service = GetService<IRoleManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string[] response = ((IRoleManagerService)result.AsyncState).EndGetUsersInRole(result);

                    tcs.TrySetResult(new ObservableCollection<string>(response ?? new string[] { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetUsersInRole(roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CreateRoleAsync(string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRoleManagerService service = GetService<IRoleManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRoleManagerService)result.AsyncState).EndCreateRole(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCreateRole(roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveUserFromRolesAsync(string userName, ObservableCollection<string> roles, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRoleManagerService service = GetService<IRoleManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRoleManagerService)result.AsyncState).EndRemoveUserFromRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveUserFromRoles(userName, roles.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddUserToRolesAsync(string userName, ObservableCollection<string> roles, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRoleManagerService service = GetService<IRoleManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRoleManagerService)result.AsyncState).EndAddUserToRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddUserToRoles(userName, roles.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PasswordSettings> GetSettingsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PasswordSettings>();

            IPasswordManagerService service = GetService<IPasswordManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PasswordSettings response = ((IPasswordManagerService)result.AsyncState).EndGetSettings(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetSettings(asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ChangePasswordWithAnswerAsync(string userName, string newPassword, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IPasswordManagerService service = GetService<IPasswordManagerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IPasswordManagerService)result.AsyncState).EndChangePasswordWithAnswer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginChangePasswordWithAnswer(userName, newPassword, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region MembershipSevice

        public Task<PageCollectionInfo<UserDTO>> FindMembershipByFilterInPageAsync(string text, int pageIndex, int pageSize, List<string> sortFields, bool sortAscending, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<PageCollectionInfo<UserDTO>> tcs = new TaskCompletionSource<PageCollectionInfo<UserDTO>>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<UserDTO> response = ((IMembershipService)result.AsyncState).EndFindMembershipByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(null);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMembershipByFilterInPage(text, pageIndex, pageSize, sortFields, sortAscending, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<RoleDTO>> FindMembershipRolesByFilterInPageAsync(string text, int pageIndex, int pageSize, List<string> sortFields, bool sortAscending, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<PageCollectionInfo<RoleDTO>> tcs = new TaskCompletionSource<PageCollectionInfo<RoleDTO>>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<RoleDTO> response = ((IMembershipService)result.AsyncState).EndFindMembershipRolesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(null);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMembershipRolesByFilterInPage(text, pageIndex, pageSize, sortFields, sortAscending, asyncCallback, service);

            return tcs.Task;
        }

        public Task<UserDTO> AddNewMembershipAsync(UserDTO userDTO, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<UserDTO> tcs = new TaskCompletionSource<UserDTO>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    UserDTO response = ((IMembershipService)result.AsyncState).EndAddNewMembership(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(null);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewMembership(userDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateMembershipAsync(UserDTO userDTO, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<bool> tcs = new TaskCompletionSource<bool>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMembershipService)result.AsyncState).EndUpdateMembership(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(false);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateMembership(userDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<int> GetApplicationUsersCountAsync(ServiceHeader serviceHeader)
        {
            TaskCompletionSource<int> tcs = new TaskCompletionSource<int>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    int response = ((IMembershipService)result.AsyncState).EndGetApplicationUsersCount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(0);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetApplicationUsersCount(asyncCallback, service);

            return tcs.Task;
        }

        public Task<int> GetApplicationUsersCountByCompanyIdAsync(Guid companyId, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<int> tcs = new TaskCompletionSource<int>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    int response = ((IMembershipService)result.AsyncState).EndGetApplicationUsersCountByCompanyId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(0);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetApplicationUsersCountByCompanyId(companyId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<UserDTO> FindMembershipAsync(string id, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<UserDTO> tcs = new TaskCompletionSource<UserDTO>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    UserDTO response = ((IMembershipService)result.AsyncState).EndFindMembership(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(null);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMembership(id, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ResetMembershipPasswordAsync(UserDTO userDTO, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<bool> tcs = new TaskCompletionSource<bool>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMembershipService)result.AsyncState).EndResetMembershipPassword(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(false);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginResetMembershipPassword(userDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> VerifyMembershipAsync(UserDTO userDTO, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<bool> tcs = new TaskCompletionSource<bool>();

            IMembershipService service = GetService<IMembershipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMembershipService)result.AsyncState).EndVerifyMembership(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(false);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginVerifyMembership(userDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CompanyDTO

        public Task<List<CompanyDTO>> FindCompaniesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<CompanyDTO>>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CompanyDTO> response = ((ICompanyService)result.AsyncState).EndFindCompanies(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCompanies(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CompanyDTO>> FindCompaniesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CompanyDTO>>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CompanyDTO> response = ((ICompanyService)result.AsyncState).EndFindCompaniesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCompaniesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CompanyDTO>> FindCompaniesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CompanyDTO>>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CompanyDTO> response = ((ICompanyService)result.AsyncState).EndFindCompaniesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCompaniesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CompanyDTO> AddCompanyAsync(CompanyDTO companyDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CompanyDTO>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CompanyDTO response = ((ICompanyService)result.AsyncState).EndAddCompany(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCompany(companyDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCompanyAsync(CompanyDTO companyDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICompanyService)result.AsyncState).EndUpdateCompany(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCompany(companyDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CompanyDTO> FindCompanyAsync(Guid companyId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CompanyDTO>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CompanyDTO response = ((ICompanyService)result.AsyncState).EndFindCompany(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCompany(companyId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DebitTypeDTO>> FindDebitTypesByCompanyIdAsync(Guid companyId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DebitTypeDTO>>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitTypeDTO> response = ((ICompanyService)result.AsyncState).EndFindDebitTypesByCompanyId(result);

                    tcs.TrySetResult(new ObservableCollection<DebitTypeDTO>(response ?? new List<DebitTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitTypesByCompanyId(companyId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDebitTypesByCompanyIdAsync(Guid companyId, ObservableCollection<DebitTypeDTO> debitTypes, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICompanyService)result.AsyncState).EndUpdateDebitTypesByCompanyId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDebitTypesByCompanyId(companyId, debitTypes.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ProductCollectionInfo> FindAttachedProductsByCompanyIdAsync(Guid companyId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ProductCollectionInfo>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ProductCollectionInfo response = ((ICompanyService)result.AsyncState).EndFindAttachedProductsByCompanyId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAttachedProductsByCompanyId(companyId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAttachedProductsByCompanyIdAsync(Guid companyId, ProductCollectionInfo attachedProductsTuple, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICompanyService)result.AsyncState).EndUpdateAttachedProductsByCompanyId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAttachedProductsByCompanyId(companyId, attachedProductsTuple, asyncCallback, service);

            return tcs.Task;
        }

        public Task<int> GetCompaniesCountAsync(ServiceHeader serviceHeader)
        {
            TaskCompletionSource<int> tcs = new TaskCompletionSource<int>();

            ICompanyService service = GetService<ICompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    int response = ((ICompanyService)result.AsyncState).EndGetCompaniesCount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(0);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetCompaniesCount(asyncCallback, service);

            return tcs.Task;
        }


        #endregion

        #region AuditLogDTO

        public Task<AuditLogDTO> AddAuditLogAsync(AuditLogDTO auditLogDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AuditLogDTO>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AuditLogDTO response = ((IAuditLogService)result.AsyncState).EndAddAuditLog(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAuditLog(auditLogDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddAuditLogsAsync(List<AuditLogDTO> auditLogDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAuditLogService)result.AsyncState).EndAddAuditLogs(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAuditLogs(auditLogDTOs, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AuditLogDTO>> FindAuditLogsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AuditLogDTO>>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AuditLogDTO> response = ((IAuditLogService)result.AsyncState).EndFindAuditLogsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAuditLogsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AuditLogDTO>> FindAuditLogsByDateRangeAndFilterInPageAsync(int pageIndex, int pageSize, DateTime startDate, DateTime endDate, string filter, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AuditLogDTO>>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AuditLogDTO> response = ((IAuditLogService)result.AsyncState).EndFindAuditLogsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAuditLogsByDateRangeAndFilterInPage(pageIndex, pageSize, startDate, endDate, filter, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region AuditTrailDTO

        public Task<bool> AddAuditTrailsAsync(List<AuditTrailDTO> auditTrailDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAuditLogService)result.AsyncState).EndAddAuditTrails(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAuditTrails(auditTrailDTOs, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AuditTrailDTO> AddAuditTrailAsync(AuditTrailDTO auditTrailDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AuditTrailDTO>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AuditTrailDTO response = ((IAuditLogService)result.AsyncState).EndAddAuditTrail(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAuditTrail(auditTrailDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AuditTrailDTO>> FindAuditTrailsByDateRangeAndFilterInPageAsync(int pageIndex, int pageSize, DateTime startDate, DateTime endDate, string filter, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AuditTrailDTO>>();

            IAuditLogService service = GetService<IAuditLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AuditTrailDTO> response = ((IAuditLogService)result.AsyncState).EndFindAuditTrailsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAuditTrailsByDateRangeAndFilterInPage(pageIndex, pageSize, startDate, endDate, filter, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FileUpload

        public Task<string> FileUploadAsync(FileData fileData, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<string>();

            IFileUploadService service = GetService<IFileUploadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string response = ((IFileUploadService)result.AsyncState).EndFileUpload(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFileUpload(fileData, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> FileUploadDoneAsync(string filename, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFileUploadService service = GetService<IFileUploadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFileUploadService)result.AsyncState).EndFileUploadDone(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFileUploadDone(filename, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PingNetworkAsync(string hostNameOrAddress, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFileUploadService service = GetService<IFileUploadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFileUploadService)result.AsyncState).EndPingNetwork(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPingNetwork(hostNameOrAddress, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region MediaDTO

        public string GetMediaHostName()
        {
            var channelFactory = GetChannelFactory<IMediaService>();

            return channelFactory.Endpoint.Address.Uri.Host;
        }

        public Task<string> MediaUploadAsync(FileData fileData, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<string>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string response = ((IMediaService)result.AsyncState).EndMediaUpload(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMediaUpload(fileData, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MediaUploadDoneAsync(string filename, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMediaService)result.AsyncState).EndMediaUploadDone(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMediaUploadDone(filename, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MediaDTO> GetMediaAsync(Guid sku, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MediaDTO>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MediaDTO response = ((IMediaService)result.AsyncState).EndGetMedia(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetMedia(sku, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostFileAsync(MediaDTO mediaDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMediaService)result.AsyncState).EndPostFile(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostFile(mediaDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostImageAsync(MediaDTO mediaDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMediaService)result.AsyncState).EndPostImage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostImage(mediaDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MediaDTO> PrintGeneralLedgerTransactionsByCustomerAccountIdAndDateRangeAsync(CustomerAccountDTO customerAccountDTO, DateTime startDate, DateTime endDate, bool chargeForPrinting, bool includeInterestStatement, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MediaDTO>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MediaDTO response = ((IMediaService)result.AsyncState).EndPrintGeneralLedgerTransactionsByCustomerAccountIdAndDateRange(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPrintGeneralLedgerTransactionsByCustomerAccountIdAndDateRange(customerAccountDTO, startDate, endDate, chargeForPrinting, includeInterestStatement, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MediaDTO> PrintLoanRepaymentScheduleAsync(LoanCaseDTO loanCaseDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MediaDTO>();

            IMediaService service = GetService<IMediaService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MediaDTO response = ((IMediaService)result.AsyncState).EndPrintLoanRepaymentSchedule(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPrintLoanRepaymentSchedule(loanCaseDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BranchDTO

        public Task<PageCollectionInfo<BranchDTO>> FindBranchesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BranchDTO>>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BranchDTO> response = ((IBranchService)result.AsyncState).EndFindBranchesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBranchesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BranchDTO>> FindBranchesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BranchDTO>>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BranchDTO> response = ((IBranchService)result.AsyncState).EndFindBranchesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBranchesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<BranchDTO>> FindBranchesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BranchDTO>>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BranchDTO> response = ((IBranchService)result.AsyncState).EndFindBranches(result);

                    tcs.TrySetResult(new ObservableCollection<BranchDTO>(response ?? new List<BranchDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBranches(asyncCallback, service);

            return tcs.Task;
        }

        public Task<BranchDTO> AddBranchAsync(BranchDTO branchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BranchDTO>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BranchDTO response = ((IBranchService)result.AsyncState).EndAddBranch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBranch(branchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBranchAsync(BranchDTO branchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBranchService)result.AsyncState).EndUpdateBranch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBranch(branchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BranchDTO> FindBranchAsync(Guid branchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BranchDTO>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BranchDTO response = ((IBranchService)result.AsyncState).EndFindBranch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBranch(branchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BranchDTO> FindBranchAsync(int branchCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BranchDTO>();

            IBranchService service = GetService<IBranchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BranchDTO response = ((IBranchService)result.AsyncState).EndFindBranchByCode(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBranchByCode(branchCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BankDTO

        public Task<PageCollectionInfo<BankDTO>> FindBanksInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankDTO>>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankDTO> response = ((IBankService)result.AsyncState).EndFindBanksInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBanksInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BankDTO>> FindBanksByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankDTO>>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankDTO> response = ((IBankService)result.AsyncState).EndFindBanksByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBanksByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankDTO> AddBankAsync(BankDTO bankDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankDTO>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankDTO response = ((IBankService)result.AsyncState).EndAddBank(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBank(bankDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBankAsync(BankDTO bankDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankService)result.AsyncState).EndUpdateBank(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBank(bankDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankDTO> FindBankAsync(Guid bankId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankDTO>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankDTO response = ((IBankService)result.AsyncState).EndFindBank(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBank(bankId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LocationDTO

        public Task<PageCollectionInfo<LocationDTO>> FindLocationsByFilterInPageAsync(string filter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LocationDTO>>();

            ILocationService service = GetService<ILocationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LocationDTO> response = ((ILocationService)result.AsyncState).EndFindLocationsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLocationsByFilterInPage(filter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LocationDTO>> FindLocationsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LocationDTO>>();

            ILocationService service = GetService<ILocationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LocationDTO> response = ((ILocationService)result.AsyncState).EndFindLocationsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLocationsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LocationDTO> AddLocationAsync(LocationDTO locationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LocationDTO>();

            ILocationService service = GetService<ILocationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LocationDTO response = ((ILocationService)result.AsyncState).EndAddLocation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLocation(locationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLocationAsync(LocationDTO locationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILocationService service = GetService<ILocationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILocationService)result.AsyncState).EndUpdateLocation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLocation(locationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LocationDTO> FindLocationAsync(Guid locationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LocationDTO>();

            ILocationService service = GetService<ILocationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LocationDTO response = ((ILocationService)result.AsyncState).EndFindLocation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLocation(locationId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BankBranchDTO

        public Task<ObservableCollection<BankBranchDTO>> FindBankBranchesByBankIdAsync(Guid bankId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BankBranchDTO>>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BankBranchDTO> response = ((IBankService)result.AsyncState).EndFindBankBranchesByBankId(result);

                    tcs.TrySetResult(new ObservableCollection<BankBranchDTO>(response ?? new List<BankBranchDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankBranchesByBankId(bankId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBankBranchesByBankIdAsync(Guid bankId, ObservableCollection<BankBranchDTO> bankBranches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankService service = GetService<IBankService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankService)result.AsyncState).EndUpdateBankBranchesByBankId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBankBranchesByBankId(bankId, bankBranches.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ReportDTO

        public Task<ObservableCollection<ReportDTO>> FindReportsAsync(bool updateDepth, bool traverseTree, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ReportDTO>>();

            IReportService service = GetService<IReportService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ReportDTO> response = ((IReportService)result.AsyncState).EndFindReports(result);

                    tcs.TrySetResult(new ObservableCollection<ReportDTO>(response ?? new List<ReportDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReports(updateDepth, traverseTree, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ReportDTO> AddReportAsync(ReportDTO reportDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ReportDTO>();

            IReportService service = GetService<IReportService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ReportDTO response = ((IReportService)result.AsyncState).EndAddReport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddReport(reportDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateReportAsync(ReportDTO reportDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IReportService service = GetService<IReportService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IReportService)result.AsyncState).EndUpdateReport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateReport(reportDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ReportDTO> FindReportAsync(Guid reportId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ReportDTO>();

            IReportService service = GetService<IReportService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ReportDTO response = ((IReportService)result.AsyncState).EndFindReport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReport(reportId, asyncCallback, service);

            return tcs.Task;
        }

        #region ReportDTO

        public Task<Tuple<ReportDTO, string>> AddNewReportAsync(ReportDTO reportDTO, ServiceHeader serviceHeader, double timeoutMinutes = 10)
        {
            TaskCompletionSource<Tuple<ReportDTO, string>> tcs = new TaskCompletionSource<Tuple<ReportDTO, string>>();

            IReportService service = GetService<IReportService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ReportDTO response = ((IReportService)result.AsyncState).EndAddNewReport(result);

                    tcs.TrySetResult(new Tuple<ReportDTO, string>(response, string.Empty));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginAddNewReport(reportDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateReportAsync(ReportDTO reportDTO, ServiceHeader serviceHeader, double timeoutMinutes = 10)
        {
            var tcs = new TaskCompletionSource<bool>();

            IReportService service = GetService<IReportService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IReportService)result.AsyncState).EndUpdateReport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginUpdateReport(reportDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ReportDTO>> FindReportFilterInPageAsync(int startIndex, int pageSize, IList<string> sortedColumns, string searchString, bool sortAscending, ServiceHeader serviceHeader, double timeoutMinutes = 10)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ReportDTO>>();

            IReportService service = GetService<IReportService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ReportDTO> response =
                        ((IReportService)result.AsyncState).EndFindReportFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindReportFilterInPage(startIndex, pageSize, sortedColumns, searchString, sortAscending,
                asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ReportDTO>> FindDetailedReportFilterInPageAsync(int startIndex, int pageSize, IList<string> sortedColumns, string searchString, bool sortAscending, ServiceHeader serviceHeader, double timeoutMinutes = 10)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ReportDTO>>();

            IReportService service = GetService<IReportService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ReportDTO> response =
                        ((IReportService)result.AsyncState).EndFindDetailedReportFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindDetailedReportFilterInPage(startIndex, pageSize, sortedColumns, searchString, sortAscending,
                asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ReportDTO>> FindReportHeadersFilterInPageAsync(int startIndex, int pageSize, IList<string> sortedColumns, string searchString, bool sortAscending, ServiceHeader serviceHeader, double timeoutMinutes = 10)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ReportDTO>>();

            IReportService service = GetService<IReportService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ReportDTO> response =
                        ((IReportService)result.AsyncState).EndFindReportHeadersFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindReportHeadersFilterInPage(startIndex, pageSize, sortedColumns, searchString, sortAscending, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ReportDTO> FindReportByIdAsync(Guid id, ServiceHeader serviceHeader, double timeoutMinutes = 10)
        {
            TaskCompletionSource<ReportDTO> taskCompletionSource = new TaskCompletionSource<ReportDTO>();

            IReportService service = GetService<IReportService>(serviceHeader, timeoutMinutes);

            AsyncCallback callback = result =>
            {
                try
                {
                    var myresult = ((IReportService)result.AsyncState).EndFindReportById(result);

                    taskCompletionSource.TrySetResult(myresult);
                }
                catch (Exception ex)
                {

                    HandleFault(ex, msgbc =>
                    {
                        taskCompletionSource.SetResult(null);
                    });
                }

            };

            service.BeginFindReportById(id, callback, service);

            return taskCompletionSource.Task;
        }

        public Task<List<ReportDTO>> FindReportsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<ReportDTO>>();

            IReportService service = GetService<IReportService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ReportDTO> response = ((IReportService)result.AsyncState).EndFindReports(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReports(true, true, asyncCallback, service);

            return tcs.Task;
        }


        #endregion
        #endregion

        #region NavigationItemDTO

        public Task<bool> AddNavigationItemsAsync(List<NavigationItemDTO> navigationItems, ServiceHeader serviceHeader, double timeoutMinutes)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndAddNavigationItems(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginAddNavigationItems(navigationItems, asyncCallback, service);

            return tcs.Task;
        }

        public Task<NavigationItemDTO> FindNavigationItemByIdAsync(Guid navigationItemId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<NavigationItemDTO>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndFindNavigationItemById(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindNavigationItemById(navigationItemId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<NavigationItemDTO> FindNavigationItemByCodeAsync(int navigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<NavigationItemDTO>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndFindNavigationItemByCode(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindNavigationItemByCode(navigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<NavigationItemDTO>> FindNavigationItemsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<NavigationItemDTO>>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndFindNavigationItems(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindNavigationItems(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<NavigationItemDTO>> FindNavigationItemsFilterPageCollectionInfoAsync(int pageIndex, int pageSize, List<string> sortedColumns, string text, bool sortAscending, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<NavigationItemDTO>>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndFindNavigationItemsFilterPageCollectionInfo(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindNavigationItemsFilterPageCollectionInfo(pageIndex, pageSize, sortedColumns, text, sortAscending, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<NavigationItemDTO>> FindModuleNavigationActionByControllerNameAsync(string controllerName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<NavigationItemDTO>>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndFindModuleNavigationActionByControllerName(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindModuleNavigationActionByControllerName(controllerName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> BulkInsertNavigationItemAsync(List<Guid> modulesNavigationIds, string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndBulkInsertNavigationItem(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginBulkInsertNavigationItem(modulesNavigationIds, roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> BulkInsertNavigationItemInRolesAsync(List<Guid> NavigationItemInRole, string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemService service = GetService<INavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemService)result.AsyncState).EndBulkInsertNavigationItemInRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginBulkInsertNavigationItemInRoles(NavigationItemInRole, roleName, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region NavigationItemInRoleDTO

        public Task<List<NavigationItemInRoleDTO>> GetNavigationItemsInRoleAsync(string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<NavigationItemInRoleDTO>>();

            INavigationItemInRoleService service = GetService<INavigationItemInRoleService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<NavigationItemInRoleDTO> response = ((INavigationItemInRoleService)result.AsyncState).EndGetNavigationItemsInRole(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetNavigationItemsInRole(roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<NavigationItemInRoleDTO>> GetRolesForNavigationItemCodeAsync(int navigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<NavigationItemInRoleDTO>>();

            INavigationItemInRoleService service = GetService<INavigationItemInRoleService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<NavigationItemInRoleDTO> response = ((INavigationItemInRoleService)result.AsyncState).EndGetRolesForNavigationItemCode(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetRolesForNavigationItemCode(navigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> IsNavigationItemInRoleAsync(int navigationItemCode, string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemInRoleService service = GetService<INavigationItemInRoleService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemInRoleService)result.AsyncState).EndIsNavigationItemInRole(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginIsNavigationItemInRole(navigationItemCode, roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddNavigationItemToRoleAsync(NavigationItemInRoleDTO navigationItemInRoleDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemInRoleService service = GetService<INavigationItemInRoleService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemInRoleService)result.AsyncState).EndAddNavigationItemToRole(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginAddNavigationItemToRole(navigationItemInRoleDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveNavigationItemRoleAsync(Guid navigationItemId, string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemInRoleService service = GetService<INavigationItemInRoleService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemInRoleService)result.AsyncState).EndRemoveNavigationItemRole(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginRemoveNavigationItemRole(navigationItemId, roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ValidateModuleAccessAsync(string controllerName, string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            INavigationItemInRoleService service = GetService<INavigationItemInRoleService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    var response = ((INavigationItemInRoleService)result.AsyncState).EndValidateModuleAccess(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
            });

            service.BeginValidateModuleAccess(controllerName, roleName, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ModuleNavigationItemInRoleDTO

        public Task<bool> AddModuleNavigationItemsAsync(ObservableCollection<ModuleNavigationItemDTO> moduleNavigationItems, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndAddModuleNavigationItems(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddModuleNavigationItems(moduleNavigationItems.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<string>> GetRolesForModuleNavigationItemCodeAsync(int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<string>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string[] response = ((IModuleNavigationItemService)result.AsyncState).EndGetRolesForModuleNavigationItemCode(result);

                    tcs.TrySetResult(new ObservableCollection<string>(response ?? new string[] { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetRolesForModuleNavigationItemCode(moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveModuleNavigationItemFromRolesAsync(ModuleNavigationItemDTO moduleNavigationItem, ObservableCollection<string> roleNames, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndRemoveModuleNavigationItemFromRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveModuleNavigationItemFromRoles(moduleNavigationItem, roleNames.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddModuleNavigationItemToRolesAsync(ModuleNavigationItemDTO moduleNavigationItem, ObservableCollection<string> roleNames, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndAddModuleNavigationItemToRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddModuleNavigationItemToRoles(moduleNavigationItem, roleNames.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> IsModuleNavigationItemInRoleAsync(ModuleNavigationItemDTO moduleNavigationItem, string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndIsModuleNavigationItemInRole(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginIsModuleNavigationItemInRole(moduleNavigationItem, roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ModuleNavigationItemInRoleDTO>> GetModuleNavigationItemsInRoleAsync(string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ModuleNavigationItemInRoleDTO>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ModuleNavigationItemInRoleDTO> response = ((IModuleNavigationItemService)result.AsyncState).EndGetModuleNavigationItemsInRole(result);

                    tcs.TrySetResult(new ObservableCollection<ModuleNavigationItemInRoleDTO>(response ?? new List<ModuleNavigationItemInRoleDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetModuleNavigationItemsInRole(roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SystemPermissionTypeInRoleDTO>> GetSystemPermissionTypesInRoleAsync(string roleName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SystemPermissionTypeInRoleDTO>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SystemPermissionTypeInRoleDTO> response = ((IModuleNavigationItemService)result.AsyncState).EndGetSystemPermissionTypesInRole(result);

                    tcs.TrySetResult(new ObservableCollection<SystemPermissionTypeInRoleDTO>(response ?? new List<SystemPermissionTypeInRoleDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetSystemPermissionTypesInRole(roleName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SystemPermissionTypeInBranchDTO>> GetSystemPermissionTypesInBranchAsync(Guid branchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SystemPermissionTypeInBranchDTO>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SystemPermissionTypeInBranchDTO> response = ((IModuleNavigationItemService)result.AsyncState).EndGetSystemPermissionTypesInBranch(result);

                    tcs.TrySetResult(new ObservableCollection<SystemPermissionTypeInBranchDTO>(response ?? new List<SystemPermissionTypeInBranchDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetSystemPermissionTypesInBranch(branchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MapModuleNavigationItemToRolesAsync(ModuleNavigationItemDTO moduleNavigationItem, ObservableCollection<string> roleNames, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndMapModuleNavigationItemToRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapModuleNavigationItemToRoles(moduleNavigationItem, roleNames.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region WorkflowDTO

        public Task<bool> AddWorkflowAsync(WorkflowDTO workflowDTO, List<SystemPermissionTypeInRoleDTO> rolesInSystemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWorkflowService)result.AsyncState).EndAddWorkflow(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddWorkflow(workflowDTO, rolesInSystemPermissionType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ProcessWorkflowQueueAsync(Guid recordId, int workflowRecordType, int workflowRecordStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWorkflowService)result.AsyncState).EndProcessWorkflowQueue(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginProcessWorkflowQueue(recordId, workflowRecordType, workflowRecordStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WorkflowDTO> FindWorkflowByRecordAndSystemPermissionTypeAsync(Guid recordId, int systemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WorkflowDTO>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WorkflowDTO response = ((IWorkflowService)result.AsyncState).EndFindWorkflowByRecordAndSystemPermissionType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWorkflowByRecordAndSystemPermissionType(recordId, systemPermissionType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<WorkflowDTO>> FindQueableWorkflowsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WorkflowDTO>>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WorkflowDTO> response = ((IWorkflowService)result.AsyncState).EndFindQueableWorkflowsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableWorkflowsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }
        #endregion

        #region WorkflowItemDTO

        public Task<PageCollectionInfo<WorkflowItemDTO>> FindWorkflowItemsByFilterInPageAsync(int systemPermissionType, int status, string filter, DateTime startDate, DateTime endDate, int pageIndex, int pageSize, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WorkflowItemDTO>>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WorkflowItemDTO> response = ((IWorkflowService)result.AsyncState).EndFindWorkflowItemsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWorkflowItemsByFilterInPage(systemPermissionType, status, filter, startDate, endDate, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<WorkflowItemDTO>> FindWorkflowItemsAsync(Guid workflowId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<WorkflowItemDTO>>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<WorkflowItemDTO> response = ((IWorkflowService)result.AsyncState).EndFindWorkflowItems(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWorkflowItems(workflowId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ApproveWorkflowItemAsync(WorkflowItemDTO workflowItemDTO, bool usedBiometrics, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWorkflowService)result.AsyncState).EndApproveWorkflowItem(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginApproveWorkflowItem(workflowItemDTO, usedBiometrics, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region WorkflowItemEntryDTO

        public Task<List<WorkflowItemEntryDTO>> FindWorkflowItemEntriesByWorkflowAsync(Guid workflowId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<WorkflowItemEntryDTO>>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<WorkflowItemEntryDTO> response = ((IWorkflowService)result.AsyncState).EndFindWorkflowItemEntriesByWorkflow(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWorkflowItemEntriesByWorkflow(workflowId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region WorkflowSettingDTO

        public Task<bool> MapWorkflowSettingToSystemPermissionTypeAsync(WorkflowSettingDTO workflowSettingDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWorkflowService)result.AsyncState).EndMapWorkflowSettingToSystemPermissionType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapWorkflowSettingToSystemPermissionType(workflowSettingDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WorkflowSettingDTO> FindWorkflowSettingAsync(int systemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WorkflowSettingDTO>();

            IWorkflowService service = GetService<IWorkflowService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WorkflowSettingDTO response = ((IWorkflowService)result.AsyncState).EndFindWorkflowSetting(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWorkflowSetting(systemPermissionType, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region SystemPermissionType

        public Task<List<SystemPermissionTypeInRoleDTO>> GetRolesListForSystemPermissionTypeAsync(int systemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<SystemPermissionTypeInRoleDTO>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SystemPermissionTypeInRoleDTO> response = ((IModuleNavigationItemService)result.AsyncState).EndGetRolesListForSystemPermissionType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetRolesListForSystemPermissionType(systemPermissionType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<string>> GetRolesForSystemPermissionTypeAsync(int systemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<string>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    string[] response = ((IModuleNavigationItemService)result.AsyncState).EndGetRolesForSystemPermissionType(result);

                    tcs.TrySetResult(new ObservableCollection<string>(response ?? new string[] { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetRolesForSystemPermissionType(systemPermissionType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveSystemPermissionTypeFromRolesAsync(int systemPermissionType, ObservableCollection<string> roleNames, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndRemoveSystemPermissionTypeFromRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveSystemPermissionTypeFromRoles(systemPermissionType, roleNames.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddSystemPermissionTypeToRolesAsync(int systemPermissionType, ObservableCollection<SystemPermissionTypeInRoleDTO> rolesInSystemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndAddSystemPermissionTypeToRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSystemPermissionTypeToRoles(systemPermissionType, rolesInSystemPermissionType.ToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MapSystemPermissionTypeToRolesAsync(int systemPermissionType, ObservableCollection<SystemPermissionTypeInRoleDTO> rolesInSystemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndMapSystemPermissionTypeToRoles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapSystemPermissionTypeToRoles(systemPermissionType, rolesInSystemPermissionType.ToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<BranchDTO>> GetBranchesForSystemPermissionTypeAsync(int systemPermissionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BranchDTO>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BranchDTO> response = ((IModuleNavigationItemService)result.AsyncState).EndGetBranchesForSystemPermissionType(result);

                    tcs.TrySetResult(new ObservableCollection<BranchDTO>(response ?? new List<BranchDTO> { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetBranchesForSystemPermissionType(systemPermissionType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveSystemPermissionTypeFromBranchesAsync(int systemPermissionType, ObservableCollection<BranchDTO> branches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndRemoveSystemPermissionTypeFromBranches(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveSystemPermissionTypeFromBranches(systemPermissionType, branches.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddSystemPermissionTypeToBranchesAsync(int systemPermissionType, ObservableCollection<BranchDTO> branches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndAddSystemPermissionTypeToBranches(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSystemPermissionTypeToBranches(systemPermissionType, branches.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MapSystemPermissionTypeToBranchesAsync(int systemPermissionType, ObservableCollection<BranchDTO> branches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndMapSystemPermissionTypeToBranches(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapSystemPermissionTypeToBranches(systemPermissionType, branches.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<BranchDTO>> GetBranchesForEmployeeAsync(Guid employeeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BranchDTO>>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BranchDTO> response = ((IModuleNavigationItemService)result.AsyncState).EndGetBranchesForEmployee(result);

                    tcs.TrySetResult(new ObservableCollection<BranchDTO>(response ?? new List<BranchDTO> { }));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetBranchesForEmployee(employeeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveEmployeeFromBranchesAsync(Guid employeeId, ObservableCollection<BranchDTO> branches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndRemoveEmployeeFromBranches(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveEmployeeFromBranches(employeeId, branches.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddEmployeeToBranchesAsync(Guid employeeId, ObservableCollection<BranchDTO> branches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndAddEmployeeToBranches(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployeeToBranches(employeeId, branches.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MapEmployeeToBranchesAsync(Guid employeeId, ObservableCollection<BranchDTO> branches, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IModuleNavigationItemService service = GetService<IModuleNavigationItemService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IModuleNavigationItemService)result.AsyncState).EndMapEmployeeToBranches(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapEmployeeToBranches(employeeId, branches.ExtendedToArray(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region MicroCreditOfficerDTO

        public Task<PageCollectionInfo<MicroCreditOfficerDTO>> FindMicroCreditOfficersByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MicroCreditOfficerDTO>>();

            IMicroCreditOfficerService service = GetService<IMicroCreditOfficerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MicroCreditOfficerDTO> response = ((IMicroCreditOfficerService)result.AsyncState).EndFindMicroCreditOfficersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditOfficersByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<MicroCreditOfficerDTO>> FindMicroCreditOfficersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MicroCreditOfficerDTO>>();

            IMicroCreditOfficerService service = GetService<IMicroCreditOfficerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MicroCreditOfficerDTO> response = ((IMicroCreditOfficerService)result.AsyncState).EndFindMicroCreditOfficersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditOfficersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MicroCreditOfficerDTO> AddMicroCreditOfficerAsync(MicroCreditOfficerDTO microCreditOfficerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MicroCreditOfficerDTO>();

            IMicroCreditOfficerService service = GetService<IMicroCreditOfficerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MicroCreditOfficerDTO response = ((IMicroCreditOfficerService)result.AsyncState).EndAddMicroCreditOfficer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddMicroCreditOfficer(microCreditOfficerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateMicroCreditOfficerAsync(MicroCreditOfficerDTO microCreditOfficerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMicroCreditOfficerService service = GetService<IMicroCreditOfficerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMicroCreditOfficerService)result.AsyncState).EndUpdateMicroCreditOfficer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateMicroCreditOfficer(microCreditOfficerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MicroCreditOfficerDTO> FindMicroCreditOfficerAsync(Guid microCreditOfficerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MicroCreditOfficerDTO>();

            IMicroCreditOfficerService service = GetService<IMicroCreditOfficerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MicroCreditOfficerDTO response = ((IMicroCreditOfficerService)result.AsyncState).EndFindMicroCreditOfficer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditOfficer(microCreditOfficerId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region MicroCreditGroupDTO

        public Task<BatchImportParseInfo> ParseMicroCreditGroupImportAsync(Guid microCreditGroupCustomerId, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BatchImportParseInfo>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BatchImportParseInfo response = ((IMicroCreditGroupService)result.AsyncState).EndParseMicroCreditGroupImport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseMicroCreditGroupImport(microCreditGroupCustomerId, fileName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MicroCreditGroupMemberExistsAsync(Guid microCreditGroupMemberCustomerId, Guid microCreditGroupCustomerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMicroCreditGroupService)result.AsyncState).EndMicroCreditGroupMemberExists(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMicroCreditGroupMemberExists(microCreditGroupMemberCustomerId, microCreditGroupCustomerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<MicroCreditGroupDTO>> FindMicroCreditGroupsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MicroCreditGroupDTO>>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MicroCreditGroupDTO> response = ((IMicroCreditGroupService)result.AsyncState).EndFindMicroCreditGroupsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditGroupsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MicroCreditGroupDTO> AddMicroCreditGroupAsync(MicroCreditGroupDTO microCreditGroupDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MicroCreditGroupDTO>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MicroCreditGroupDTO response = ((IMicroCreditGroupService)result.AsyncState).EndAddMicroCreditGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddMicroCreditGroup(microCreditGroupDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateMicroCreditGroupAsync(MicroCreditGroupDTO microCreditGroupDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMicroCreditGroupService)result.AsyncState).EndUpdateMicroCreditGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateMicroCreditGroup(microCreditGroupDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MicroCreditGroupDTO> FindMicroCreditGroupAsync(Guid microCreditGroupId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MicroCreditGroupDTO>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MicroCreditGroupDTO response = ((IMicroCreditGroupService)result.AsyncState).EndFindMicroCreditGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditGroup(microCreditGroupId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<MicroCreditGroupMemberDTO>> FindMicroCreditGroupMembersByMicroCreditGroupIdAsync(Guid microCreditGroupId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<MicroCreditGroupMemberDTO>>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<MicroCreditGroupMemberDTO> response = ((IMicroCreditGroupService)result.AsyncState).EndFindMicroCreditGroupMembersByMicroCreditGroupId(result);

                    tcs.TrySetResult(new ObservableCollection<MicroCreditGroupMemberDTO>(response ?? new List<MicroCreditGroupMemberDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditGroupMembersByMicroCreditGroupId(microCreditGroupId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<MicroCreditGroupMemberDTO>> FindMicroCreditGroupMembersByMicroCreditGroupCustomerIdAsync(Guid microCreditGroupCustomerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<MicroCreditGroupMemberDTO>>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<MicroCreditGroupMemberDTO> response = ((IMicroCreditGroupService)result.AsyncState).EndFindMicroCreditGroupMembersByMicroCreditGroupCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<MicroCreditGroupMemberDTO>(response ?? new List<MicroCreditGroupMemberDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditGroupMembersByMicroCreditGroupCustomerId(microCreditGroupCustomerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<MicroCreditGroupMemberDTO>> FindMicroCreditGroupMembersByMicroCreditGroupIdInPageAsync(Guid microCreditGroupId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MicroCreditGroupMemberDTO>>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MicroCreditGroupMemberDTO> response = ((IMicroCreditGroupService)result.AsyncState).EndFindMicroCreditGroupMembersByMicroCreditGroupIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditGroupMembersByMicroCreditGroupIdInPage(microCreditGroupId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MicroCreditGroupMemberDTO> AddMicroCreditGroupMemberAsync(MicroCreditGroupMemberDTO microCreditGroupMemberDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MicroCreditGroupMemberDTO>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MicroCreditGroupMemberDTO response = ((IMicroCreditGroupService)result.AsyncState).EndAddMicroCreditGroupMember(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddMicroCreditGroupMember(microCreditGroupMemberDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveMicroCreditGroupMembersAsync(ObservableCollection<MicroCreditGroupMemberDTO> microCreditGroupMemberDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMicroCreditGroupService)result.AsyncState).EndRemoveMicroCreditGroupMembers(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveMicroCreditGroupMembers(microCreditGroupMemberDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<MicroCreditGroupMemberDTO> FindMicroCreditGroupMemberByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MicroCreditGroupMemberDTO>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MicroCreditGroupMemberDTO response = ((IMicroCreditGroupService)result.AsyncState).EndFindMicroCreditGroupMemberByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMicroCreditGroupMemberByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateMicroCreditMemberGroupCollectionByMicroCreditGroupIdAsync(Guid microCreditGroupId, ObservableCollection<MicroCreditGroupMemberDTO> microCreditGroupMemberCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMicroCreditGroupService service = GetService<IMicroCreditGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMicroCreditGroupService)result.AsyncState).EndUpdateMicroCreditGroupMemberCollectionByMicroCreditGroupId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateMicroCreditGroupMemberCollectionByMicroCreditGroupId(microCreditGroupId, microCreditGroupMemberCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region TextAlertDTO

        public Task<PageCollectionInfo<TextAlertDTO>> FindTextAlertsByFilterInPageAsync(int dlrStatus, string text, int pageIndex, int pageSize, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TextAlertDTO>>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TextAlertDTO> response = ((ITextAlertService)result.AsyncState).EndFindTextAlertsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTextAlertsByFilterInPage(dlrStatus, text, pageIndex, pageSize, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TextAlertDTO>> FindTextAlertsByDateRangeAndFilterInPageAsync(int dlrStatus, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TextAlertDTO>>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TextAlertDTO> response = ((ITextAlertService)result.AsyncState).EndFindTextAlertsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTextAlertsByDateRangeAndFilterInPage(dlrStatus, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TextAlertDTO>> FindTextAlertsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TextAlertDTO>>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TextAlertDTO> response = ((ITextAlertService)result.AsyncState).EndFindTextAlertsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTextAlertsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddBulkMessageAsync(BulkMessageDTO bulkMessageDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndAddBulkMessage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBulkMessage(bulkMessageDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddUSSDMessageAsync(USSDMessageDTO ussdMessageDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndAddUSSDMessage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddUSSDMessage(ussdMessageDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddTextAlertsAsync(ObservableCollection<TextAlertDTO> textAlertDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndAddTextAlerts(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTextAlerts(textAlertDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddTextAlertsWithHistoryAsync(GroupTextAlertDTO groupTextAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndAddTextAlertsWithHistory(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTextAlertsWithHistory(groupTextAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<TextAlertDTO>> FindTextAlertsByDLRStatusAsync(int dlrStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<TextAlertDTO>>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TextAlertDTO> response = ((ITextAlertService)result.AsyncState).EndFindTextAlertsByDLRStatus(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTextAlertsByDLRStatus(dlrStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TextAlertDTO> FindTextAlertAsync(Guid textAlertId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TextAlertDTO>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TextAlertDTO response = ((ITextAlertService)result.AsyncState).EndFindTextAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTextAlert(textAlertId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateTextAlertAsync(TextAlertDTO textAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndUpdateTextAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateTextAlert(textAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddQuickTextAlertAsync(QuickTextAlertDTO quickTextAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndAddQuickTextAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddQuickTextAlert(quickTextAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsBySystemTransactionCodeAsync(int systemTransactionCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((ITextAlertService)result.AsyncState).EndFindCommissionsBySystemTransactionCode(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsBySystemTransactionCode(systemTransactionCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsBySystemTransactionCodeAsync(int systemTransactionCode, ObservableCollection<CommissionDTO> commissions, int chargeBenefactor, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITextAlertService)result.AsyncState).EndUpdateCommissionsBySystemTransactionCode(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsBySystemTransactionCode(systemTransactionCode, commissions.ExtendedToArray(), chargeBenefactor, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<MonthlySummaryValuesDTO>> FindTextAlertsMonthlyStatisticsAsync(Guid companyId, DateTime startDate, DateTime endDate, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<MonthlySummaryValuesDTO>>();

            ITextAlertService service = GetService<ITextAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<MonthlySummaryValuesDTO> response = ((ITextAlertService)result.AsyncState).EndFindTextAlertsMonthlyStatistics(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindTextAlertsMonthlyStatistics(companyId, startDate, endDate, asyncCallback, service);

            return tcs.Task;
        }


        #endregion

        #region EmailAlertDTO

        public Task<PageCollectionInfo<EmailAlertDTO>> FindEmailAlertsByFilterInPageAsync(int dlrStatus, string text, int pageIndex, int pageSize, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmailAlertDTO>>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmailAlertDTO> response = ((IEmailAlertService)result.AsyncState).EndFindEmailAlertsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmailAlertsByFilterInPage(dlrStatus, text, pageIndex, pageSize, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmailAlertDTO>> FindEmailAlertsByDateRangeAndFilterInPageAsync(int dlrStatus, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmailAlertDTO>>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmailAlertDTO> response = ((IEmailAlertService)result.AsyncState).EndFindEmailAlertsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmailAlertsByDateRangeAndFilterInPage(dlrStatus, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmailAlertDTO>> FindEmailAlertsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmailAlertDTO>>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmailAlertDTO> response = ((IEmailAlertService)result.AsyncState).EndFindEmailAlertsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmailAlertsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddEmailAlertsAsync(ObservableCollection<EmailAlertDTO> emailAlertDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmailAlertService)result.AsyncState).EndAddEmailAlerts(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmailAlerts(emailAlertDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddEmailAlertsWithHistoryAsync(GroupEmailAlertDTO groupEmailAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmailAlertService)result.AsyncState).EndAddEmailAlertsWithHistory(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmailAlertsWithHistory(groupEmailAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmailAlertDTO> AddEmailAlertAsync(EmailAlertDTO emailAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmailAlertDTO>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmailAlertDTO response = ((IEmailAlertService)result.AsyncState).EndAddEmailAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmailAlert(emailAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmailAlertAsync(EmailAlertDTO emailAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmailAlertService)result.AsyncState).EndUpdateEmailAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmailAlert(emailAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmailAlertDTO> FindEmailAlertAsync(Guid emailAlertId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmailAlertDTO>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmailAlertDTO response = ((IEmailAlertService)result.AsyncState).EndFindEmailAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmailAlert(emailAlertId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<EmailAlertDTO>> FindEmailAlertsByDLRStatusAsync(int dlrStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<EmailAlertDTO>>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmailAlertDTO> response = ((IEmailAlertService)result.AsyncState).EndFindEmailAlertsByDLRStatus(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmailAlertsByDLRStatus(dlrStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddQuickEmailAlertAsync(QuickEmailAlertDTO quickEmailAlertDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmailAlertService)result.AsyncState).EndAddQuickEmailAlert(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddQuickEmailAlert(quickEmailAlertDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<MonthlySummaryValuesDTO>> FindEmailAlertsMonthlyStatisticsAsync(Guid companyId, DateTime startDate, DateTime endDate, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<MonthlySummaryValuesDTO>>();

            IEmailAlertService service = GetService<IEmailAlertService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<MonthlySummaryValuesDTO> response = ((IEmailAlertService)result.AsyncState).EndFindEmailAlertsMonthlyStatistics(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
            });

            service.BeginFindEmailAlertsMonthlyStatistics(companyId, startDate, endDate, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region MessageGroupDTO

        public Task<PageCollectionInfo<MessageGroupDTO>> FindMessageGroupsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MessageGroupDTO>>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MessageGroupDTO> response = ((IMessageGroupService)result.AsyncState).EndFindMessageGroupsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMessageGroupsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<MessageGroupDTO>> FindMessageGroupsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MessageGroupDTO>>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MessageGroupDTO> response = ((IMessageGroupService)result.AsyncState).EndFindMessageGroupsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMessageGroupsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MessageGroupDTO> AddNewMessageGroupAsync(MessageGroupDTO messageGroupDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MessageGroupDTO>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MessageGroupDTO response = ((IMessageGroupService)result.AsyncState).EndAddNewMessageGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewMessageGroup(messageGroupDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateMessageGroupAsync(MessageGroupDTO messageGroupDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMessageGroupService)result.AsyncState).EndUpdateMessageGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateMessageGroup(messageGroupDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MessageGroupDTO> FindMessageGroupAsync(Guid messageGroupId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MessageGroupDTO>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MessageGroupDTO response = ((IMessageGroupService)result.AsyncState).EndFindMessageGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMessageGroup(messageGroupId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<MessageGroupDTO>> FindMessageGroupsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<MessageGroupDTO>>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<MessageGroupDTO> response = ((IMessageGroupService)result.AsyncState).EndFindMessageGroups(result);

                    tcs.TrySetResult(new ObservableCollection<MessageGroupDTO>(response ?? new List<MessageGroupDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMessageGroups(asyncCallback, service);

            return tcs.Task;
        }

        public Task<BatchImportParseInfo> ParseQuickAlertImportAsync(string fileName, int messageCategory, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BatchImportParseInfo>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BatchImportParseInfo response = ((IMessageGroupService)result.AsyncState).EndParseQuickAlertImport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseQuickAlertImport(fileName, messageCategory, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BatchImportParseInfo> ParseCustomersCustomMessageGroupImportAsync(string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BatchImportParseInfo>();

            IMessageGroupService service = GetService<IMessageGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BatchImportParseInfo response = ((IMessageGroupService)result.AsyncState).EndParseCustomersCustomMessageGroupImport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseCustomersCustomMessageGroupImport(fileName, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FuneralRiderClaimDTO

        public Task<FuneralRiderClaimDTO> AddNewFuneralRiderClaimAsync(FuneralRiderClaimDTO funeralRiderClaimDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FuneralRiderClaimDTO>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FuneralRiderClaimDTO response = ((IFuneralRiderClaimService)result.AsyncState).EndAddNewFuneralRiderClaim(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewFuneralRiderClaim(funeralRiderClaimDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateFuneralRiderClaimAsync(FuneralRiderClaimDTO funeralRiderClaimDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFuneralRiderClaimService)result.AsyncState).EndUpdateFuneralRiderClaim(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateFuneralRiderClaim(funeralRiderClaimDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FuneralRiderClaimDTO>> FindFuneralRiderClaimsByFilterAndDateInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FuneralRiderClaimDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FuneralRiderClaimDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimsByFilterAndDateInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimsByFilterAndDateInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FuneralRiderClaimDTO>> FindFuneralRiderClaimsByStatusAndFilterInPageAsync(int status, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FuneralRiderClaimDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FuneralRiderClaimDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimsByStatusAndFilterInPage(status, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FuneralRiderClaimDTO> FindFuneralRiderClaimAsync(Guid funeralRiderClaimId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FuneralRiderClaimDTO>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FuneralRiderClaimDTO response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaim(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaim(funeralRiderClaimId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<FuneralRiderClaimDTO>> FindFuneralRiderClaimsByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<FuneralRiderClaimDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<FuneralRiderClaimDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimsByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimsByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FuneralRiderClaimDTO>> FindFuneralRiderClaimsByFilterInPageAsync(string filter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FuneralRiderClaimDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FuneralRiderClaimDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimsByFilterInPage(filter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FuneralRiderClaimPayableDTO

        public Task<FuneralRiderClaimPayableDTO> AddNewFuneralRiderClaimPayableAsync(FuneralRiderClaimPayableDTO funeralRiderClaimPayableDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FuneralRiderClaimPayableDTO>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FuneralRiderClaimPayableDTO response = ((IFuneralRiderClaimService)result.AsyncState).EndAddNewFuneralRiderClaimPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewFuneralRiderClaimPayable(funeralRiderClaimPayableDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FuneralRiderClaimPayableDTO> FindFuneralRiderClaimPayableAsync(Guid funeralRiderClaimPayableId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FuneralRiderClaimPayableDTO>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FuneralRiderClaimPayableDTO response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimPayable(funeralRiderClaimPayableId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateFuneralRiderClaimPayableAsync(FuneralRiderClaimPayableDTO funeralRiderClaimPayableDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFuneralRiderClaimService)result.AsyncState).EndUpdateFuneralRiderClaimPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateFuneralRiderClaimPayable(funeralRiderClaimPayableDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditFuneralRiderClaimPayableAsync(FuneralRiderClaimPayableDTO funeralRiderClaimPayableDTO, int verificationOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFuneralRiderClaimService)result.AsyncState).EndAuditFuneralRiderClaimPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditFuneralRiderClaimPayable(funeralRiderClaimPayableDTO, verificationOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeFuneralRiderClaimPayableAsync(FuneralRiderClaimPayableDTO funeralRiderClaimPayableDTO, int authorizationOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFuneralRiderClaimService)result.AsyncState).EndAuthorizeFuneralRiderClaimPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeFuneralRiderClaimPayable(funeralRiderClaimPayableDTO, authorizationOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostFuneralRiderClaimPayableAsync(Guid funeralRiderClaimPayableId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFuneralRiderClaimService)result.AsyncState).EndPostFuneralRiderClaimPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostFuneralRiderClaimPayable(funeralRiderClaimPayableId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FuneralRiderClaimPayableDTO>> FindFuneralRiderClaimPayablesByRecordStatusPaymentStatusFilterAndDateInPageAsync(int recordStatus, int paymentStatus, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FuneralRiderClaimPayableDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FuneralRiderClaimPayableDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimPayablesByRecordStatusPaymentStatusFilterAndDateInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimPayablesByRecordStatusPaymentStatusFilterAndDateInPage(recordStatus, paymentStatus, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FuneralRiderClaimPayableDTO>> FindFuneralRiderClaimPayablesByRecordStatusFilterAndDateInPageAsync(int recordStatus, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FuneralRiderClaimPayableDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FuneralRiderClaimPayableDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimPayablesByRecordStatusFilterAndDateInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimPayablesByRecordStatusFilterAndDateInPage(recordStatus, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FuneralRiderClaimPayableDTO>> FindFuneralRiderClaimPayablesByRecordStatusPaymentStatusAndFilterInPageAsync(int recordStatus, int paymentStatus, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FuneralRiderClaimPayableDTO>>();

            IFuneralRiderClaimService service = GetService<IFuneralRiderClaimService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FuneralRiderClaimPayableDTO> response = ((IFuneralRiderClaimService)result.AsyncState).EndFindFuneralRiderClaimPayablesByRecordStatusPaymentStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFuneralRiderClaimPayablesByRecordStatusPaymentStatusAndFilterInPage(recordStatus, paymentStatus, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }
        #endregion

        #region CashWithdrawalRequestDTO

        public Task<PageCollectionInfo<CashWithdrawalRequestDTO>> FindCashWithdrawalRequestsByFilterInPageAsync(DateTime startDate, DateTime endDate, int status, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CashWithdrawalRequestDTO>>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CashWithdrawalRequestDTO> response = ((ICashWithdrawalRequestService)result.AsyncState).EndFindCashWithdrawalRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCashWithdrawalRequestsByFilterInPage(startDate, endDate, status, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CashWithdrawalRequestDTO>> FindMatureCashWithdrawalRequestsByCustomerAccountIdAsync(CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CashWithdrawalRequestDTO>>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CashWithdrawalRequestDTO> response = ((ICashWithdrawalRequestService)result.AsyncState).EndFindMatureCashWithdrawalRequestsByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CashWithdrawalRequestDTO>(response ?? new List<CashWithdrawalRequestDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMatureCashWithdrawalRequestsByCustomerAccountId(customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CashWithdrawalRequestDTO>> FindMatureCashWithdrawalRequestsByChartOfAccountIdAsync(Guid chartOfAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CashWithdrawalRequestDTO>>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CashWithdrawalRequestDTO> response = ((ICashWithdrawalRequestService)result.AsyncState).EndFindMatureCashWithdrawalRequestsByChartOfAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CashWithdrawalRequestDTO>(response ?? new List<CashWithdrawalRequestDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMatureCashWithdrawalRequestsByChartOfAccountId(chartOfAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CashWithdrawalRequestDTO> AddCashWithdrawalRequestAsync(CashWithdrawalRequestDTO cashWithdrawalRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CashWithdrawalRequestDTO>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CashWithdrawalRequestDTO response = ((ICashWithdrawalRequestService)result.AsyncState).EndAddCashWithdrawalRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCashWithdrawalRequest(cashWithdrawalRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CashWithdrawalRequestDTO> FindCashWithdrawalRequestAsync(Guid cashWithdrawalRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CashWithdrawalRequestDTO>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CashWithdrawalRequestDTO response = ((ICashWithdrawalRequestService)result.AsyncState).EndFindCashWithdrawalRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCashWithdrawalRequest(cashWithdrawalRequestId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PayCashWithdrawalRequestAsync(CashWithdrawalRequestDTO cashWithdrawalRequestDTO, PaymentVoucherDTO paymentVoucherDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICashWithdrawalRequestService)result.AsyncState).EndPayCashWithdrawalRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPayCashWithdrawalRequest(cashWithdrawalRequestDTO, paymentVoucherDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeCashWithdrawalRequestAsync(CashWithdrawalRequestDTO cashWithdrawalRequestDTO, int customerTransactionAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICashWithdrawalRequestService service = GetService<ICashWithdrawalRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICashWithdrawalRequestService)result.AsyncState).EndAuthorizeCashWithdrawalRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeCashWithdrawalRequest(cashWithdrawalRequestDTO, customerTransactionAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CashTransferRequestDTO

        public Task<CashTransferRequestDTO> AddCashTransferRequestAsync(CashTransferRequestDTO cashTransferRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CashTransferRequestDTO>();

            ICashTransferRequestService service = GetService<ICashTransferRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CashTransferRequestDTO response = ((ICashTransferRequestService)result.AsyncState).EndAddCashTransferRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCashTransferRequest(cashTransferRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AcknowledgeCashTransferRequestAsync(CashTransferRequestDTO cashTransferRequestDTO, int cashTransferRequestAcknowledgeOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICashTransferRequestService service = GetService<ICashTransferRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICashTransferRequestService)result.AsyncState).EndAcknowledgeCashTransferRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAcknowledgeCashTransferRequest(cashTransferRequestDTO, cashTransferRequestAcknowledgeOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CashTransferRequestDTO> FindCashTransferRequestAsync(Guid cashTransferRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CashTransferRequestDTO>();

            ICashTransferRequestService service = GetService<ICashTransferRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CashTransferRequestDTO response = ((ICashTransferRequestService)result.AsyncState).EndFindCashTransferRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCashTransferRequest(cashTransferRequestId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UtilizeCashTransferRequestAsync(Guid cashTransferRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICashTransferRequestService service = GetService<ICashTransferRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICashTransferRequestService)result.AsyncState).EndUtilizeCashTransferRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUtilizeCashTransferRequest(cashTransferRequestId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CashTransferRequestDTO>> FindMatureCashTransferRequestsByEmployeeIdAsync(Guid employeeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CashTransferRequestDTO>>();

            ICashTransferRequestService service = GetService<ICashTransferRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CashTransferRequestDTO> response = ((ICashTransferRequestService)result.AsyncState).EndFindMatureCashTransferRequestsByEmployeeId(result);

                    tcs.TrySetResult(new ObservableCollection<CashTransferRequestDTO>(response ?? new List<CashTransferRequestDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMatureCashTransferRequestsByEmployeeId(employeeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CashTransferRequestDTO>> FindCashTransferRequestsByFilterInPageAsync(Guid employeeId, DateTime startDate, DateTime endDate, int status, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CashTransferRequestDTO>>();

            ICashTransferRequestService service = GetService<ICashTransferRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CashTransferRequestDTO> response = ((ICashTransferRequestService)result.AsyncState).EndFindCashTransferRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCashTransferRequestsByFilterInPage(employeeId, startDate, endDate, status, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CashDepositRequestDTO

        public Task<PageCollectionInfo<CashDepositRequestDTO>> FindCashDepositRequestsByFilterInPageAsync(DateTime startDate, DateTime endDate, int status, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CashDepositRequestDTO>>();

            ICashDepositRequestService service = GetService<ICashDepositRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CashDepositRequestDTO> response = ((ICashDepositRequestService)result.AsyncState).EndFindCashDepositRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCashDepositRequestsByFilterInPage(startDate, endDate, status, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CashDepositRequestDTO>> FindActionableCashDepositRequestsByCustomerAccountAsync(CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CashDepositRequestDTO>>();

            ICashDepositRequestService service = GetService<ICashDepositRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CashDepositRequestDTO> response = ((ICashDepositRequestService)result.AsyncState).EndFindActionableCashDepositRequestsByCustomerAccount(result);

                    tcs.TrySetResult(new ObservableCollection<CashDepositRequestDTO>(response ?? new List<CashDepositRequestDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindActionableCashDepositRequestsByCustomerAccount(customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CashDepositRequestDTO> AddCashDepositRequestAsync(CashDepositRequestDTO cashDepositRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CashDepositRequestDTO>();

            ICashDepositRequestService service = GetService<ICashDepositRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CashDepositRequestDTO response = ((ICashDepositRequestService)result.AsyncState).EndAddCashDepositRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCashDepositRequest(cashDepositRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CashDepositRequestDTO> FindCashDepositRequestAsync(Guid cashDepositRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CashDepositRequestDTO>();

            ICashDepositRequestService service = GetService<ICashDepositRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CashDepositRequestDTO response = ((ICashDepositRequestService)result.AsyncState).EndFindCashDepositRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCashDepositRequest(cashDepositRequestId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostCashDepositRequestAsync(CashDepositRequestDTO cashDepositRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICashDepositRequestService service = GetService<ICashDepositRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICashDepositRequestService)result.AsyncState).EndPostCashDepositRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostCashDepositRequest(cashDepositRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeCashDepositRequestAsync(CashDepositRequestDTO cashDepositRequestDTO, int customerTransactionAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICashDepositRequestService service = GetService<ICashDepositRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICashDepositRequestService)result.AsyncState).EndAuthorizeCashDepositRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeCashDepositRequest(cashDepositRequestDTO, customerTransactionAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ExternalChequeDTO

        public Task<PageCollectionInfo<ExternalChequeDTO>> FindExternalChequesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindExternalChequesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExternalChequesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExternalChequeDTO>> FindExternalChequesByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindExternalChequesByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExternalChequesByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ExternalChequeDTO> AddExternalChequeAsync(ExternalChequeDTO externalChequeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ExternalChequeDTO>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ExternalChequeDTO response = ((IExternalChequeService)result.AsyncState).EndAddExternalCheque(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddExternalCheque(externalChequeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MarkExternalChequeClearedAsync(Guid externalChequeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExternalChequeService)result.AsyncState).EndMarkExternalChequeCleared(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMarkExternalChequeCleared(externalChequeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ExternalChequeDTO>> FindUnClearedExternalChequesByCustomerAccountIdAsync(Guid customerAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindUnClearedExternalChequesByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<ExternalChequeDTO>(response ?? new List<ExternalChequeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnClearedExternalChequesByCustomerAccountId(customerAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExternalChequeDTO>> FindUnTransferredExternalChequesByTellerIdAndFilterInPageAsync(Guid tellerId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindUnTransferredExternalChequesByTellerIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnTransferredExternalChequesByTellerIdAndFilterInPage(tellerId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ExternalChequeDTO>> FindUnTransferredExternalChequesByTellerIdAndFilterAsync(Guid tellerId, string text, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindUnTransferredExternalChequesByTellerIdAndFilter(result);

                    tcs.TrySetResult(new ObservableCollection<ExternalChequeDTO>(response ?? new List<ExternalChequeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnTransferredExternalChequesByTellerIdAndFilter(tellerId, text, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> TransferExternalChequesAsync(ObservableCollection<ExternalChequeDTO> externalChequeDTOs, TellerDTO tellerDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExternalChequeService)result.AsyncState).EndTransferExternalCheques(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginTransferExternalCheques(externalChequeDTOs.ExtendedToList(), tellerDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExternalChequeDTO>> FindUnClearedExternalChequesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindUnClearedExternalChequesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnClearedExternalChequesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExternalChequeDTO>> FindUnClearedExternalChequesByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindUnClearedExternalChequesByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnClearedExternalChequesByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ClearExternalChequeAsync(ExternalChequeDTO externalChequeDTO, int clearingOption, int moduleNavigationItemCode, UnPayReasonDTO unPayReasonDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExternalChequeService)result.AsyncState).EndClearExternalCheque(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginClearExternalCheque(externalChequeDTO, clearingOption, moduleNavigationItemCode, unPayReasonDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExternalChequeDTO>> FindUnBankedExternalChequesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExternalChequeDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExternalChequeDTO> response = ((IExternalChequeService)result.AsyncState).EndFindUnBankedExternalChequesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnBankedExternalChequesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> BankExternalChequesAsync(ObservableCollection<ExternalChequeDTO> externalChequeDTOs, BankLinkageDTO bankLinkageDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExternalChequeService)result.AsyncState).EndBankExternalCheques(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginBankExternalCheques(externalChequeDTOs.ExtendedToList(), bankLinkageDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ExternalChequePayableDTO>> FindExternalChequePayablesByExternalChequeIdAsync(Guid externalChequeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ExternalChequePayableDTO>>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ExternalChequePayableDTO> response = ((IExternalChequeService)result.AsyncState).EndFindExternalChequePayablesByExternalChequeId(result);

                    tcs.TrySetResult(new ObservableCollection<ExternalChequePayableDTO>(response ?? new List<ExternalChequePayableDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExternalChequePayablesByExternalChequeId(externalChequeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateExternalChequePayablesByExternalChequeIdAsync(Guid externalChequeId, ObservableCollection<ExternalChequePayableDTO> externalChequePayables, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExternalChequeService service = GetService<IExternalChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExternalChequeService)result.AsyncState).EndUpdateExternalChequePayablesByExternalChequeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateExternalChequePayablesByExternalChequeId(externalChequeId, externalChequePayables.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FiscalCountDTO

        public Task<PageCollectionInfo<FiscalCountDTO>> FindFiscalCountsByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FiscalCountDTO>>();

            IFiscalCountService service = GetService<IFiscalCountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FiscalCountDTO> response = ((IFiscalCountService)result.AsyncState).EndFindFiscalCountsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFiscalCountsByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FiscalCountDTO>> FindFiscalCountsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FiscalCountDTO>>();

            IFiscalCountService service = GetService<IFiscalCountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FiscalCountDTO> response = ((IFiscalCountService)result.AsyncState).EndFindFiscalCountsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFiscalCountsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FiscalCountDTO> AddFiscalCountAsync(FiscalCountDTO fiscalCountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FiscalCountDTO>();

            IFiscalCountService service = GetService<IFiscalCountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FiscalCountDTO response = ((IFiscalCountService)result.AsyncState).EndAddFiscalCount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddFiscalCount(fiscalCountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FiscalCountDTO> FindFiscalCountAsync(Guid fiscalCountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FiscalCountDTO>();

            IFiscalCountService service = GetService<IFiscalCountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FiscalCountDTO response = ((IFiscalCountService)result.AsyncState).EndFindFiscalCount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFiscalCount(fiscalCountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> EndOfDayExecutedAsync(EmployeeDTO employeeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFiscalCountService service = GetService<IFiscalCountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFiscalCountService)result.AsyncState).EndEndOfDayExecuted(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginEndOfDayExecuted(employeeDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ElectronicJournalDTO

        public Task<ElectronicJournalDTO> ParseElectronicJournalImportAsync(string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ElectronicJournalDTO>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ElectronicJournalDTO response = ((IElectronicJournalService)result.AsyncState).EndParseElectronicJournalImport(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseElectronicJournalImport(fileName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ElectronicJournalDTO>> FindElectronicJournalsByFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ElectronicJournalDTO>>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ElectronicJournalDTO> response = ((IElectronicJournalService)result.AsyncState).EndFindElectronicJournalsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicJournalsByFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TruncatedChequeDTO>> FindTruncatedChequesByElectronicJournalIdAndFilterInPageAsync(Guid electronicJournalId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TruncatedChequeDTO>>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TruncatedChequeDTO> response = ((IElectronicJournalService)result.AsyncState).EndFindTruncatedChequesByElectronicJournalIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTruncatedChequesByElectronicJournalIdAndFilterInPage(electronicJournalId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TruncatedChequeDTO>> FindTruncatedChequesByElectronicJournalIdAndStatusAndFilterInPageAsync(Guid electronicJournalId, int status, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TruncatedChequeDTO>>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TruncatedChequeDTO> response = ((IElectronicJournalService)result.AsyncState).EndFindTruncatedChequesByElectronicJournalIdAndStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTruncatedChequesByElectronicJournalIdAndStatusAndFilterInPage(electronicJournalId, status, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CloseElectronicJournalAsync(ElectronicJournalDTO electronicJournalDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IElectronicJournalService)result.AsyncState).EndCloseElectronicJournal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCloseElectronicJournal(electronicJournalDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ClearTruncatedChequeAsync(TruncatedChequeDTO truncatedChequeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IElectronicJournalService)result.AsyncState).EndClearTruncatedCheque(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginClearTruncatedCheque(truncatedChequeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MatchTruncatedChequePaymentVoucherAsync(TruncatedChequeDTO truncatedChequeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IElectronicJournalService)result.AsyncState).EndMatchTruncatedChequePaymentVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchTruncatedChequePaymentVoucher(truncatedChequeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TruncatedChequeDTO> FindTruncatedChequeAsync(Guid truncatedChequeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TruncatedChequeDTO>();

            IElectronicJournalService service = GetService<IElectronicJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TruncatedChequeDTO response = ((IElectronicJournalService)result.AsyncState).EndFindTruncatedCheque(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTruncatedCheque(truncatedChequeId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region InHouseChequeDTO

        public Task<InHouseChequeDTO> AddInHouseChequeAsync(InHouseChequeDTO inHouseChequeDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InHouseChequeDTO>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InHouseChequeDTO response = ((IInHouseChequeService)result.AsyncState).EndAddInHouseCheque(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddInHouseCheque(inHouseChequeDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddInHouseChequesAsync(ObservableCollection<InHouseChequeDTO> inHouseChequeDTOs, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInHouseChequeService)result.AsyncState).EndAddInHouseCheques(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddInHouseCheques(inHouseChequeDTOs.ExtendedToList(), moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InHouseChequeDTO>> FindInHouseChequesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InHouseChequeDTO>>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InHouseChequeDTO> response = ((IInHouseChequeService)result.AsyncState).EndFindInHouseChequesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInHouseChequesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InHouseChequeDTO>> FindInHouseChequesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InHouseChequeDTO>>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InHouseChequeDTO> response = ((IInHouseChequeService)result.AsyncState).EndFindInHouseChequesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInHouseChequesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InHouseChequeDTO>> FindInHouseChequesByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InHouseChequeDTO>>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InHouseChequeDTO> response = ((IInHouseChequeService)result.AsyncState).EndFindInHouseChequesByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInHouseChequesByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InHouseChequeDTO>> FindUnPrintedInHouseChequesByBranchIdAndFilterInPageAsync(Guid branchId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InHouseChequeDTO>>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InHouseChequeDTO> response = ((IInHouseChequeService)result.AsyncState).EndFindUnPrintedInHouseChequesByBranchIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnPrintedInHouseChequesByBranchIdAndFilterInPage(branchId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PrintInHouseChequeAsync(InHouseChequeDTO inHouseChequeDTO, BankLinkageDTO bankLinkageDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInHouseChequeService service = GetService<IInHouseChequeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInHouseChequeService)result.AsyncState).EndPrintInHouseCheque(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPrintInHouseCheque(inHouseChequeDTO, bankLinkageDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FixedDepositDTO

        public Task<PageCollectionInfo<FixedDepositDTO>> FindFixedDepositsByStatusAndFilterInPageAsync(int status, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositDTO> response = ((IFixedDepositService)result.AsyncState).EndFindFixedDepositsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositsByStatusAndFilterInPage(status, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FixedDepositDTO>> FindFixedDepositsByFilterInPageAsync(string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositDTO> response = ((IFixedDepositService)result.AsyncState).EndFindFixedDepositsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositsByFilterInPage(text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FixedDepositDTO>> FindFixedDepositsByBranchIdInPageAsync(Guid branchId, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositDTO> response = ((IFixedDepositService)result.AsyncState).EndFindFixedDepositsByBranchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositsByBranchIdInPage(branchId, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FixedDepositDTO>> FindPayableFixedDepositsByFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositDTO> response = ((IFixedDepositService)result.AsyncState).EndFindPayableFixedDepositsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPayableFixedDepositsByFilterInPage(startDate, endDate, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FixedDepositDTO>> FindRevocableFixedDepositsByFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositDTO> response = ((IFixedDepositService)result.AsyncState).EndFindRevocableFixedDepositsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindRevocableFixedDepositsByFilterInPage(startDate, endDate, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FixedDepositDTO> InvokeFixedDepositAsync(FixedDepositDTO fixedDepositDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FixedDepositDTO>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FixedDepositDTO response = ((IFixedDepositService)result.AsyncState).EndInvokeFixedDeposit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginInvokeFixedDeposit(fixedDepositDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditFixedDepositAsync(FixedDepositDTO fixedDepositDTO, int fixedDepositAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositService)result.AsyncState).EndAuditFixedDeposit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditFixedDeposit(fixedDepositDTO, fixedDepositAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RevokeFixedDepositsAsync(ObservableCollection<FixedDepositDTO> fixedDepositDTOs, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositService)result.AsyncState).EndRevokeFixedDeposits(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRevokeFixedDeposits(fixedDepositDTOs.ExtendedToList(), moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PayFixedDepositAsync(FixedDepositDTO fixedDepositDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositService)result.AsyncState).EndPayFixedDeposit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPayFixedDeposit(fixedDepositDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<FixedDepositDTO>> FindFixedDepositsByCustomerAccountIdAsync(Guid customerAccountId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<FixedDepositDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<FixedDepositDTO> response = ((IFixedDepositService)result.AsyncState).EndFindFixedDepositsByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<FixedDepositDTO>(response ?? new List<FixedDepositDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositsByCustomerAccountId(customerAccountId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<FixedDepositPayableDTO>> FindFixedDepositPayablesByFixedDepositIdAsync(Guid fixedDepositId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<FixedDepositPayableDTO>>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<FixedDepositPayableDTO> response = ((IFixedDepositService)result.AsyncState).EndFindFixedDepositPayablesByFixedDepositId(result);

                    tcs.TrySetResult(new ObservableCollection<FixedDepositPayableDTO>(response ?? new List<FixedDepositPayableDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositPayablesByFixedDepositId(fixedDepositId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateFixedDepositPayablesByFixedDepositIdAsync(Guid fixedDepositId, ObservableCollection<FixedDepositPayableDTO> fixedDepositPayables, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositService)result.AsyncState).EndUpdateFixedDepositPayablesByFixedDepositId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateFixedDepositPayablesByFixedDepositId(fixedDepositId, fixedDepositPayables.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecutePayableFixedDepositsAsync(DateTime targetDate, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositService)result.AsyncState).EndExecutePayableFixedDeposits(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecutePayableFixedDeposits(targetDate, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FixedDepositDTO> FindFixedDepositAsync(Guid fixedDepositId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FixedDepositDTO>();

            IFixedDepositService service = GetService<IFixedDepositService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FixedDepositDTO response = ((IFixedDepositService)result.AsyncState).EndFindFixedDeposit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDeposit(fixedDepositId, asyncCallback, service);

            return tcs.Task;
        }
        #endregion

        #region SuperSaverPayableDTO

        public Task<SuperSaverPayableDTO> AddNewSuperSaverPayableAsync(SuperSaverPayableDTO superSaverPayableDTO, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<SuperSaverPayableDTO>();

            ISuperSaverPayableService service = GetService<ISuperSaverPayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SuperSaverPayableDTO response = ((ISuperSaverPayableService)result.AsyncState).EndAddNewSuperSaverPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewSuperSaverPayable(superSaverPayableDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SuperSaverPayableDTO> FindSuperSaverPayableAsync(Guid superSaverPayableId, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<SuperSaverPayableDTO>();

            ISuperSaverPayableService service = GetService<ISuperSaverPayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SuperSaverPayableDTO response = ((ISuperSaverPayableService)result.AsyncState).EndFindSuperSaverPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSuperSaverPayable(superSaverPayableId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SuperSaverPayableDTO>> FindSuperSaverPayablesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SuperSaverPayableDTO>>();

            ISuperSaverPayableService service = GetService<ISuperSaverPayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SuperSaverPayableDTO> response = ((ISuperSaverPayableService)result.AsyncState).EndFindSuperSaverPayablesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSuperSaverPayablesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditSuperSaverPayableAsync(SuperSaverPayableDTO superSaverPayableDTO, int superSaverPayableAuditOption, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISuperSaverPayableService service = GetService<ISuperSaverPayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISuperSaverPayableService)result.AsyncState).EndAuditSuperSaverPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditSuperSaverPayable(superSaverPayableDTO, superSaverPayableAuditOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeSuperSaverPayableAsync(SuperSaverPayableDTO superSaverPayableDTO, int superSaverPayableAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISuperSaverPayableService service = GetService<ISuperSaverPayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISuperSaverPayableService)result.AsyncState).EndAuthorizeSuperSaverPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeSuperSaverPayable(superSaverPayableDTO, superSaverPayableAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SuperSaverInterestDTO> FindCustomerSuperSaverPayableAsync(Guid customerId, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<SuperSaverInterestDTO>();

            ISuperSaverPayableService service = GetService<ISuperSaverPayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SuperSaverInterestDTO response = ((ISuperSaverPayableService)result.AsyncState).EndFindCustomerSuperSaverPayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerSuperSaverPayable(customerId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanPurposeDTO

        public Task<PageCollectionInfo<LoanPurposeDTO>> FindLoanPurposesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanPurposeDTO>>();

            ILoanPurposeService service = GetService<ILoanPurposeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanPurposeDTO> response = ((ILoanPurposeService)result.AsyncState).EndFindLoanPurposesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanPurposesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanPurposeDTO>> FindLoanPurposesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanPurposeDTO>>();

            ILoanPurposeService service = GetService<ILoanPurposeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanPurposeDTO> response = ((ILoanPurposeService)result.AsyncState).EndFindLoanPurposesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanPurposesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanPurposeDTO> AddLoanPurposeAsync(LoanPurposeDTO loanPurposeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanPurposeDTO>();

            ILoanPurposeService service = GetService<ILoanPurposeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanPurposeDTO response = ((ILoanPurposeService)result.AsyncState).EndAddLoanPurpose(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanPurpose(loanPurposeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanPurposeAsync(LoanPurposeDTO loanPurposeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanPurposeService service = GetService<ILoanPurposeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanPurposeService)result.AsyncState).EndUpdateLoanPurpose(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanPurpose(loanPurposeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanPurposeDTO>> FindLoanPurposesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanPurposeDTO>>();

            ILoanPurposeService service = GetService<ILoanPurposeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanPurposeDTO> response = ((ILoanPurposeService)result.AsyncState).EndFindLoanPurposes(result);

                    tcs.TrySetResult(new ObservableCollection<LoanPurposeDTO>(response ?? new List<LoanPurposeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanPurposes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanPurposeDTO> FindLoanPurposeAsync(Guid loanPurposeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanPurposeDTO>();

            ILoanPurposeService service = GetService<ILoanPurposeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanPurposeDTO response = ((ILoanPurposeService)result.AsyncState).EndFindLoanPurpose(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanPurpose(loanPurposeId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanCaseDTO

        public Task<bool> SubstituteLoanGuarantorsAsync(Guid substituteGuarantorCustomerId, ObservableCollection<LoanGuarantorDTO> loansGuaranteed, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndSubstituteLoanGuarantors(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginSubstituteLoanGuarantors(substituteGuarantorCustomerId, loansGuaranteed.ExtendedToList(), moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditLoanCaseAsync(LoanCaseDTO loanCaseDTO, int loanAuditOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndAuditLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditLoanCase(loanCaseDTO, loanAuditOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CancelLoanCaseAsync(LoanCaseDTO loanCaseDTO, int loanCancellationOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndCancelLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCancelLoanCase(loanCaseDTO, loanCancellationOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ApproveLoanCaseAsync(LoanCaseDTO loanCaseDTO, int loanApprovalOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndApproveLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginApproveLoanCase(loanCaseDTO, loanApprovalOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanAppraisalFactorDTO>> FindLoanAppraisalFactorsByLoanCaseIdAsync(Guid loanCaseId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanAppraisalFactorDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanAppraisalFactorDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanAppraisalFactorsByLoanCaseId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanAppraisalFactorDTO>(response ?? new List<LoanAppraisalFactorDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanAppraisalFactorsByLoanCaseId(loanCaseId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanAppraisalFactorsAsync(Guid loanCaseId, ObservableCollection<LoanAppraisalFactorDTO> loanAppraisalFactors, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndUpdateLoanAppraisalFactors(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanAppraisalFactors(loanCaseId, loanAppraisalFactors.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AppraiseLoanCaseAsync(LoanCaseDTO loanCaseDTO, int loanAppraisalOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndAppraiseLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAppraiseLoanCase(loanCaseDTO, loanAppraisalOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanCaseDTO>> FindLoanCasesInPageAsync(int pageIndex, int pageSize, bool includeBatchStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesInPage(pageIndex, pageSize, includeBatchStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanCaseDTO>> FindLoanCasesByFilterInPageAsync(string text, int loanCaseFilter, int pageIndex, int pageSize, bool includeBatchStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByFilterInPage(text, loanCaseFilter, pageIndex, pageSize, includeBatchStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanCaseDTO> AddLoanCaseAsync(LoanCaseDTO loanCaseDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanCaseDTO>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanCaseDTO response = ((ILoanCaseService)result.AsyncState).EndAddLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanCase(loanCaseDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanCaseAsync(LoanCaseDTO loanCaseDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndUpdateLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanCase(loanCaseDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanGuarantorsByLoanCaseIdAsync(Guid loanCaseId, ObservableCollection<LoanGuarantorDTO> loanGuarantors, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndUpdateLoanGuarantorsByLoanCaseId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanGuarantorsByLoanCaseId(loanCaseId, loanGuarantors.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanCollateralsByLoanCaseIdAsync(Guid loanCaseId, ObservableCollection<CustomerDocumentDTO> customerDocuments, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndUpdateLoanCollateralsByLoanCaseId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanCollateralsByLoanCaseId(loanCaseId, customerDocuments.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAttachedLoansByLoanCaseIdAsync(Guid loanCaseId, ObservableCollection<AttachedLoanDTO> attachedLoans, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndUpdateAttachedLoansByLoanCaseId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAttachedLoansByLoanCaseId(loanCaseId, attachedLoans.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanGuarantorDTO>> FindLoanGuarantorsByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanGuarantorDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanGuarantorDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorsByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanGuarantorDTO>(response ?? new List<LoanGuarantorDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorsByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanGuarantorDTO>> FindLoanGuarantorsByCustomerIdAndFilterInPageAsync(Guid customerId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanGuarantorDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanGuarantorDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorsByCustomerIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorsByCustomerIdAndFilterInPage(customerId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanGuarantorDTO>> FindLoanGuarantorsByLoanCaseIdAsync(Guid loanCaseId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanGuarantorDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanGuarantorDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorsByLoanCaseId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanGuarantorDTO>(response ?? new List<LoanGuarantorDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorsByLoanCaseId(loanCaseId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanCaseDTO>> FindLoanCasesByStatusAndFilterInPageAsync(int status, string text, int loanCaseFilter, int pageIndex, int pageSize, bool includeBatchStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByStatusAndFilterInPage(status, text, loanCaseFilter, pageIndex, pageSize, includeBatchStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanGuarantorDTO>> FindLoanGuarantorsByLoaneeCustomerIdAndLoanProductIdAsync(Guid loanCaseCustomerId, Guid loanCaseLoanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanGuarantorDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanGuarantorDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorsByLoaneeCustomerIdAndLoanProductId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanGuarantorDTO>(response ?? new List<LoanGuarantorDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorsByLoaneeCustomerIdAndLoanProductId(loanCaseCustomerId, loanCaseLoanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanGuarantorDTO>> FindLoanGuarantorsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanGuarantorDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanGuarantorDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanCaseDTO>> FindLoanCasesByLoanProductSectionAndFilterInPageAsync(int loanProductSection, int status, DateTime startDate, DateTime endDate, string text, int loanCaseFilter, int pageIndex, int pageSize, bool includeBatchStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByLoanProductSectionAndStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByLoanProductSectionAndStatusAndFilterInPage(loanProductSection, status, startDate, endDate, text, loanCaseFilter, pageIndex, pageSize, includeBatchStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanCaseDTO>> FindLoanCasesByLoanProductCategoryAndFilterInPageAsync(int loanProductCategory, int status, DateTime startDate, DateTime endDate, string text, int loanCaseFilter, decimal approvedAmountThreshold, int pageIndex, int pageSize, bool includeBatchStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByLoanProductCategoryAndStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByLoanProductCategoryAndStatusAndFilterInPage(loanProductCategory, status, startDate, endDate, text, loanCaseFilter, approvedAmountThreshold, pageIndex, pageSize, includeBatchStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<AttachedLoanDTO>> FindAttachedLoansByLoanCaseIdAsync(Guid loanCaseId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AttachedLoanDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AttachedLoanDTO> response = ((ILoanCaseService)result.AsyncState).EndFindAttachedLoansByLoanCaseId(result);

                    tcs.TrySetResult(new ObservableCollection<AttachedLoanDTO>(response ?? new List<AttachedLoanDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAttachedLoansByLoanCaseId(loanCaseId, asyncCallback, service);

            return tcs.Task;
        }
        public Task<ObservableCollection<LoanCaseDTO>> FindLoanCaseByLoanCaseNumberAsync(int caseNumber, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCaseByLoanCaseNumber(result);

                    tcs.TrySetResult(new ObservableCollection<LoanCaseDTO>(response ?? new List<LoanCaseDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCaseByLoanCaseNumber(caseNumber, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanCaseDTO> FindLoanCaseAsync(Guid loanCaseId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanCaseDTO>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanCaseDTO response = ((ILoanCaseService)result.AsyncState).EndFindLoanCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCase(loanCaseId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanGuarantorDTO> FindLoanGuarantorAsync(Guid loanGuarantorId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanGuarantorDTO>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanGuarantorDTO response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantor(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantor(loanGuarantorId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanCaseDTO>> FindLoanCasesByLoanProductSectionAndFilterInPageAsync(int loanProductSection, DateTime startDate, DateTime endDate, string text, int loanCaseFilter, int pageIndex, int pageSize, bool includeBatchStatus, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByLoanProductSectionAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByLoanProductSectionAndFilterInPage(loanProductSection, startDate, endDate, text, loanCaseFilter, pageIndex, pageSize, includeBatchStatus, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanCaseDTO> FindLastLoanCaseByCustomerIdAsync(Guid customerId, Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanCaseDTO>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanCaseDTO response = ((ILoanCaseService)result.AsyncState).EndFindLastLoanCaseByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLastLoanCaseByCustomerId(customerId, loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanCaseDTO>> FindLoanCasesByCustomerIdAndLoanProductIdAndAuxiliaryLoanConditionAsync(Guid customerId, Guid loanProductId, int auxiliaryLoanCondition, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByCustomerIdAndLoanProductIdAndAuxiliaryLoanCondition(result);

                    tcs.TrySetResult(new ObservableCollection<LoanCaseDTO>(response ?? new List<LoanCaseDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByCustomerIdAndLoanProductIdAndAuxiliaryLoanCondition(customerId, loanProductId, auxiliaryLoanCondition, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AttachLoanGuarantorsAsync(Guid sourceCustomerAccountId, Guid destinationLoanProductId, ObservableCollection<LoanGuarantorDTO> loanGuarantors, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndAttachLoanGuarantors(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAttachLoanGuarantors(sourceCustomerAccountId, destinationLoanProductId, loanGuarantors.ExtendedToList(), moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RestructureLoanAsync(Guid branchId, Guid customerAccountId, double NPer, double Pmt, string reference, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndRestructureLoan(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRestructureLoan(branchId, customerAccountId, NPer, Pmt, reference, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanCaseDTO>> FindLoanCasesByCustomerIdInProcessAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCasesByCustomerIdInProcess(result);

                    tcs.TrySetResult(new ObservableCollection<LoanCaseDTO>(response ?? new List<LoanCaseDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCasesByCustomerIdInProcess(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanCaseDTO>> FindLoanCasesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanCaseDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanCaseDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCases(result);

                    tcs.TrySetResult(new ObservableCollection<LoanCaseDTO>(response ?? new List<LoanCaseDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCases(asyncCallback, service);

            return tcs.Task;
        }


        public Task<ObservableCollection<LoanCollateralDTO>> FindLoanCollateralsByLoanCaseIdAsync(Guid loanCaseId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanCollateralDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanCollateralDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanCollateralsByLoanCaseId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanCollateralDTO>(response ?? new List<LoanCollateralDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCollateralsByLoanCaseId(loanCaseId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanGuarantorAttachmentHistoryEntryDTO>> FindLoanGuarantorAttachmentHistoryEntriesByLoanGuarantorAttachmentHistoryIdAsync(Guid loanGuarantorAttachmentHistoryId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanGuarantorAttachmentHistoryEntryDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanGuarantorAttachmentHistoryEntryDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorAttachmentHistoryEntriesByLoanGuarantorAttachmentHistoryId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanGuarantorAttachmentHistoryEntryDTO>(response ?? new List<LoanGuarantorAttachmentHistoryEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorAttachmentHistoryEntriesByLoanGuarantorAttachmentHistoryId(loanGuarantorAttachmentHistoryId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanGuarantorAttachmentHistoryEntryDTO> FindLoanGuarantorAttachmentHistoryEntryAsync(Guid loanGuarantorAttachmentHistoryEntryId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanGuarantorAttachmentHistoryEntryDTO>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanGuarantorAttachmentHistoryEntryDTO response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorAttachmentHistoryEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorAttachmentHistoryEntry(loanGuarantorAttachmentHistoryEntryId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanGuarantorAttachmentHistoryDTO>> FindLoanGuarantorAttachmentHistoryByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanGuarantorAttachmentHistoryDTO>>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanGuarantorAttachmentHistoryDTO> response = ((ILoanCaseService)result.AsyncState).EndFindLoanGuarantorAttachmentHistoryByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanGuarantorAttachmentHistoryByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RelieveLoanGuarantorsAsync(Guid loanGuarantorAttachmentHistoryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndRelieveLoanGuarantors(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRelieveLoanGuarantors(loanGuarantorAttachmentHistoryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveLoanGuarantorsAsync(ObservableCollection<LoanGuarantorDTO> loanGuarantorDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndRemoveLoanGuarantors(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveLoanGuarantors(loanGuarantorDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanGuarantorDTO> AddLoanGuarantorAsync(LoanGuarantorDTO loanGuarantorDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanGuarantorDTO>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanGuarantorDTO response = ((ILoanCaseService)result.AsyncState).EndAddLoanGuarantor(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanGuarantor(loanGuarantorDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReleaseLoanGuarantorsByLoaneeCustomerAccountAsync(CustomerAccountDTO customerAccountDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanCaseService service = GetService<ILoanCaseService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanCaseService)result.AsyncState).EndReleaseLoanGuarantorsByLoaneeCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReleaseLoanGuarantorsByLoaneeCustomerAccount(customerAccountDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region IncomeAdjustmentDTO

        public Task<PageCollectionInfo<IncomeAdjustmentDTO>> FindIncomeAdjustmentsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<IncomeAdjustmentDTO>>();

            IIncomeAdjustmentService service = GetService<IIncomeAdjustmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<IncomeAdjustmentDTO> response = ((IIncomeAdjustmentService)result.AsyncState).EndFindIncomeAdjustmentsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindIncomeAdjustmentsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<IncomeAdjustmentDTO>> FindIncomeAdjustmentsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<IncomeAdjustmentDTO>>();

            IIncomeAdjustmentService service = GetService<IIncomeAdjustmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<IncomeAdjustmentDTO> response = ((IIncomeAdjustmentService)result.AsyncState).EndFindIncomeAdjustmentsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindIncomeAdjustmentsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<IncomeAdjustmentDTO> AddIncomeAdjustmentAsync(IncomeAdjustmentDTO incomeAdjustmentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<IncomeAdjustmentDTO>();

            IIncomeAdjustmentService service = GetService<IIncomeAdjustmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    IncomeAdjustmentDTO response = ((IIncomeAdjustmentService)result.AsyncState).EndAddIncomeAdjustment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddIncomeAdjustment(incomeAdjustmentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateIncomeAdjustmentAsync(IncomeAdjustmentDTO incomeAdjustmentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IIncomeAdjustmentService service = GetService<IIncomeAdjustmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IIncomeAdjustmentService)result.AsyncState).EndUpdateIncomeAdjustment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateIncomeAdjustment(incomeAdjustmentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<IncomeAdjustmentDTO> FindIncomeAdjustmentAsync(Guid incomeAdjustmentId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<IncomeAdjustmentDTO>();

            IIncomeAdjustmentService service = GetService<IIncomeAdjustmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    IncomeAdjustmentDTO response = ((IIncomeAdjustmentService)result.AsyncState).EndFindIncomeAdjustment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindIncomeAdjustment(incomeAdjustmentId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoaningRemarkDTO

        public Task<PageCollectionInfo<LoaningRemarkDTO>> FindLoaningRemarksByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoaningRemarkDTO>>();

            ILoaningRemarkService service = GetService<ILoaningRemarkService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoaningRemarkDTO> response = ((ILoaningRemarkService)result.AsyncState).EndFindLoaningRemarksByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoaningRemarksByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoaningRemarkDTO>> FindLoaningRemarksInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoaningRemarkDTO>>();

            ILoaningRemarkService service = GetService<ILoaningRemarkService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoaningRemarkDTO> response = ((ILoaningRemarkService)result.AsyncState).EndFindLoaningRemarksInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoaningRemarksInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoaningRemarkDTO> AddLoaningRemarkAsync(LoaningRemarkDTO loaningRemarkDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoaningRemarkDTO>();

            ILoaningRemarkService service = GetService<ILoaningRemarkService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoaningRemarkDTO response = ((ILoaningRemarkService)result.AsyncState).EndAddLoaningRemark(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoaningRemark(loaningRemarkDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoaningRemarkAsync(LoaningRemarkDTO loaningRemarkDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoaningRemarkService service = GetService<ILoaningRemarkService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoaningRemarkService)result.AsyncState).EndUpdateLoaningRemark(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoaningRemark(loaningRemarkDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoaningRemarkDTO> FindLoaningRemarkAsync(Guid loaningRemarkId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoaningRemarkDTO>();

            ILoaningRemarkService service = GetService<ILoaningRemarkService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoaningRemarkDTO response = ((ILoaningRemarkService)result.AsyncState).EndFindLoaningRemark(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoaningRemark(loaningRemarkId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DataAttachmentPeriodDTO

        public Task<PageCollectionInfo<DataAttachmentPeriodDTO>> FindDataAttachmentPeriodsByFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DataAttachmentPeriodDTO>>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DataAttachmentPeriodDTO> response = ((IDataAttachmentPeriodService)result.AsyncState).EndFindDataAttachmentPeriodsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDataAttachmentPeriodsByFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DataAttachmentPeriodDTO>> FindDataAttachmentPeriodsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DataAttachmentPeriodDTO>>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DataAttachmentPeriodDTO> response = ((IDataAttachmentPeriodService)result.AsyncState).EndFindDataAttachmentPeriodsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDataAttachmentPeriodsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DataAttachmentPeriodDTO> AddDataAttachmentPeriodAsync(DataAttachmentPeriodDTO dataAttachmentPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DataAttachmentPeriodDTO>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DataAttachmentPeriodDTO response = ((IDataAttachmentPeriodService)result.AsyncState).EndAddDataAttachmentPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDataAttachmentPeriod(dataAttachmentPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDataAttachmentPeriodAsync(DataAttachmentPeriodDTO dataAttachmentPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDataAttachmentPeriodService)result.AsyncState).EndUpdateDataAttachmentPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDataAttachmentPeriod(dataAttachmentPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DataAttachmentPeriodDTO> FindDataAttachmentPeriodAsync(Guid dataAttachmentPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DataAttachmentPeriodDTO>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DataAttachmentPeriodDTO response = ((IDataAttachmentPeriodService)result.AsyncState).EndFindDataAttachmentPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDataAttachmentPeriod(dataAttachmentPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DataAttachmentEntryDTO>> FindDataAttachmentEntriesByDataAttachmentPeriodIdAndFilterInPageAsync(Guid dataAttachmentPeriodId, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DataAttachmentEntryDTO>>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DataAttachmentEntryDTO> response = ((IDataAttachmentPeriodService)result.AsyncState).EndFindDataAttachmentEntriesByDataAttachmentPeriodIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDataAttachmentEntriesByDataAttachmentPeriodIdAndFilterInPage(dataAttachmentPeriodId, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DataAttachmentEntryDTO> AddDataAttachmentEntryAsync(DataAttachmentEntryDTO dataAttachmentEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DataAttachmentEntryDTO>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DataAttachmentEntryDTO response = ((IDataAttachmentPeriodService)result.AsyncState).EndAddDataAttachmentEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDataAttachmentEntry(dataAttachmentEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveDataAttachmentEntriesAsync(ObservableCollection<DataAttachmentEntryDTO> dataAttachmentEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDataAttachmentPeriodService)result.AsyncState).EndRemoveDataAttachmentEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveDataAttachmentEntries(dataAttachmentEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CloseDataAttachmentPeriodAsync(DataAttachmentPeriodDTO dataAttachmentPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDataAttachmentPeriodService)result.AsyncState).EndCloseDataAttachmentPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCloseDataAttachmentPeriod(dataAttachmentPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DataAttachmentPeriodDTO> FindCurrentDataAttachmentPeriodAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DataAttachmentPeriodDTO>();

            IDataAttachmentPeriodService service = GetService<IDataAttachmentPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DataAttachmentPeriodDTO response = ((IDataAttachmentPeriodService)result.AsyncState).EndFindCurrentDataAttachmentPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCurrentDataAttachmentPeriod(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeDTO

        public Task<PageCollectionInfo<EmployeeDTO>> FindEmployeesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDTO>> FindEmployeesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDTO> AddEmployeeAsync(EmployeeDTO employeeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDTO>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDTO response = ((IEmployeeService)result.AsyncState).EndAddEmployee(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployee(employeeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeAsync(EmployeeDTO employeeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeService)result.AsyncState).EndUpdateEmployee(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployee(employeeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CustomerIsEmployeeAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeService)result.AsyncState).EndCustomerIsEmployee(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCustomerIsEmployee(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDTO> FindEmployeeAsync(Guid employeeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDTO>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDTO response = ((IEmployeeService)result.AsyncState).EndFindEmployee(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployee(employeeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EmployeeDTO>> FindEmployeesBySalaryGroupsBranchesAndDepartmentsAsync(SalaryPeriodDTO salaryPeriodDTO, ObservableCollection<SalaryGroupDTO> salaryGroups, ObservableCollection<BranchDTO> branches, ObservableCollection<DepartmentDTO> departments, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployeeDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeesBySalaryGroupsBranchesAndDepartments(result);

                    tcs.TrySetResult(new ObservableCollection<EmployeeDTO>(response ?? new List<EmployeeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeesBySalaryGroupsBranchesAndDepartments(salaryPeriodDTO, salaryGroups.ExtendedToList(), branches.ExtendedToList(), departments.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDTO> FindEmployeeBySerialNumberAsync(int serialNumber, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDTO>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDTO response = ((IEmployeeService)result.AsyncState).EndFindEmployeeBySerialNumber(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeBySerialNumber(serialNumber, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDTO>> FindEmployeesByDepartmentIdAndFilterInPageAsync(Guid departmentId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeesByDepartmentIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeesByDepartmentIdAndFilterInPage(departmentId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EmployeeDTO>> FindEmployeesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployeeDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployees(result);

                    tcs.TrySetResult(new ObservableCollection<EmployeeDTO>(response ?? new List<EmployeeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployees(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeDisciplinaryCaseDTO

        public Task<EmployeeDisciplinaryCaseDTO> AddNewEmployeeDisciplinaryCaseAsync(EmployeeDisciplinaryCaseDTO employeeDisciplinaryCaseDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDisciplinaryCaseDTO>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDisciplinaryCaseDTO response = ((IEmployeeService)result.AsyncState).EndAddNewEmployeeDisciplinaryCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewEmployeeDisciplinaryCase(employeeDisciplinaryCaseDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeDisciplinaryCaseAsync(EmployeeDisciplinaryCaseDTO employeeDisciplinaryCaseDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeService)result.AsyncState).EndUpdateEmployeeDisciplinaryCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeDisciplinaryCase(employeeDisciplinaryCaseDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<EmployeeDisciplinaryCaseDTO>> FindEmployeeDisciplinaryCasesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<EmployeeDisciplinaryCaseDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeDisciplinaryCaseDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeeDisciplinaryCases(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDisciplinaryCases(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDisciplinaryCaseDTO>> FindEmployeeDisciplinaryCasesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDisciplinaryCaseDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDisciplinaryCaseDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeeDisciplinaryCasesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDisciplinaryCasesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDisciplinaryCaseDTO>> FindEmployeeDisciplinaryCasesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDisciplinaryCaseDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDisciplinaryCaseDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeeDisciplinaryCasesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDisciplinaryCasesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDisciplinaryCaseDTO> FindEmployeeDisciplinaryCaseAsync(Guid employeeDisciplinaryCaseId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDisciplinaryCaseDTO>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDisciplinaryCaseDTO response = ((IEmployeeService)result.AsyncState).EndFindEmployeeDisciplinaryCase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDisciplinaryCase(employeeDisciplinaryCaseId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDisciplinaryCaseDTO>> FindEmployeeDisciplinaryCasesByEmployeeIdAsync(Guid employeeId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDisciplinaryCaseDTO>>();

            IEmployeeService service = GetService<IEmployeeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDisciplinaryCaseDTO> response = ((IEmployeeService)result.AsyncState).EndFindEmployeeDisciplinaryCasesByEmployeeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDisciplinaryCasesByEmployeeId(employeeId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeAppraisalTargetDTO

        public Task<ObservableCollection<EmployeeAppraisalTargetDTO>> FindEmployeeAppraisalTargetsAsync(bool updateDepth, bool traverseTree, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployeeAppraisalTargetDTO>>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeAppraisalTargetDTO> response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndFindEmployeeAppraisalTargets(result);

                    tcs.TrySetResult(new ObservableCollection<EmployeeAppraisalTargetDTO>(response ?? new List<EmployeeAppraisalTargetDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalTargets(updateDepth, traverseTree, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeAppraisalTargetDTO>> FindEmployeeAppraisalTargetsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeAppraisalTargetDTO>>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeAppraisalTargetDTO> response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndFindEmployeeAppraisalTargetsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalTargetsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeAppraisalTargetDTO>> FindEmployeeAppraisalTargetsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeAppraisalTargetDTO>>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeAppraisalTargetDTO> response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndFindEmployeeAppraisalTargetsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalTargetsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeAppraisalTargetDTO>> FindChildEmployeeAppraisalTargetsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeAppraisalTargetDTO>>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeAppraisalTargetDTO> response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndFindChildEmployeeAppraisalTargetsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChildEmployeeAppraisalTargetsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<EmployeeAppraisalTargetDTO>> FindChildEmployeeAppraisalTargetsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<EmployeeAppraisalTargetDTO>>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeAppraisalTargetDTO> response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndFindChildEmployeeAppraisalTargets(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChildEmployeeAppraisalTargets(asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeAppraisalTargetDTO> AddEmployeeAppraisalTargetAsync(EmployeeAppraisalTargetDTO employeeAppraisalTargetDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeAppraisalTargetDTO>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeAppraisalTargetDTO response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndAddEmployeeAppraisalTarget(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployeeAppraisalTarget(employeeAppraisalTargetDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeAppraisalTargetAsync(EmployeeAppraisalTargetDTO employeeAppraisalTargetDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndUpdateEmployeeAppraisalTarget(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeAppraisalTarget(employeeAppraisalTargetDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeAppraisalTargetDTO> FindEmployeeAppraisalTargetAsync(Guid employeeAppraisalTargetId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeAppraisalTargetDTO>();

            IEmployeeAppraisalTargetService service = GetService<IEmployeeAppraisalTargetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeAppraisalTargetDTO response = ((IEmployeeAppraisalTargetService)result.AsyncState).EndFindEmployeeAppraisalTarget(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalTarget(employeeAppraisalTargetId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region Employee Appraisal

        public Task<bool> AddEmployeeAppraisalAsync(List<EmployeeAppraisalDTO> employeeAppraisalDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeAppraisalService service = GetService<IEmployeeAppraisalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeAppraisalService)result.AsyncState).EndAddNewEmployeeAppraisal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewEmployeeAppraisal(employeeAppraisalDTOs, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeAppraisalAsync(EmployeeAppraisalDTO employeeAppraisalDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeAppraisalService service = GetService<IEmployeeAppraisalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeAppraisalService)result.AsyncState).EndUpdateEmployeeAppraisal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeAppraisal(employeeAppraisalDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AppraiseEmployeeAppraisalAsync(EmployeeAppraisalDTO employeeAppraisalDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeAppraisalService service = GetService<IEmployeeAppraisalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeAppraisalService)result.AsyncState).EndAppraiseEmployeeAppraisal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAppraiseEmployeeAppraisal(employeeAppraisalDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeAppraisalDTO>> FindEmployeeAppraisalsByPeriodInPageAsync(Guid employeeId, Guid employeeAppraisalPeriodId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeAppraisalDTO>>();

            IEmployeeAppraisalService service = GetService<IEmployeeAppraisalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeAppraisalDTO> response = ((IEmployeeAppraisalService)result.AsyncState).EndFindEmployeeAppraisalsByPeriodInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalsByPeriodInPage(employeeId, employeeAppraisalPeriodId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<EmployeeAppraisalDTO>> FindEmployeeAppraisalsByPeriodAsync(Guid employeeId, Guid employeeAppraisalPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<EmployeeAppraisalDTO>>();

            IEmployeeAppraisalService service = GetService<IEmployeeAppraisalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeAppraisalDTO> response = ((IEmployeeAppraisalService)result.AsyncState).EndFindEmployeeAppraisalsByPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalsByPeriod(employeeId, employeeAppraisalPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ExitInterviewAnswerDTO

        public Task<bool> AddExitInterviewAnswerAsync(List<ExitInterviewAnswerDTO> exitInterviewAnswerDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExitInterviewAnswerService service = GetService<IExitInterviewAnswerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExitInterviewAnswerService)result.AsyncState).EndAddExitInterviewAnswer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddExitInterviewAnswer(exitInterviewAnswerDTOs, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateExitInterviewAnswerAsync(ExitInterviewAnswerDTO exitInterviewAnswerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExitInterviewAnswerService service = GetService<IExitInterviewAnswerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExitInterviewAnswerService)result.AsyncState).EndUpdateExitInterviewAnswer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateExitInterviewAnswer(exitInterviewAnswerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExitInterviewAnswerDTO>> FindExitInterviewAnswersInPageAsync(Guid employeeId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExitInterviewAnswerDTO>>();

            IExitInterviewAnswerService service = GetService<IExitInterviewAnswerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExitInterviewAnswerDTO> response = ((IExitInterviewAnswerService)result.AsyncState).EndFindExitInterviewAnswersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExitInterviewAnswersInPage(employeeId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<ExitInterviewAnswerDTO>> FindExitInterviewAnswersAsync(Guid employeeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<ExitInterviewAnswerDTO>>();

            IExitInterviewAnswerService service = GetService<IExitInterviewAnswerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ExitInterviewAnswerDTO> response = ((IExitInterviewAnswerService)result.AsyncState).EndFindExitInterviewAnswers(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExitInterviewAnswers(employeeId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region TrainingPeriodDTO

        public Task<TrainingPeriodDTO> AddNewTrainingPeriodAsync(TrainingPeriodDTO trainingPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TrainingPeriodDTO>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TrainingPeriodDTO response = ((ITrainingPeriodService)result.AsyncState).EndAddNewTrainingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewTrainingPeriod(trainingPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateTrainingPeriodAsync(TrainingPeriodDTO trainingPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITrainingPeriodService)result.AsyncState).EndUpdateTrainingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateTrainingPeriod(trainingPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TrainingPeriodDTO> FindTrainingPeriodAsync(Guid trainingPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TrainingPeriodDTO>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TrainingPeriodDTO response = ((ITrainingPeriodService)result.AsyncState).EndFindTrainingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTrainingPeriod(trainingPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TrainingPeriodDTO>> FindTrainingPeriodsFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TrainingPeriodDTO>>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TrainingPeriodDTO> response = ((ITrainingPeriodService)result.AsyncState).EndFindTrainingPeriodsFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTrainingPeriodsFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region TrainingPeriodEntryDTO

        public Task<TrainingPeriodEntryDTO> AddTrainingPeriodEntryAsync(TrainingPeriodEntryDTO trainingPeriodEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TrainingPeriodEntryDTO>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TrainingPeriodEntryDTO response = ((ITrainingPeriodService)result.AsyncState).EndAddTrainingPeriodEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTrainingPeriodEntry(trainingPeriodEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateTrainingPeriodEntriesByTrainingPeriodIdAsync(Guid trainingPeriodId, ObservableCollection<TrainingPeriodEntryDTO> trainingPeriodEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITrainingPeriodService)result.AsyncState).EndUpdateTrainingPeriodEntriesByTrainingPeriodId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateTrainingPeriodEntriesByTrainingPeriodId(trainingPeriodId, trainingPeriodEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }
        public Task<TrainingPeriodDTO> AddTrainingPeriodAsync(TrainingPeriodDTO trainingPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TrainingPeriodDTO>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TrainingPeriodDTO response = ((ITrainingPeriodService)result.AsyncState).EndAddTrainingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTrainingPeriod(trainingPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TrainingPeriodEntryDTO>> FindTrainingPeriodEntriesByTrainingPeriodIdFilterInPageAsync(Guid trainingPeriodId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TrainingPeriodEntryDTO>>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TrainingPeriodEntryDTO> response = ((ITrainingPeriodService)result.AsyncState).EndFindTrainingPeriodEntriesByTrainingPeriodIdFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTrainingPeriodEntriesByTrainingPeriodIdFilterInPage(trainingPeriodId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<TrainingPeriodEntryDTO>> FindTrainingPeriodEntriesByEmployeeIdFilterInPageAsync(Guid employeeId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TrainingPeriodEntryDTO>>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TrainingPeriodEntryDTO> response = ((ITrainingPeriodService)result.AsyncState).EndFindTrainingPeriodEntriesByEmployeeIdFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTrainingPeriodEntriesByEmployeeIdFilterInPage(employeeId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveTrainingPeriodEntriesAsync(ObservableCollection<TrainingPeriodEntryDTO> trainingPeriodEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITrainingPeriodService service = GetService<ITrainingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITrainingPeriodService)result.AsyncState).EndRemoveTrainingPeriodEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveTrainingPeriodEntries(trainingPeriodEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeAppraisalPeriodDTO

        public Task<PageCollectionInfo<EmployeeAppraisalPeriodDTO>> FindEmployeeAppraisalPeriodsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeAppraisalPeriodDTO>>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeAppraisalPeriodDTO> response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndFindEmployeeAppraisalPeriodsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalPeriodsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeAppraisalPeriodDTO>> FindEmployeeAppraisalPeriodsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeAppraisalPeriodDTO>>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeAppraisalPeriodDTO> response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndFindEmployeeAppraisalPeriodsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalPeriodsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeAppraisalPeriodDTO> AddEmployeeAppraisalPeriodAsync(EmployeeAppraisalPeriodDTO employeeAppraisalPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeAppraisalPeriodDTO>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeAppraisalPeriodDTO response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndAddEmployeeAppraisalPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployeeAppraisalPeriod(employeeAppraisalPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeAppraisalPeriodAsync(EmployeeAppraisalPeriodDTO employeeAppraisalPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndUpdateEmployeeAppraisalPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeAppraisalPeriod(employeeAppraisalPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeAppraisalPeriodDTO> FindEmployeeAppraisalPeriodAsync(Guid employeeAppraisalPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeAppraisalPeriodDTO>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeAppraisalPeriodDTO response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndFindEmployeeAppraisalPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalPeriod(employeeAppraisalPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeAppraisalPeriodDTO> FindCurrentEmployeeAppraisalPeriodAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeAppraisalPeriodDTO>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeAppraisalPeriodDTO response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndFindCurrentEmployeeAppraisalPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCurrentEmployeeAppraisalPeriod(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeAppraisalPeriodRecommendationDTO

        public Task<bool> UpdateEmployeeAppraisalPeriodRecommendationAsync(EmployeeAppraisalPeriodRecommendationDTO employeeAppraisalPeriodRecommendationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndUpdateEmployeeAppraisalPeriodRecommendation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeAppraisalPeriodRecommendation(employeeAppraisalPeriodRecommendationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeAppraisalPeriodRecommendationDTO> FindEmployeeAppraisalPeriodRecommendationAsync(Guid employeeId, Guid employeeAppraisalPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeAppraisalPeriodRecommendationDTO>();

            IEmployeeAppraisalPeriodService service = GetService<IEmployeeAppraisalPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeAppraisalPeriodRecommendationDTO response = ((IEmployeeAppraisalPeriodService)result.AsyncState).EndFindEmployeeAppraisalPeriodRecommendation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeAppraisalPeriodRecommendation(employeeId, employeeAppraisalPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ExitInterviewQuestionDTO

        public Task<PageCollectionInfo<ExitInterviewQuestionDTO>> FindExitInterviewQuestionsByFilterInPageAsync(string filter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExitInterviewQuestionDTO>>();

            IExitInterviewQuestionService service = GetService<IExitInterviewQuestionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExitInterviewQuestionDTO> response = ((IExitInterviewQuestionService)result.AsyncState).EndFindExitInterviewQuestionsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExitInterviewQuestionsByFilterInPage(filter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<ExitInterviewQuestionDTO>> FindUnlockedExitInterviewQuestionsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<ExitInterviewQuestionDTO>>();

            IExitInterviewQuestionService service = GetService<IExitInterviewQuestionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ExitInterviewQuestionDTO> response = ((IExitInterviewQuestionService)result.AsyncState).EndFindUnlockedExitInterviewQuestions(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnlockedExitInterviewQuestions(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ExitInterviewQuestionDTO> AddExitInterviewQuestionAsync(ExitInterviewQuestionDTO ExitInterviewQuestionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ExitInterviewQuestionDTO>();

            IExitInterviewQuestionService service = GetService<IExitInterviewQuestionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ExitInterviewQuestionDTO response = ((IExitInterviewQuestionService)result.AsyncState).EndAddExitInterviewQuestion(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddExitInterviewQuestion(ExitInterviewQuestionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateExitInterviewQuestionAsync(ExitInterviewQuestionDTO ExitInterviewQuestionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExitInterviewQuestionService service = GetService<IExitInterviewQuestionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExitInterviewQuestionService)result.AsyncState).EndUpdateExitInterviewQuestion(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateExitInterviewQuestion(ExitInterviewQuestionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ExitInterviewQuestionDTO> FindExitInterviewQuestionAsync(Guid ExitInterviewQuestionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ExitInterviewQuestionDTO>();

            IExitInterviewQuestionService service = GetService<IExitInterviewQuestionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ExitInterviewQuestionDTO response = ((IExitInterviewQuestionService)result.AsyncState).EndFindExitInterviewQuestion(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExitInterviewQuestion(ExitInterviewQuestionId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeExitDTO

        public Task<EmployeeExitDTO> AddNewEmployeeExitAsync(EmployeeExitDTO employeeExitDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeExitDTO>();

            IEmployeeExitService service = GetService<IEmployeeExitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeExitDTO response = ((IEmployeeExitService)result.AsyncState).EndAddNewEmployeeExit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewEmployeeExit(employeeExitDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeExitAsync(EmployeeExitDTO employeeExitDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeExitService service = GetService<IEmployeeExitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeExitService)result.AsyncState).EndUpdateEmployeeExit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeExit(employeeExitDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> VerifyEmployeeExitAsync(EmployeeExitDTO employeeExitDTO, int auditOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeExitService service = GetService<IEmployeeExitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeExitService)result.AsyncState).EndVerifyEmployeeExit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginVerifyEmployeeExit(employeeExitDTO, auditOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ApproveEmployeeExitAsync(EmployeeExitDTO employeeExitDTO, int authorizationOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeExitService service = GetService<IEmployeeExitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeExitService)result.AsyncState).EndApproveEmployeeExit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginApproveEmployeeExit(employeeExitDTO, authorizationOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeExitDTO>> FindEmployeeExitsByFilterAndDateInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeExitDTO>>();

            IEmployeeExitService service = GetService<IEmployeeExitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeExitDTO> response = ((IEmployeeExitService)result.AsyncState).EndFindEmployeeExitsByFilterAndDateInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeExitsByFilterAndDateInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeDocumentDTO

        public Task<PageCollectionInfo<EmployeeDocumentDTO>> FindEmployeeDocumentsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDocumentDTO>>();

            IEmployeeDocumentService service = GetService<IEmployeeDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDocumentDTO> response = ((IEmployeeDocumentService)result.AsyncState).EndFindEmployeeDocumentsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDocumentsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeDocumentDTO>> FindEmployeeDocumentsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeDocumentDTO>>();

            IEmployeeDocumentService service = GetService<IEmployeeDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeDocumentDTO> response = ((IEmployeeDocumentService)result.AsyncState).EndFindEmployeeDocumentsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDocumentsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDocumentDTO> AddEmployeeDocumentAsync(EmployeeDocumentDTO employeeDocumentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDocumentDTO>();

            IEmployeeDocumentService service = GetService<IEmployeeDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDocumentDTO response = ((IEmployeeDocumentService)result.AsyncState).EndAddEmployeeDocument(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployeeDocument(employeeDocumentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeDocumentAsync(EmployeeDocumentDTO employeeDocumentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeDocumentService service = GetService<IEmployeeDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeDocumentService)result.AsyncState).EndUpdateEmployeeDocument(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeDocument(employeeDocumentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeDocumentDTO> FindEmployeeDocumentAsync(Guid employeeDocumentId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeDocumentDTO>();

            IEmployeeDocumentService service = GetService<IEmployeeDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeDocumentDTO response = ((IEmployeeDocumentService)result.AsyncState).EndFindEmployeeDocument(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeDocument(employeeDocumentId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DesignationDTO

        public Task<List<DesignationDTO>> FindDesignationsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<DesignationDTO>>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DesignationDTO> response = ((IDesignationService)result.AsyncState).EndFindDesignations(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDesignations(asyncCallback, service);

            return tcs.Task;
        }


        public Task<PageCollectionInfo<DesignationDTO>> FindDesignationsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DesignationDTO>>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DesignationDTO> response = ((IDesignationService)result.AsyncState).EndFindDesignationsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDesignationsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DesignationDTO>> FindDesignationsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DesignationDTO>>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DesignationDTO> response = ((IDesignationService)result.AsyncState).EndFindDesignationsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDesignationsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DesignationDTO>> FindDesignationsTraverseAsync(bool updateDepth, bool traverseTree, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DesignationDTO>>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DesignationDTO> response = ((IDesignationService)result.AsyncState).EndFindDesignationsTraverse(result);

                    tcs.TrySetResult(new ObservableCollection<DesignationDTO>(response ?? new List<DesignationDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDesignationsTraverse(updateDepth, traverseTree, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DesignationDTO> AddDesignationAsync(DesignationDTO designationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DesignationDTO>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DesignationDTO response = ((IDesignationService)result.AsyncState).EndAddDesignation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDesignation(designationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDesignationAsync(DesignationDTO designationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDesignationService)result.AsyncState).EndUpdateDesignation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDesignation(designationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DesignationDTO> FindDesignationAsync(Guid designationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DesignationDTO>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DesignationDTO response = ((IDesignationService)result.AsyncState).EndFindDesignation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDesignation(designationId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DepartmentDTO

        public Task<PageCollectionInfo<DepartmentDTO>> FindDepartmentsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DepartmentDTO>>();

            IDepartmentService service = GetService<IDepartmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DepartmentDTO> response = ((IDepartmentService)result.AsyncState).EndFindDepartmentsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDepartmentsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DepartmentDTO>> FindDepartmentsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DepartmentDTO>>();

            IDepartmentService service = GetService<IDepartmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DepartmentDTO> response = ((IDepartmentService)result.AsyncState).EndFindDepartmentsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDepartmentsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DepartmentDTO>> FindDepartmentsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DepartmentDTO>>();

            IDepartmentService service = GetService<IDepartmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DepartmentDTO> response = ((IDepartmentService)result.AsyncState).EndFindDepartments(result);

                    tcs.TrySetResult(new ObservableCollection<DepartmentDTO>(response ?? new List<DepartmentDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDepartments(asyncCallback, service);

            return tcs.Task;
        }

        public Task<DepartmentDTO> AddDepartmentAsync(DepartmentDTO departmentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DepartmentDTO>();

            IDepartmentService service = GetService<IDepartmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DepartmentDTO response = ((IDepartmentService)result.AsyncState).EndAddDepartment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDepartment(departmentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDepartmentAsync(DepartmentDTO departmentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDepartmentService service = GetService<IDepartmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDepartmentService)result.AsyncState).EndUpdateDepartment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDepartment(departmentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DepartmentDTO> FindDepartmentAsync(Guid departmentId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DepartmentDTO>();

            IDepartmentService service = GetService<IDepartmentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DepartmentDTO response = ((IDepartmentService)result.AsyncState).EndFindDepartment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDepartment(departmentId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region HolidayDTO

        public Task<PageCollectionInfo<HolidayDTO>> FindHolidaysByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<HolidayDTO>>();

            IHolidayService service = GetService<IHolidayService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<HolidayDTO> response = ((IHolidayService)result.AsyncState).EndFindHolidaysByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindHolidaysByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<HolidayDTO>> FindHolidaysByPostingPeriodAsync(Guid postingPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<HolidayDTO>>();

            IHolidayService service = GetService<IHolidayService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<HolidayDTO> response = ((IHolidayService)result.AsyncState).EndFindHolidaysByPostingPeriod(result);

                    tcs.TrySetResult(new ObservableCollection<HolidayDTO>(response ?? new List<HolidayDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindHolidaysByPostingPeriod(postingPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<HolidayDTO> AddHolidayAsync(HolidayDTO holidayDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<HolidayDTO>();

            IHolidayService service = GetService<IHolidayService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    HolidayDTO response = ((IHolidayService)result.AsyncState).EndAddHoliday(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddHoliday(holidayDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateHolidayAsync(HolidayDTO holidayDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IHolidayService service = GetService<IHolidayService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IHolidayService)result.AsyncState).EndUpdateHoliday(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateHoliday(holidayDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveHolidayAsync(Guid holidayId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IHolidayService service = GetService<IHolidayService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IHolidayService)result.AsyncState).EndRemoveHoliday(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveHoliday(holidayId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DateTime?> FindBusinessDayAsync(int addValue, bool nextDay, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DateTime?>();

            IHolidayService service = GetService<IHolidayService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DateTime? response = ((IHolidayService)result.AsyncState).EndFindBusinessDay(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBusinessDay(addValue, nextDay, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region SalaryHeadDTO

        public Task<PageCollectionInfo<SalaryHeadDTO>> FindSalaryHeadsByFilterInPageAsync(string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryHeadDTO>>();

            ISalaryHeadService service = GetService<ISalaryHeadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryHeadDTO> response = ((ISalaryHeadService)result.AsyncState).EndFindSalaryHeadsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryHeadsByFilterInPage(text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SalaryHeadDTO>> FindSalaryHeadsInPageAsync(int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryHeadDTO>>();

            ISalaryHeadService service = GetService<ISalaryHeadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryHeadDTO> response = ((ISalaryHeadService)result.AsyncState).EndFindSalaryHeadsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryHeadsInPage(pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryHeadDTO> AddSalaryHeadAsync(SalaryHeadDTO salaryHeadDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryHeadDTO>();

            ISalaryHeadService service = GetService<ISalaryHeadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryHeadDTO response = ((ISalaryHeadService)result.AsyncState).EndAddSalaryHead(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSalaryHead(salaryHeadDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSalaryHeadAsync(SalaryHeadDTO salaryHeadDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryHeadService service = GetService<ISalaryHeadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryHeadService)result.AsyncState).EndUpdateSalaryHead(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSalaryHead(salaryHeadDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryHeadDTO> FindSalaryHeadAsync(Guid salaryHeadId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryHeadDTO>();

            ISalaryHeadService service = GetService<ISalaryHeadService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryHeadDTO response = ((ISalaryHeadService)result.AsyncState).EndFindSalaryHead(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryHead(salaryHeadId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region SalaryGroupDTO

        public Task<PageCollectionInfo<SalaryGroupDTO>> FindSalaryGroupsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryGroupDTO>>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryGroupDTO> response = ((ISalaryGroupService)result.AsyncState).EndFindSalaryGroupsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryGroupsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSalaryGroupEntriesBySalaryGroupIdAsync(Guid salaryGroupId, ObservableCollection<SalaryGroupEntryDTO> salaryGroupEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryGroupService)result.AsyncState).EndUpdateSalaryGroupEntriesBySalaryGroupId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSalaryGroupEntriesBySalaryGroupId(salaryGroupId, salaryGroupEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SalaryGroupEntryDTO>> FindSalaryGroupEntriesBySalaryGroupIdAsync(Guid salaryGroupId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SalaryGroupEntryDTO>>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SalaryGroupEntryDTO> response = ((ISalaryGroupService)result.AsyncState).EndFindSalaryGroupEntriesBySalaryGroupId(result);

                    tcs.TrySetResult(new ObservableCollection<SalaryGroupEntryDTO>(response ?? new List<SalaryGroupEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryGroupEntriesBySalaryGroupId(salaryGroupId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SalaryGroupDTO>> FindSalaryGroupsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryGroupDTO>>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryGroupDTO> response = ((ISalaryGroupService)result.AsyncState).EndFindSalaryGroupsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryGroupsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryGroupDTO> AddSalaryGroupAsync(SalaryGroupDTO salaryGroupDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryGroupDTO>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryGroupDTO response = ((ISalaryGroupService)result.AsyncState).EndAddSalaryGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSalaryGroup(salaryGroupDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSalaryGroupAsync(SalaryGroupDTO salaryGroupDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryGroupService)result.AsyncState).EndUpdateSalaryGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSalaryGroup(salaryGroupDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryGroupDTO> FindSalaryGroupAsync(Guid salaryGroupId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryGroupDTO>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryGroupDTO response = ((ISalaryGroupService)result.AsyncState).EndFindSalaryGroup(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryGroup(salaryGroupId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryGroupEntryDTO> FindSalaryGroupEntryAsync(Guid salaryGroupEntryId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryGroupEntryDTO>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryGroupEntryDTO response = ((ISalaryGroupService)result.AsyncState).EndFindSalaryGroupEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryGroupEntry(salaryGroupEntryId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SalaryGroupDTO>> FindSalaryGroupsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SalaryGroupDTO>>();

            ISalaryGroupService service = GetService<ISalaryGroupService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SalaryGroupDTO> response = ((ISalaryGroupService)result.AsyncState).EndFindSalaryGroups(result);

                    tcs.TrySetResult(new ObservableCollection<SalaryGroupDTO>(response ?? new List<SalaryGroupDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryGroups(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region SalaryCardDTO

        public Task<PageCollectionInfo<SalaryCardDTO>> FindSalaryCardsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryCardDTO>>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryCardDTO> response = ((ISalaryCardService)result.AsyncState).EndFindSalaryCardsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryCardsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SalaryCardDTO>> FindSalaryCardsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryCardDTO>>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryCardDTO> response = ((ISalaryCardService)result.AsyncState).EndFindSalaryCardsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryCardsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryCardDTO> AddSalaryCardAsync(SalaryCardDTO salaryCardDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryCardDTO>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryCardDTO response = ((ISalaryCardService)result.AsyncState).EndAddSalaryCard(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSalaryCard(salaryCardDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSalaryCardAsync(SalaryCardDTO salaryCardDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryCardService)result.AsyncState).EndUpdateSalaryCard(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSalaryCard(salaryCardDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryCardDTO> FindSalaryCardAsync(Guid salaryCardId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryCardDTO>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryCardDTO response = ((ISalaryCardService)result.AsyncState).EndFindSalaryCard(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryCard(salaryCardId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SalaryCardEntryDTO>> FindSalaryCardEntriesBySalaryCardIdAsync(Guid salaryCardId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SalaryCardEntryDTO>>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SalaryCardEntryDTO> response = ((ISalaryCardService)result.AsyncState).EndFindSalaryCardEntriesBySalaryCardId(result);

                    tcs.TrySetResult(new ObservableCollection<SalaryCardEntryDTO>(response ?? new List<SalaryCardEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryCardEntriesBySalaryCardId(salaryCardId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSalaryCardEntryAsync(SalaryCardEntryDTO salaryCardEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryCardService)result.AsyncState).EndUpdateSalaryCardEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSalaryCardEntry(salaryCardEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ResetSalaryCardEntriesAsync(SalaryCardDTO salaryCardDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryCardService service = GetService<ISalaryCardService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryCardService)result.AsyncState).EndResetSalaryCardEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginResetSalaryCardEntries(salaryCardDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region SalaryPeriodDTO

        public Task<PageCollectionInfo<SalaryPeriodDTO>> FindSalaryPeriodsByFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryPeriodDTO>>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryPeriodDTO> response = ((ISalaryPeriodService)result.AsyncState).EndFindSalaryPeriodsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryPeriodsByFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SalaryPeriodDTO>> FindSalaryPeriodsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SalaryPeriodDTO>>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SalaryPeriodDTO> response = ((ISalaryPeriodService)result.AsyncState).EndFindSalaryPeriodsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryPeriodsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryPeriodDTO> AddSalaryPeriodAsync(SalaryPeriodDTO salaryPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryPeriodDTO>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryPeriodDTO response = ((ISalaryPeriodService)result.AsyncState).EndAddSalaryPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSalaryPeriod(salaryPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSalaryPeriodAsync(SalaryPeriodDTO salaryPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryPeriodService)result.AsyncState).EndUpdateSalaryPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSalaryPeriod(salaryPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SalaryPeriodDTO> FindSalaryPeriodAsync(Guid salaryPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SalaryPeriodDTO>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SalaryPeriodDTO response = ((ISalaryPeriodService)result.AsyncState).EndFindSalaryPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSalaryPeriod(salaryPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ProcessSalaryPeriodAsync(SalaryPeriodDTO salaryPeriodDTO, ObservableCollection<EmployeeDTO> employees, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryPeriodService)result.AsyncState).EndProcessSalaryPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginProcessSalaryPeriod(salaryPeriodDTO, employees.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CloseSalaryPeriodAsync(SalaryPeriodDTO salaryPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryPeriodService)result.AsyncState).EndCloseSalaryPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCloseSalaryPeriod(salaryPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostPaySlipAsync(Guid paySlipId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISalaryPeriodService service = GetService<ISalaryPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISalaryPeriodService)result.AsyncState).EndPostPaySlip(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostPaySlip(paySlipId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region PaySlipDTO

        public Task<ObservableCollection<PaySlipDTO>> FindLoanAppraisalPaySlipsByCustomerIdAsync(Guid customerId, Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<PaySlipDTO>>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PaySlipDTO> response = ((IPaySlipService)result.AsyncState).EndFindLoanAppraisalPaySlipsByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<PaySlipDTO>(response ?? new List<PaySlipDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanAppraisalPaySlipsByCustomerId(customerId, loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<PaySlipDTO>> FindPaySlipsBySalaryPeriodIdAsync(Guid salaryPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<PaySlipDTO>>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PaySlipDTO> response = ((IPaySlipService)result.AsyncState).EndFindPaySlipsBySalaryPeriodId(result);

                    tcs.TrySetResult(new ObservableCollection<PaySlipDTO>(response ?? new List<PaySlipDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaySlipsBySalaryPeriodId(salaryPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<PaySlipEntryDTO>> FindPaySlipEntriesByPaySlipIdAsync(Guid paySlipId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<PaySlipEntryDTO>>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PaySlipEntryDTO> response = ((IPaySlipService)result.AsyncState).EndFindPaySlipEntriesByPaySlipId(result);

                    tcs.TrySetResult(new ObservableCollection<PaySlipEntryDTO>(response ?? new List<PaySlipEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaySlipEntriesByPaySlipId(paySlipId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<PaySlipDTO>> FindPaySlipsBySalaryPeriodIdInPageAsync(Guid salaryPeriodId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PaySlipDTO>>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PaySlipDTO> response = ((IPaySlipService)result.AsyncState).EndFindPaySlipsBySalaryPeriodIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaySlipsBySalaryPeriodIdInPage(salaryPeriodId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<PaySlipDTO>> FindPaySlipsBySalaryPeriodIdAndFilterInPageAsync(Guid salaryPeriodId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PaySlipDTO>>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PaySlipDTO> response = ((IPaySlipService)result.AsyncState).EndFindPaySlipsBySalaryPeriodIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaySlipsBySalaryPeriodIdAndFilterInPage(salaryPeriodId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<PaySlipDTO>> FindQueablePaySlipsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PaySlipDTO>>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PaySlipDTO> response = ((IPaySlipService)result.AsyncState).EndFindQueablePaySlipsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueablePaySlipsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PaySlipDTO> FindPaySlipAsync(Guid paySlipId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PaySlipDTO>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PaySlipDTO response = ((IPaySlipService)result.AsyncState).EndFindPaySlip(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaySlip(paySlipId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PaySlipEntryDTO> FindPaySlipEntryAsync(Guid paySlipEntryId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PaySlipEntryDTO>();

            IPaySlipService service = GetService<IPaySlipService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PaySlipEntryDTO response = ((IPaySlipService)result.AsyncState).EndFindPaySlipEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaySlipEntry(paySlipEntryId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CustomerDTO

        public Task<PageCollectionInfo<CustomerDTO>> FindCustomersByStationIdAndFilterInPageAsync(Guid stationId, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersByStationIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersByStationIdAndFilterInPage(stationId, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerDTO>> FindCustomersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerDTO>> FindCustomersByFilterInPageAsync(string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersByFilterInPage(text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerDTO>> FindCustomersByTypeAndFilterInPageAsync(int type, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersByTypeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersByTypeAndFilterInPage(type, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerDTO>> FindCustomersByRecordStatusAndFilterInPageAsync(int recordStatus, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersByRecordStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersByRecordStatusAndFilterInPage(recordStatus, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerDTO> AddCustomerAsync(CustomerDTO customerDTO, List<DebitTypeDTO> mandatoryDebitTypes, List<InvestmentProductDTO> mandatoryInvestmentProducts, List<SavingsProductDTO> mandatorySavingsProducts, ProductCollectionInfo mandatoryProducts, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerDTO>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerDTO response = ((ICustomerService)result.AsyncState).EndAddCustomer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomer(customerDTO, mandatoryDebitTypes, mandatoryInvestmentProducts, mandatoryProducts, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }



        public Task<bool> UpdateCustomerAsync(CustomerDTO customerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateCustomer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomer(customerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerDTO> FindCustomerAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerDTO>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerDTO response = ((ICustomerService)result.AsyncState).EndFindCustomer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomer(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerDTO>> FindCustomersAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomers(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerDTO>(response ?? new List<CustomerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomers(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerDTO>> FindCustomersByPayrollNumbersAsync(string payrollNumbers, bool matchExtact, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersByPayrollNumbers(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerDTO>(response ?? new List<CustomerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersByPayrollNumbers(payrollNumbers, matchExtact, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerDTO>> FindCustomersByIdentityCardNumberAsync(string identityCardNumber, bool matchExtact, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerDTO> response = ((ICustomerService)result.AsyncState).EndFindCustomersByIdentityCardNumber(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerDTO>(response ?? new List<CustomerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomersByIdentityCardNumber(identityCardNumber, matchExtact, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCustomerStationAsync(CustomerDTO customerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateCustomerStation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomerStation(customerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ResetCustomerStationAsync(ObservableCollection<CustomerDTO> customerDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndResetCustomerStation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginResetCustomerStation(customerDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCustomerBranchAsync(CustomerDTO customerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateCustomerBranch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomerBranch(customerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<decimal> ComputeDividendsPayableByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<decimal>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    decimal response = ((ICustomerService)result.AsyncState).EndComputeDividendsPayableByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0m);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeDividendsPayableByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PopulationRegisterQueryDTO> AddPopulationRegisterQueryAsync(PopulationRegisterQueryDTO populationRegisterQueryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PopulationRegisterQueryDTO>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PopulationRegisterQueryDTO response = ((ICustomerService)result.AsyncState).EndAddPopulationRegisterQuery(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddPopulationRegisterQuery(populationRegisterQueryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizePopulationRegisterQueryAsync(PopulationRegisterQueryDTO populationRegisterQueryDTO, int populationRegisterQueryAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndAuthorizePopulationRegisterQuery(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizePopulationRegisterQuery(populationRegisterQueryDTO, populationRegisterQueryAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> SyncPopulationRegisterQueryResponseAsync(PopulationRegisterQueryDTO populationRegisterQueryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndSyncPopulationRegisterQueryResponse(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(false);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginSyncPopulationRegisterQueryResponse(populationRegisterQueryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PopulationRegisterQueryDTO> FindPopulationRegisterQueryAsync(Guid populationRegisterQueryId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PopulationRegisterQueryDTO>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PopulationRegisterQueryDTO response = ((ICustomerService)result.AsyncState).EndFindPopulationRegisterQuery(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(null);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPopulationRegisterQuery(populationRegisterQueryId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<PopulationRegisterQueryDTO>> FindPopulationRegisterQueriesByFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int populationRegisterFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PopulationRegisterQueryDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PopulationRegisterQueryDTO> response = ((ICustomerService)result.AsyncState).EndFindPopulationRegisterQueriesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPopulationRegisterQueriesByFilterInPage(status, startDate, endDate, text, populationRegisterFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<PopulationRegisterQueryDTO>> FindThirdPartyNotifiablePopulationRegisterQueriesByFilterInPageAsync(string text, int populationRegisterFilter, int pageIndex, int pageSize, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PopulationRegisterQueryDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PopulationRegisterQueryDTO> response = ((ICustomerService)result.AsyncState).EndFindThirdPartyNotifiablePopulationRegisterQueriesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindThirdPartyNotifiablePopulationRegisterQueriesByFilterInPage(text, populationRegisterFilter, pageIndex, pageSize, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<int> GetCustomersCountAsync(ServiceHeader serviceHeader)
        {
            TaskCompletionSource<int> tcs = new TaskCompletionSource<int>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    int response = ((ICustomerService)result.AsyncState).EndGetCustomersCount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(0);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetCustomersCount(asyncCallback, service);

            return tcs.Task;
        }


        #endregion

        #region AccountAlertDTO

        public Task<ObservableCollection<AccountAlertDTO>> FindAccountAlertCollectionByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AccountAlertDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AccountAlertDTO> response = ((ICustomerService)result.AsyncState).EndFindAccountAlertCollectionByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<AccountAlertDTO>(response ?? new List<AccountAlertDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAccountAlertCollectionByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<AccountAlertDTO>> FindAccountAlertCollectionByCustomerIdAndAccountAlertTypeAsync(Guid customerId, int accountAlertType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AccountAlertDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AccountAlertDTO> response = ((ICustomerService)result.AsyncState).EndFindAccountAlertCollectionByCustomerIdAndAccountAlertType(result);

                    tcs.TrySetResult(new ObservableCollection<AccountAlertDTO>(response ?? new List<AccountAlertDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAccountAlertCollectionByCustomerIdAndAccountAlertType(customerId, accountAlertType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAccountAlertCollectionByCustomerIdAsync(Guid customerId, ObservableCollection<AccountAlertDTO> accountAlertCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateAccountAlertCollectionByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAccountAlertCollectionByCustomerId(customerId, accountAlertCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region NextOfKinDTO

        public Task<ObservableCollection<NextOfKinDTO>> FindNextOfKinCollectionByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<NextOfKinDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<NextOfKinDTO> response = ((ICustomerService)result.AsyncState).EndFindNextOfKinCollectionByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<NextOfKinDTO>(response ?? new List<NextOfKinDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindNextOfKinCollectionByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateNextOfKinCollectionAsync(CustomerDTO customerDTO, ObservableCollection<NextOfKinDTO> nextOfKinCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateNextOfKinCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateNextOfKinCollection(customerDTO, nextOfKinCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region RefereeDTO

        public Task<ObservableCollection<RefereeDTO>> FindRefereeCollectionByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<RefereeDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<RefereeDTO> response = ((ICustomerService)result.AsyncState).EndFindRefereeCollectionByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<RefereeDTO>(response ?? new List<RefereeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindRefereeCollectionByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateRefereeCollectionByCustomerIdAsync(Guid customerId, ObservableCollection<RefereeDTO> refereeCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateRefereeCollectionByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateRefereeCollectionByCustomerId(customerId, refereeCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCreditTypesByCustomerIdAsync(Guid customerId, ObservableCollection<CreditTypeDTO> creditTypeCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateCreditTypesByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCreditTypesByCustomerId(customerId, creditTypeCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CreditTypeDTO>> FindCreditTypesByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditTypeDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditTypeDTO> response = ((ICustomerService)result.AsyncState).EndFindCreditTypesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<CreditTypeDTO>(response ?? new List<CreditTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditTypesByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region PartnershipMemberDTO

        public Task<ObservableCollection<PartnershipMemberDTO>> FindPartnershipMemberCollectionByPartnershipIdAsync(Guid partnershipId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<PartnershipMemberDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PartnershipMemberDTO> response = ((ICustomerService)result.AsyncState).EndFindPartnershipMemberCollectionByPartnershipId(result);

                    tcs.TrySetResult(new ObservableCollection<PartnershipMemberDTO>(response ?? new List<PartnershipMemberDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPartnershipMemberCollectionByPartnershipId(partnershipId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdatePartnershipMemberCollectionByPartnershipIdAsync(Guid partnershipId, ObservableCollection<PartnershipMemberDTO> partnershipMemberCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdatePartnershipMemberCollectionByPartnershipId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdatePartnershipMemberCollectionByPartnershipId(partnershipId, partnershipMemberCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CorporationMemberDTO

        public Task<ObservableCollection<CorporationMemberDTO>> FindCorporationMemberCollectionByCorporationIdAsync(Guid corporationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CorporationMemberDTO>>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CorporationMemberDTO> response = ((ICustomerService)result.AsyncState).EndFindCorporationMemberCollectionByCorporationId(result);

                    tcs.TrySetResult(new ObservableCollection<CorporationMemberDTO>(response ?? new List<CorporationMemberDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCorporationMemberCollectionByCorporationId(corporationId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCorporationMemberCollectionByCorporationIdAsync(Guid corporationId, ObservableCollection<CorporationMemberDTO> corporationMemberCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerService service = GetService<ICustomerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerService)result.AsyncState).EndUpdateCorporationMemberCollectionByCorporationId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCorporationMemberCollectionByCorporationId(corporationId, corporationMemberCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region WithdrawalNotificationDTO

        public Task<PageCollectionInfo<WithdrawalNotificationDTO>> FindWithdrawalNotificationsByStatusAndFilterInPageAsync(DateTime startDate, DateTime endDate, int status, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WithdrawalNotificationDTO>>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WithdrawalNotificationDTO> response = ((IWithdrawalNotificationService)result.AsyncState).EndFindWithdrawalNotificationsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWithdrawalNotificationsByStatusAndFilterInPage(startDate, endDate, status, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }
        public Task<bool> UpdateWithdrawalNotificationAsync(WithdrawalNotificationDTO withdrawalNotificationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWithdrawalNotificationService)result.AsyncState).EndUpdateWithdrawalNotification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateWithdrawalNotification(withdrawalNotificationDTO, asyncCallback, service);

            return tcs.Task;
        }
        public Task<PageCollectionInfo<WithdrawalNotificationDTO>> FindWithdrawalNotificationsByFilterInPageAsync(string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WithdrawalNotificationDTO>>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WithdrawalNotificationDTO> response = ((IWithdrawalNotificationService)result.AsyncState).EndFindWithdrawalNotificationsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWithdrawalNotificationsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<WithdrawalNotificationDTO>> FindWithdrawalNotificationsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WithdrawalNotificationDTO>>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WithdrawalNotificationDTO> response = ((IWithdrawalNotificationService)result.AsyncState).EndFindWithdrawalNotificationsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWithdrawalNotificationsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WithdrawalNotificationDTO> AddWithdrawalNotificationAsync(WithdrawalNotificationDTO withdrawalNotificationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WithdrawalNotificationDTO>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WithdrawalNotificationDTO response = ((IWithdrawalNotificationService)result.AsyncState).EndAddWithdrawalNotification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddWithdrawalNotification(withdrawalNotificationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ApproveWithdrawalNotificationAsync(WithdrawalNotificationDTO withdrawalNotificationDTO, int membershipWithdrawalApprovalOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWithdrawalNotificationService)result.AsyncState).EndApproveWithdrawalNotification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginApproveWithdrawalNotification(withdrawalNotificationDTO, membershipWithdrawalApprovalOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditWithdrawalNotificationAsync(WithdrawalNotificationDTO withdrawalNotificationDTO, int membershipWithdrawalAuditOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWithdrawalNotificationService)result.AsyncState).EndAuditWithdrawalNotification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditWithdrawalNotification(withdrawalNotificationDTO, membershipWithdrawalAuditOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> SettleWithdrawalNotificationAsync(WithdrawalNotificationDTO withdrawalNotificationDTO, int membershipWithdrawalSettlementOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWithdrawalNotificationService)result.AsyncState).EndSettleWithdrawalNotification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginSettleWithdrawalNotification(withdrawalNotificationDTO, membershipWithdrawalSettlementOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ProcessDeathSettlementsAsync(WithdrawalNotificationDTO withdrawalNotificationDTO, ObservableCollection<WithdrawalSettlementDTO> withdrawalSettlementDTOs, InsuranceCompanyDTO insuranceCompanyDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWithdrawalNotificationService)result.AsyncState).EndProcessDeathSettlements(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginProcessDeathSettlements(withdrawalNotificationDTO, withdrawalSettlementDTOs.ExtendedToList(), insuranceCompanyDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WithdrawalNotificationDTO> FindWithdrawalNotificationAsync(Guid withdrawalNotificationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WithdrawalNotificationDTO>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WithdrawalNotificationDTO response = ((IWithdrawalNotificationService)result.AsyncState).EndFindWithdrawalNotification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWithdrawalNotification(withdrawalNotificationId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<WithdrawalSettlementDTO>> FindWithdrawalSettlementsByWithdrawalNotificationIdAsync(Guid withdrawalNotificationId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<WithdrawalSettlementDTO>>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<WithdrawalSettlementDTO> response = ((IWithdrawalNotificationService)result.AsyncState).EndFindWithdrawalSettlementsByWithdrawalNotificationId(result);

                    tcs.TrySetResult(new ObservableCollection<WithdrawalSettlementDTO>(response ?? new List<WithdrawalSettlementDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWithdrawalSettlementsByWithdrawalNotificationId(withdrawalNotificationId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }






        public Task<PageCollectionInfo<WithdrawalNotificationDTO>> FindWithdrawalNotificationsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WithdrawalNotificationDTO>>();

            IWithdrawalNotificationService service = GetService<IWithdrawalNotificationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WithdrawalNotificationDTO> response = ((IWithdrawalNotificationService)result.AsyncState).EndFindWithdrawalNotificationsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWithdrawalNotificationsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        #endregion

        #region DelegateDTO

        public Task<PageCollectionInfo<DelegateDTO>> FindDelegatesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DelegateDTO>>();

            IDelegateService service = GetService<IDelegateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DelegateDTO> response = ((IDelegateService)result.AsyncState).EndFindDelegatesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDelegatesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DelegateDTO>> FindDelegatesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DelegateDTO>>();

            IDelegateService service = GetService<IDelegateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DelegateDTO> response = ((IDelegateService)result.AsyncState).EndFindDelegatesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDelegatesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DelegateDTO> AddDelegateAsync(DelegateDTO delegateDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DelegateDTO>();

            IDelegateService service = GetService<IDelegateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DelegateDTO response = ((IDelegateService)result.AsyncState).EndAddDelegate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDelegate(delegateDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDelegateAsync(DelegateDTO delegateDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDelegateService service = GetService<IDelegateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDelegateService)result.AsyncState).EndUpdateDelegate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDelegate(delegateDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DelegateDTO> FindDelegateAsync(Guid delegateId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DelegateDTO>();

            IDelegateService service = GetService<IDelegateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DelegateDTO response = ((IDelegateService)result.AsyncState).EndFindDelegate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDelegate(delegateId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DirectorDTO

        public Task<PageCollectionInfo<DirectorDTO>> FindDirectorsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DirectorDTO>>();

            IDirectorService service = GetService<IDirectorService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DirectorDTO> response = ((IDirectorService)result.AsyncState).EndFindDirectorsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirectorsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DirectorDTO>> FindDirectorsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DirectorDTO>>();

            IDirectorService service = GetService<IDirectorService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DirectorDTO> response = ((IDirectorService)result.AsyncState).EndFindDirectorsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirectorsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DirectorDTO> AddDirectorAsync(DirectorDTO directorDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DirectorDTO>();

            IDirectorService service = GetService<IDirectorService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DirectorDTO response = ((IDirectorService)result.AsyncState).EndAddDirector(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDirector(directorDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDirectorAsync(DirectorDTO directorDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDirectorService service = GetService<IDirectorService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDirectorService)result.AsyncState).EndUpdateDirector(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDirector(directorDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DirectorDTO> FindDirectorAsync(Guid directorId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DirectorDTO>();

            IDirectorService service = GetService<IDirectorService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DirectorDTO response = ((IDirectorService)result.AsyncState).EndFindDirector(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirector(directorId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CustomerDocumentDTO

        public Task<PageCollectionInfo<CustomerDocumentDTO>> FindCustomerDocumentsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDocumentDTO>>();

            ICustomerDocumentService service = GetService<ICustomerDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDocumentDTO> response = ((ICustomerDocumentService)result.AsyncState).EndFindCustomerDocumentsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerDocumentsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerDocumentDTO>> FindCustomerDocumentsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerDocumentDTO>>();

            ICustomerDocumentService service = GetService<ICustomerDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerDocumentDTO> response = ((ICustomerDocumentService)result.AsyncState).EndFindCustomerDocumentsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerDocumentsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerDocumentDTO> AddCustomerDocumentAsync(CustomerDocumentDTO customerDocumentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerDocumentDTO>();

            ICustomerDocumentService service = GetService<ICustomerDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerDocumentDTO response = ((ICustomerDocumentService)result.AsyncState).EndAddCustomerDocument(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomerDocument(customerDocumentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCustomerDocumentAsync(CustomerDocumentDTO customerDocumentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerDocumentService service = GetService<ICustomerDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerDocumentService)result.AsyncState).EndUpdateCustomerDocument(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomerDocument(customerDocumentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerDocumentDTO> FindCustomerDocumentAsync(Guid customerDocumentId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerDocumentDTO>();

            ICustomerDocumentService service = GetService<ICustomerDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerDocumentDTO response = ((ICustomerDocumentService)result.AsyncState).EndFindCustomerDocument(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerDocument(customerDocumentId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerDocumentDTO>> FindCustomerDocumentsByCustomerIdAndTypeAsync(Guid customerId, int type, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerDocumentDTO>>();

            ICustomerDocumentService service = GetService<ICustomerDocumentService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerDocumentDTO> response = ((ICustomerDocumentService)result.AsyncState).EndFindCustomerDocumentsByCustomerIdAndType(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerDocumentDTO>(response ?? new List<CustomerDocumentDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerDocumentsByCustomerIdAndType(customerId, type, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FileRegisterDTO

        public Task<PageCollectionInfo<FileRegisterDTO>> FindFileRegistersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FileRegisterDTO>>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FileRegisterDTO> response = ((IFileRegisterService)result.AsyncState).EndFindFileRegistersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileRegistersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FileRegisterDTO>> FindFileRegistersByFilterInPageAsync(string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FileRegisterDTO>>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FileRegisterDTO> response = ((IFileRegisterService)result.AsyncState).EndFindFileRegistersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileRegistersByFilterInPage(text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FileMovementHistoryDTO>> FindFileMovementHistoryByFileRegisterIdInPageAsync(Guid fileRegisterId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FileMovementHistoryDTO>>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FileMovementHistoryDTO> response = ((IFileRegisterService)result.AsyncState).EndFindFileMovementHistoryByFileRegisterIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileMovementHistoryByFileRegisterIdInPage(fileRegisterId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<FileMovementHistoryDTO>> FindFileMovementHistoryByFileRegisterIdAsync(Guid fileRegisterId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<FileMovementHistoryDTO>>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<FileMovementHistoryDTO> response = ((IFileRegisterService)result.AsyncState).EndFindFileMovementHistoryByFileRegisterId(result);

                    tcs.TrySetResult(new ObservableCollection<FileMovementHistoryDTO>(response ?? new List<FileMovementHistoryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileMovementHistoryByFileRegisterId(fileRegisterId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerFileRegisterLastDepartmentInfo> FindFileRegisterAndLastDepartmentByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerFileRegisterLastDepartmentInfo>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerFileRegisterLastDepartmentInfo response = ((IFileRegisterService)result.AsyncState).EndFindFileRegisterAndLastDepartmentByCustomerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileRegisterAndLastDepartmentByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MultiDestinationDispatchAsync(ObservableCollection<FileMovementHistoryDTO> fileMovementHistoryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFileRegisterService)result.AsyncState).EndMultiDestinationDispatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMultiDestinationDispatch(fileMovementHistoryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> SingleDestinationDispatchAsync(SingleDestinationDispatchModel singleDestinationDispatchModel, ObservableCollection<FileRegisterDTO> fileRegisterDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFileRegisterService)result.AsyncState).EndSingleDestinationDispatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginSingleDestinationDispatch(singleDestinationDispatchModel.SourceDepartmentId, singleDestinationDispatchModel.DestinationDepartmentId, singleDestinationDispatchModel.Remarks, singleDestinationDispatchModel.Carrier, fileRegisterDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReceiveFilesAsync(ObservableCollection<FileRegisterDTO> fileRegisterDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFileRegisterService)result.AsyncState).EndReceiveFiles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReceiveFiles(fileRegisterDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RecallFilesAsync(ObservableCollection<FileRegisterDTO> fileRegisterDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFileRegisterService)result.AsyncState).EndRecallFiles(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRecallFiles(fileRegisterDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FileRegisterDTO>> FindFileRegistersByFilterStatusAndLastFileMovementDestinationDepartmentIdInPageAsync(string text, int customerFilter, int fileMovementStatus, Guid lastDestinationDepartmentId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FileRegisterDTO>>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FileRegisterDTO> response = ((IFileRegisterService)result.AsyncState).EndFindFileRegistersByFilterStatusAndLastFileMovementDestinationDepartmentIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileRegistersByFilterStatusAndLastFileMovementDestinationDepartmentIdInPage(text, customerFilter, fileMovementStatus, lastDestinationDepartmentId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FileRegisterDTO>> FindFileRegistersByFilterExcludingLastDestinationDepartmentIdInPageAsync(string text, int customerFilter, Guid lastDestinationDepartmentId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FileRegisterDTO>>();

            IFileRegisterService service = GetService<IFileRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FileRegisterDTO> response = ((IFileRegisterService)result.AsyncState).EndFindFileRegistersByFilterExcludingLastDestinationDepartmentIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFileRegistersByFilterExcludingLastDestinationDepartmentIdInPage(text, customerFilter, lastDestinationDepartmentId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ZoneDTO

        public Task<PageCollectionInfo<ZoneDTO>> FindZonesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ZoneDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ZoneDTO> response = ((IZoneService)result.AsyncState).EndFindZonesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindZonesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ZoneDTO>> FindZonesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ZoneDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ZoneDTO> response = ((IZoneService)result.AsyncState).EndFindZonesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindZonesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ZoneDTO> AddZoneAsync(ZoneDTO zoneDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ZoneDTO>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ZoneDTO response = ((IZoneService)result.AsyncState).EndAddZone(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddZone(zoneDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateZoneAsync(ZoneDTO zoneDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IZoneService)result.AsyncState).EndUpdateZone(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateZone(zoneDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ZoneDTO> FindZoneAsync(Guid zoneId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ZoneDTO>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ZoneDTO response = ((IZoneService)result.AsyncState).EndFindZone(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindZone(zoneId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<StationDTO> FindStationAsync(Guid stationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<StationDTO>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    StationDTO response = ((IZoneService)result.AsyncState).EndFindStation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStation(stationId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<StationDTO>> FindStationsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StationDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StationDTO> response = ((IZoneService)result.AsyncState).EndFindStations(result);

                    tcs.TrySetResult(new ObservableCollection<StationDTO>(response ?? new List<StationDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStations(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ZoneDTO>> FindZonesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ZoneDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ZoneDTO> response = ((IZoneService)result.AsyncState).EndFindZones(result);

                    tcs.TrySetResult(new ObservableCollection<ZoneDTO>(response ?? new List<ZoneDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindZones(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<StationDTO>> FindStationsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<StationDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<StationDTO> response = ((IZoneService)result.AsyncState).EndFindStationsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStationsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateStationsByZoneIdAsync(Guid zoneId, ObservableCollection<StationDTO> stations, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IZoneService)result.AsyncState).EndUpdateStationsByZoneId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateStationsByZoneId(zoneId, stations.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<StationDTO>> FindStationsByZoneIdAsync(Guid zoneId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StationDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StationDTO> response = ((IZoneService)result.AsyncState).EndFindStationsByZoneId(result);

                    tcs.TrySetResult(new ObservableCollection<StationDTO>(response ?? new List<StationDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStationsByZoneId(zoneId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<StationDTO>> FindStationsByDivisionIdAsync(Guid divisionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StationDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StationDTO> response = ((IZoneService)result.AsyncState).EndFindStationsByDivisionId(result);

                    tcs.TrySetResult(new ObservableCollection<StationDTO>(response ?? new List<StationDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStationsByDivisionId(divisionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<StationDTO>> FindStationsByEmployerIdAsync(Guid employerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StationDTO>>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StationDTO> response = ((IZoneService)result.AsyncState).EndFindStationsByEmployerId(result);

                    tcs.TrySetResult(new ObservableCollection<StationDTO>(response ?? new List<StationDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStationsByEmployerId(employerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveStationAsync(Guid stationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IZoneService)result.AsyncState).EndRemoveStation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveStation(stationId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveZoneAsync(Guid zoneId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IZoneService)result.AsyncState).EndRemoveZone(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveZone(zoneId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveDivisionAsync(Guid divisionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IZoneService)result.AsyncState).EndRemoveDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveDivision(divisionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveEmployerAsync(Guid employerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IZoneService service = GetService<IZoneService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IZoneService)result.AsyncState).EndRemoveEmployer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveEmployer(employerId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployerDTO

        public Task<bool> UpdateDivisionsByEmployerIdAsync(Guid employerId, ObservableCollection<DivisionDTO> divisions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployerService)result.AsyncState).EndUpdateDivisionsByEmployerId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDivisionsByEmployerId(employerId, divisions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DivisionDTO>> FindDivisionsByEmployerIdAsync(Guid employerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DivisionDTO>>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DivisionDTO> response = ((IEmployerService)result.AsyncState).EndFindDivisionsByEmployerId(result);

                    tcs.TrySetResult(new ObservableCollection<DivisionDTO>(response ?? new List<DivisionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDivisionsByEmployerId(employerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ZoneDTO>> FindZonesByEmployerIdAsync(Guid employerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ZoneDTO>>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ZoneDTO> response = ((IEmployerService)result.AsyncState).EndFindZonesByEmployerId(result);

                    tcs.TrySetResult(new ObservableCollection<ZoneDTO>(response ?? new List<ZoneDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindZonesByEmployerId(employerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployerDTO>> FindEmployersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployerDTO>>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployerDTO> response = ((IEmployerService)result.AsyncState).EndFindEmployersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployerDTO>> FindEmployersByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployerDTO>>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployerDTO> response = ((IEmployerService)result.AsyncState).EndFindEmployersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployersByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployerDTO> AddEmployerAsync(EmployerDTO employerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployerDTO>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployerDTO response = ((IEmployerService)result.AsyncState).EndAddEmployer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployer(employerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployerAsync(EmployerDTO employerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployerService)result.AsyncState).EndUpdateEmployer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployer(employerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployerDTO> FindEmployerAsync(Guid employerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployerDTO>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployerDTO response = ((IEmployerService)result.AsyncState).EndFindEmployer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployer(employerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EmployerDTO>> FindEmployersAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployerDTO>>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployerDTO> response = ((IEmployerService)result.AsyncState).EndFindEmployers(result);

                    tcs.TrySetResult(new ObservableCollection<EmployerDTO>(response ?? new List<EmployerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployers(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DivisionDTO>> FindDivisionsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DivisionDTO>>();

            IEmployerService service = GetService<IEmployerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DivisionDTO> response = ((IEmployerService)result.AsyncState).EndFindDivisions(result);

                    tcs.TrySetResult(new ObservableCollection<DivisionDTO>(response ?? new List<DivisionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDivisions(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region AlternateChannelDTO

        public Task<AlternateChannelDTO> AddAlternateChannelAsync(AlternateChannelDTO alternateChannelDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AlternateChannelDTO>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AlternateChannelDTO response = ((IAlternateChannelService)result.AsyncState).EndAddAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAlternateChannel(alternateChannelDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAlternateChannelAsync(AlternateChannelDTO alternateChannelDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelService)result.AsyncState).EndUpdateAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAlternateChannel(alternateChannelDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReplaceAlternateChannelAsync(AlternateChannelDTO alternateChannelDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelService)result.AsyncState).EndReplaceAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReplaceAlternateChannel(alternateChannelDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RenewAlternateChannelAsync(AlternateChannelDTO alternateChannelDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelService)result.AsyncState).EndRenewAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRenewAlternateChannel(alternateChannelDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> DelinkAlternateChannelAsync(AlternateChannelDTO alternateChannelDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelService)result.AsyncState).EndDelinkAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginDelinkAlternateChannel(alternateChannelDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> StopAlternateChannelAsync(AlternateChannelDTO alternateChannelDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelService)result.AsyncState).EndStopAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginStopAlternateChannel(alternateChannelDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AlternateChannelDTO> FindAlternateChannelAsync(Guid alternateChannelId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AlternateChannelDTO>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AlternateChannelDTO response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannel(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannel(alternateChannelId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<AlternateChannelDTO>> FindAlternateChannelsByCustomerAccountIdAsync(Guid customerAccountId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannelsByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<AlternateChannelDTO>(response ?? new List<AlternateChannelDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelsByCustomerAccountId(customerAccountId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<AlternateChannelDTO>> FindAlternateChannelsByCustomerIdAsync(Guid customerId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannelsByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<AlternateChannelDTO>(response ?? new List<AlternateChannelDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelsByCustomerId(customerId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AlternateChannelDTO>> FindAlternateChannelsInPageAsync(int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannelsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelsInPage(pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AlternateChannelDTO>> FindAlternateChannelsByFilterInPageAsync(string text, int alternateChannelFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannelsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelsByFilterInPage(text, alternateChannelFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<AlternateChannelDTO>> FindAlternateChannelsByCardNumberAndCardTypeAsync(string cardNumber, int cardType, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannelsByCardNumberAndCardType(result);

                    tcs.TrySetResult(new ObservableCollection<AlternateChannelDTO>(response ?? new List<AlternateChannelDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelsByCardNumberAndCardType(cardNumber, cardType, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AlternateChannelDTO>> FindAlternateChannelsByTypeAndFilterInPageAsync(int type, int recordStatus, string text, int alternateChannelFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindAlternateChannelsByTypeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelsByTypeAndFilterInPage(type, recordStatus, text, alternateChannelFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AlternateChannelDTO>> FindThirdPartyNotifiableAlternateChannelsByTypeAndFilterInPageAsync(int type, string text, int alternateChannelFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindThirdPartyNotifiableAlternateChannelsByTypeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindThirdPartyNotifiableAlternateChannelsByTypeAndFilterInPage(type, text, alternateChannelFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByAlternateChannelTypeAsync(int alternateChannelType, int alternateChannelKnownChargeType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((IAlternateChannelService)result.AsyncState).EndFindCommissionsByAlternateChannelType(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByAlternateChannelType(alternateChannelType, alternateChannelKnownChargeType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByAlternateChannelTypeAsync(int alternateChannelType, ObservableCollection<CommissionDTO> commissions, int alternateChannelKnownChargeType, int chargeBenefactor, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelService service = GetService<IAlternateChannelService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelService)result.AsyncState).EndUpdateCommissionsByAlternateChannelType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByAlternateChannelType(alternateChannelType, commissions.ExtendedToList(), alternateChannelKnownChargeType, chargeBenefactor, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ChartOfAccountDTO

        public Task<PageCollectionInfo<ChartOfAccountDTO>> FindChartOfAccountsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            TaskCompletionSource<PageCollectionInfo<ChartOfAccountDTO>> tcs = new TaskCompletionSource<PageCollectionInfo<ChartOfAccountDTO>>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ChartOfAccountDTO> response = ((IChartOfAccountService)result.AsyncState).EndFindChartOfAccountsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb))
                        {
                            tcs.TrySetResult(null);
                        }
                        else
                        {
                            tcs.TrySetException(ex);
                        }
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChartOfAccountsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        public Task<List<ChartOfAccountDTO>> FindChartOfAccountsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<ChartOfAccountDTO>>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ChartOfAccountDTO> response = ((IChartOfAccountService)result.AsyncState).EndFindChartOfAccounts(result);

                    tcs.TrySetResult(new List<ChartOfAccountDTO>(response ?? new List<ChartOfAccountDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChartOfAccounts(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<GeneralLedgerAccount>> FindGeneralLedgerAccountsAsync(bool includeBalances, bool updateDepth, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<GeneralLedgerAccount>>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<GeneralLedgerAccount> response = ((IChartOfAccountService)result.AsyncState).EndFindGeneralLedgerAccounts(result);

                    tcs.TrySetResult(new ObservableCollection<GeneralLedgerAccount>(response ?? new List<GeneralLedgerAccount>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerAccounts(includeBalances, updateDepth, asyncCallback, service);

            return tcs.Task;
        }

        public Task<GeneralLedgerAccount> FindGeneralLedgerAccountAsync(Guid chartOfAccountId, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<GeneralLedgerAccount>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    GeneralLedgerAccount response = ((IChartOfAccountService)result.AsyncState).EndFindGeneralLedgerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerAccount(chartOfAccountId, includeBalances, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ChartOfAccountDTO> FindChartOfAccountAsync(Guid chartOfAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ChartOfAccountDTO>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ChartOfAccountDTO response = ((IChartOfAccountService)result.AsyncState).EndFindChartOfAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChartOfAccount(chartOfAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ChartOfAccountDTO> AddChartOfAccountAsync(ChartOfAccountDTO chartOfAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ChartOfAccountDTO>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ChartOfAccountDTO response = ((IChartOfAccountService)result.AsyncState).EndAddChartOfAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddChartOfAccount(chartOfAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateChartOfAccountAsync(ChartOfAccountDTO chartOfAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChartOfAccountService)result.AsyncState).EndUpdateChartOfAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateChartOfAccount(chartOfAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<Guid> GetChartOfAccountMappingForSystemGeneralLedgerAccountCodeAsync(int systemGeneralLedgerAccountCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<Guid>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    Guid response = ((IChartOfAccountService)result.AsyncState).EndGetChartOfAccountMappingForSystemGeneralLedgerAccountCode(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(Guid.Empty);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetChartOfAccountMappingForSystemGeneralLedgerAccountCode(systemGeneralLedgerAccountCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MapSystemGeneralLedgerAccountCodeToChartOfAccountAsync(int systemGeneralLedgerAccountCode, Guid chartOfAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChartOfAccountService)result.AsyncState).EndMapSystemGeneralLedgerAccountCodeToChartOfAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapSystemGeneralLedgerAccountCodeToChartOfAccount(systemGeneralLedgerAccountCode, chartOfAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SystemGeneralLedgerAccountMappingDTO>> FindSystemGeneralLedgerAccountMappingsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SystemGeneralLedgerAccountMappingDTO>>();

            IChartOfAccountService service = GetService<IChartOfAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SystemGeneralLedgerAccountMappingDTO> response = ((IChartOfAccountService)result.AsyncState).EndFindSystemGeneralLedgerAccountMappingsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSystemGeneralLedgerAccountMappingsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CustomerAccountDTO

        public Task<bool> UpdateCustomerAccountAsync(CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndUpdateCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomerAccount(customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountDTO>> FindCustomerAccountsByCustomerIdAsync(Guid customerId, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountDTO>(response ?? new List<CustomerAccountDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByCustomerId(customerId, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ManageCustomerAccountAsync(Guid customerAccountId, int managementAction, string remarks, int remarkType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndManageCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginManageCustomerAccount(customerAccountId, managementAction, remarks, remarkType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ChargeAccountActivationFeeAsync(Guid customerAccountId, string remarks, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndChargeAccountActivationFee(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginChargeAccountActivationFee(customerAccountId, remarks, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountHistoryDTO>> FindCustomerAccountHistoryByCustomerAccountIdAsync(Guid customerAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountHistoryDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountHistoryDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountHistoryByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountHistoryDTO>(response ?? new List<CustomerAccountHistoryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountHistoryByCustomerAccountId(customerAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountHistoryDTO>> FindCustomerAccountHistoryByCustomerAccountIdAndManagementActionAsync(Guid customerAccountId, int managementAction, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountHistoryDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountHistoryDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountHistoryByCustomerAccountIdAndManagementAction(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountHistoryDTO>(response ?? new List<CustomerAccountHistoryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountHistoryByCustomerAccountIdAndManagementAction(customerAccountId, managementAction, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerAccountDTO> FindCustomerAccountAsync(Guid customerAccountId, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerAccountDTO>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerAccountDTO response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccount(customerAccountId, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerAccountDTO> FindCustomerAccountByFullAccountNumberAsync(string fullAccountNumber, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerAccountDTO>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerAccountDTO response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountByFullAccountNumber(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountByFullAccountNumber(fullAccountNumber, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountDTO>> FindCustomerAccountsInPageAsync(int pageIndex, int pageSize, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsInPage(pageIndex, pageSize, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountDTO>> FindCustomerAccountsByFilterInPageAsync(string text, int customerFilter, int pageIndex, int pageSize, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByFilterInPage(text, customerFilter, pageIndex, pageSize, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountDTO>> FindCustomerAccountsByProductCodeAndFilterInPageAsync(int productCode, string text, int customerFilter, int pageIndex, int pageSize, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByProductCodeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByProductCodeAndFilterInPage(productCode, text, customerFilter, pageIndex, pageSize, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountDTO>> FindCustomerAccountsByProductCodeAndRecordStatusAndFilterInPageAsync(int productCode, int recordStatus, string text, int customerFilter, int pageIndex, int pageSize, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByProductCodeAndRecordStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByProductCodeAndRecordStatusAndFilterInPage(productCode, recordStatus, text, customerFilter, pageIndex, pageSize, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountDTO>> FindCustomerAccountsByCustomerIdAndFilterInPageAsync(Guid customerId, int pageIndex, int pageSize, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByCustomerIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByCustomerIdAndFilterInPage(customerId, pageIndex, pageSize, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountDTO>> FindCustomerAccountsByCustomerIdAndCustomerAccountTypeTargetProductIdAsync(Guid customerId, Guid targetProductId, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByCustomerIdAndCustomerAccountTypeTargetProductId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountDTO>(response ?? new List<CustomerAccountDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByCustomerIdAndCustomerAccountTypeTargetProductId(customerId, targetProductId, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerAccountDTO> AddCustomerAccountAsync(CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerAccountDTO>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerAccountDTO response = ((ICustomerAccountService)result.AsyncState).EndAddCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomerAccount(customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddCustomerAccountsAsync(CustomerDTO customerDTO, ObservableCollection<SavingsProductDTO> savingsProducts, ObservableCollection<InvestmentProductDTO> investmentProducts, ObservableCollection<LoanProductDTO> loanProducts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndAddCustomerAccounts(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomerAccounts(customerDTO, savingsProducts.ExtendedToList(), investmentProducts.ExtendedToList(), loanProducts.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountDTO>> FindCustomerAccountsByCustomerIdAndProductCodesAsync(Guid customerId, int[] targetProductCodes, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByCustomerIdAndProductCodes(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountDTO>(response ?? new List<CustomerAccountDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByCustomerIdAndProductCodes(customerId, targetProductCodes, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountCarryForwardDTO>> FindCustomerAccountCarryForwardsByBenefactorCustomerAccountIdInPageAsync(Guid benefactorCustomerAccountId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountCarryForwardDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountCarryForwardDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountCarryForwardsByBenefactorCustomerAccountIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountCarryForwardsByBenefactorCustomerAccountIdInPage(benefactorCustomerAccountId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountCarryForwardDTO>> FindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdInPageAsync(Guid beneficiaryCustomerAccountId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountCarryForwardDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountCarryForwardDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdInPage(beneficiaryCustomerAccountId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountCarryForwardDTO>> FindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdAsync(Guid beneficiaryCustomerAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountCarryForwardDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountCarryForwardDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountCarryForwardDTO>(response ?? new List<CustomerAccountCarryForwardDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountId(beneficiaryCustomerAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountCarryForwardDTO>> FindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdAndChartOfAccountIdAsync(Guid beneficiaryCustomerAccountId, Guid beneficiaryChartOfAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountCarryForwardDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountCarryForwardDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdAndChartOfAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountCarryForwardDTO>(response ?? new List<CustomerAccountCarryForwardDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountCarryForwardsByBeneficiaryCustomerAccountIdAndChartOfAccountId(beneficiaryCustomerAccountId, beneficiaryChartOfAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountCarryForwardDTO>> FindCustomerAccountCarryForwardsByBenefactorCustomerAccountIdAsync(Guid benefactorCustomerAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountCarryForwardDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountCarryForwardDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountCarryForwardsByBenefactorCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountCarryForwardDTO>(response ?? new List<CustomerAccountCarryForwardDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountCarryForwardsByBenefactorCustomerAccountId(benefactorCustomerAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountArrearageDTO>> FindCustomerAccountArrearagesByCustomerAccountIdAsync(Guid customerAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountArrearageDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountArrearageDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountArrearagesByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountArrearageDTO>(response ?? new List<CustomerAccountArrearageDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountArrearagesByCustomerAccountId(customerAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountArrearageDTO>> FindCustomerAccountArrearagesByCustomerAccountIdAndCategoryAsync(Guid customerAccountId, int category, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountArrearageDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountArrearageDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountArrearagesByCustomerAccountIdAndCategory(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountArrearageDTO>(response ?? new List<CustomerAccountArrearageDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountArrearagesByCustomerAccountIdAndCategory(customerAccountId, category, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CustomerAccountSignatoryDTO>> FindCustomerAccountSignatoriesByCustomerAccountIdAsync(Guid customerAccountId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CustomerAccountSignatoryDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CustomerAccountSignatoryDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountSignatoriesByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<CustomerAccountSignatoryDTO>(response ?? new List<CustomerAccountSignatoryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountSignatoriesByCustomerAccountId(customerAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountSignatoryDTO>> FindCustomerAccountSignatoriesByCustomerAccountIdInPageAsync(Guid customerAccountId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountSignatoryDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountSignatoryDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountSignatoriesByCustomerAccountIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountSignatoriesByCustomerAccountIdInPage(customerAccountId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerAccountSignatoryDTO> AddCustomerAccountSignatoryAsync(CustomerAccountSignatoryDTO customerAccountSignatoryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerAccountSignatoryDTO>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerAccountSignatoryDTO response = ((ICustomerAccountService)result.AsyncState).EndAddCustomerAccountSignatory(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomerAccountSignatory(customerAccountSignatoryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveCustomerAccountSignatoriesAsync(ObservableCollection<CustomerAccountSignatoryDTO> customerAccountSignatoryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndRemoveCustomerAccountSignatories(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveCustomerAccountSignatories(customerAccountSignatoryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<decimal> ComputeEligibleLoanAppraisalInvestmentsBalanceAsync(Guid customerId, Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<decimal>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    decimal response = ((ICustomerAccountService)result.AsyncState).EndComputeEligibleLoanAppraisalInvestmentsBalance(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0m);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeEligibleLoanAppraisalInvestmentsBalance(customerId, loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<double> GetLoaneeAppraisalFactorByCustomerClassificationAsync(int customerClassification, Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((ICustomerAccountService)result.AsyncState).EndGetLoaneeAppraisalFactorByCustomerClassification(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetLoaneeAppraisalFactorByCustomerClassification(customerClassification, loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountDTO>> FindCustomerAccountsByCustomerAccountTypeTargetProductIdInPageAsync(Guid targetProductId, int pageIndex, int pageSize, bool includeBalances, bool includeProductDescription, bool includeInterestBalanceForLoanAccounts, bool considerMaturityPeriodForInvestmentAccounts, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountsByCustomerAccountTypeTargetProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountsByCustomerAccountTypeTargetProductId(targetProductId, pageIndex, pageSize, includeBalances, includeProductDescription, includeInterestBalanceForLoanAccounts, considerMaturityPeriodForInvestmentAccounts, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerAccountArrearageDTO> AddCustomerAccountArrearageAsync(CustomerAccountArrearageDTO customerAccountArrearageDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerAccountArrearageDTO>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerAccountArrearageDTO response = ((ICustomerAccountService)result.AsyncState).EndAddCustomerAccountArrearage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomerAccountArrearage(customerAccountArrearageDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCustomerAccountArrearagesAsync(ObservableCollection<CustomerAccountArrearageDTO> customerAccountArrearages, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndUpdateCustomerAccountArrearages(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomerAccountArrearages(customerAccountArrearages.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<CustomerAccountCarryForwardDTO> AddCustomerAccountCarryForwardAsync(CustomerAccountCarryForwardDTO customerAccountCarryForwardDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CustomerAccountCarryForwardDTO>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CustomerAccountCarryForwardDTO response = ((ICustomerAccountService)result.AsyncState).EndAddCustomerAccountCarryForward(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCustomerAccountCarryForward(customerAccountCarryForwardDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCustomerAccountCarryForwardInstallmentAsync(CustomerAccountCarryForwardInstallmentDTO customerAccountCarryForwardInstallmentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndUpdateCustomerAccountCarryForwardInstallment(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCustomerAccountCarryForwardInstallment(customerAccountCarryForwardInstallmentDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CustomerAccountCarryForwardInstallmentDTO>> FindCustomerAccountCarryForwardInstallmentsByFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int customerFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CustomerAccountCarryForwardInstallmentDTO>>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CustomerAccountCarryForwardInstallmentDTO> response = ((ICustomerAccountService)result.AsyncState).EndFindCustomerAccountCarryForwardInstallmentsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCustomerAccountCarryForwardInstallmentsByFilterInPage(startDate, endDate, text, customerFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AdjustCustomerAccountLoanInterestAsync(LoanInterestAdjustmentDTO loanInterestAdjustmentDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICustomerAccountService service = GetService<ICustomerAccountService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICustomerAccountService)result.AsyncState).EndAdjustCustomerAccountLoanInterest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAdjustCustomerAccountLoanInterest(loanInterestAdjustmentDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region JournalDTO

        public Task<double> FVAsync(int termInMonths, int paymentFrequencyPerYear, double APR, double Pmt, double PV, int Due, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((IJournalService)result.AsyncState).EndFV(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFV(termInMonths, paymentFrequencyPerYear, APR, Pmt, PV, Due, asyncCallback, service);

            return tcs.Task;
        }

        public Task<double> PVAsync(int termInMonths, int paymentFrequencyPerYear, double APR, double Pmt, double FV, int Due, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((IJournalService)result.AsyncState).EndPV(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPV(termInMonths, paymentFrequencyPerYear, APR, Pmt, FV, Due, asyncCallback, service);

            return tcs.Task;
        }

        public Task<double> PmtAsync(int interestCalculationMode, int termInMonths, int paymentFrequencyPerYear, double APR, double PV, double FV, int Due, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((IJournalService)result.AsyncState).EndPmt(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPmt(interestCalculationMode, termInMonths, paymentFrequencyPerYear, APR, PV, FV, Due, asyncCallback, service);

            return tcs.Task;
        }

        public Task<double> NPerAsync(int paymentFrequencyPerYear, double APR, double Pmt, double PV, double FV, int Due, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((IJournalService)result.AsyncState).EndNPer(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginNPer(paymentFrequencyPerYear, APR, Pmt, PV, FV, Due, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<AmortizationTableEntry>> RepaymentScheduleAsync(int termInMonths, int paymentFrequencyPerYear, int gracePeriod, int interestCalculationMode, double APR, double PV, double FV, int Due, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AmortizationTableEntry>>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AmortizationTableEntry> response = ((IJournalService)result.AsyncState).EndRepaymentSchedule(result);

                    tcs.TrySetResult(new ObservableCollection<AmortizationTableEntry>(response ?? new List<AmortizationTableEntry>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRepaymentSchedule(termInMonths, paymentFrequencyPerYear, gracePeriod, interestCalculationMode, APR, PV, FV, Due, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> AddJournalAsync(TransactionModel transactionModel, ObservableCollection<TariffWrapper> tariffs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndAddJournal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournal(transactionModel.BranchId, transactionModel.AlternateChannelLogId, transactionModel.TotalValue, transactionModel.PrimaryDescription, transactionModel.SecondaryDescription, transactionModel.Reference, transactionModel.ModuleNavigationItemCode, transactionModel.TransactionCode, transactionModel.ValueDate, transactionModel.CreditChartOfAccountId, transactionModel.DebitChartOfAccountId, tariffs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> AddJournalWithApportionmentsAsync(TransactionModel transactionModel, ObservableCollection<ApportionmentWrapper> apportionments, ObservableCollection<TariffWrapper> tariffs, ObservableCollection<DynamicChargeDTO> dynamicCharges, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndAddJournalWithApportionments(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalWithApportionments(transactionModel.BranchId, transactionModel.AlternateChannelLogId, transactionModel.TotalValue, transactionModel.PrimaryDescription, transactionModel.SecondaryDescription, transactionModel.Reference, transactionModel.ModuleNavigationItemCode, transactionModel.TransactionCode, transactionModel.ValueDate, transactionModel.DebitChartOfAccountId, transactionModel.CreditCustomerAccount, transactionModel.DebitCustomerAccount, apportionments.ExtendedToList(), tariffs.ExtendedToList(), dynamicCharges.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> AddCashManagementJournalAsync(FiscalCountDTO fiscalCountDTO, TransactionModel transactionModel, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndAddCashManagementJournal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCashManagementJournal(fiscalCountDTO, transactionModel.TotalValue, transactionModel.PrimaryDescription, transactionModel.SecondaryDescription, transactionModel.Reference, transactionModel.ModuleNavigationItemCode, transactionModel.TransactionCode, transactionModel.ValueDate, transactionModel.CreditChartOfAccountId, transactionModel.DebitChartOfAccountId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> AddJournalWithCustomerAccountAsync(CustomerTransactionModel customerTransactionModel, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndAddJournalWithCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalWithCustomerAccount(customerTransactionModel.BranchId, customerTransactionModel.TotalValue, customerTransactionModel.PrimaryDescription, customerTransactionModel.SecondaryDescription, customerTransactionModel.Reference, customerTransactionModel.ModuleNavigationItemCode, customerTransactionModel.TransactionCode, customerTransactionModel.ValueDate, customerTransactionModel.CreditChartOfAccountId, customerTransactionModel.DebitChartOfAccountId, customerTransactionModel.CreditCustomerAccount, customerTransactionModel.DebitCustomerAccount, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> AddJournalWithCustomerAccountAndTariffsAsync(CustomerTransactionModel customerTransactionModel, ObservableCollection<TariffWrapper> tariffs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndAddJournalWithCustomerAccountAndTariffs(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalWithCustomerAccountAndTariffs(customerTransactionModel.BranchId, customerTransactionModel.TotalValue, customerTransactionModel.PrimaryDescription, customerTransactionModel.SecondaryDescription, customerTransactionModel.Reference, customerTransactionModel.ModuleNavigationItemCode, customerTransactionModel.TransactionCode, customerTransactionModel.ValueDate, customerTransactionModel.CreditChartOfAccountId, customerTransactionModel.DebitChartOfAccountId, customerTransactionModel.CreditCustomerAccount, customerTransactionModel.DebitCustomerAccount, tariffs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddTariffJournalsWithCustomerAccountAsync(CustomerTransactionModel customerTransactionModel, ObservableCollection<TariffWrapper> tariffs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalService)result.AsyncState).EndAddTariffJournalsWithCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTariffJournalsWithCustomerAccount(null, customerTransactionModel.BranchId, Guid.Empty, customerTransactionModel.SecondaryDescription, customerTransactionModel.Reference, customerTransactionModel.ModuleNavigationItemCode, customerTransactionModel.TransactionCode, customerTransactionModel.ValueDate, customerTransactionModel.CreditCustomerAccount, customerTransactionModel.DebitCustomerAccount, tariffs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AddTariffJournalsWithCustomerAccountAsync(Guid? parentJournalId, Guid branchId, Guid alternateChannelLogId, string secondaryDescription, string reference, int moduleNavigationItemCode, int transactionCode, CustomerAccountDTO creditCustomerAccountDTO, CustomerAccountDTO debitCustomerAccountDTO, ObservableCollection<TariffWrapper> tariffs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalService)result.AsyncState).EndAddTariffJournalsWithCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTariffJournalsWithCustomerAccount(parentJournalId, branchId, alternateChannelLogId, secondaryDescription, reference, moduleNavigationItemCode, transactionCode, null, creditCustomerAccountDTO, debitCustomerAccountDTO, tariffs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalDTO>> FindReversibleJournalsByDateRangeAndFilterInPageAsync(int systemTransactionCode, DateTime startDate, DateTime endDate, string text, int journalFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalDTO>>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalDTO> response = ((IJournalService)result.AsyncState).EndFindReversibleJournalsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReversibleJournalsByDateRangeAndFilterInPage(systemTransactionCode, startDate, endDate, text, journalFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReverseJournalsAsync(ObservableCollection<JournalDTO> journalDTOs, string description, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalService)result.AsyncState).EndReverseJournals(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReverseJournals(journalDTOs.ExtendedToList(), description, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReverseAlternateChannelJournalsAsync(Guid[] alternateChannelLogIds, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalService)result.AsyncState).EndReverseAlternateChannelJournals(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReverseAlternateChannelJournals(alternateChannelLogIds, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> AddJournalWithCustomerAccountAndAlternateChannelLogAndTariffsAsync(Guid branchId, Guid alternateChannelLogId, decimal totalValue, string primaryDescription, string secondaryDescription, string reference, int moduleNavigationItemCode, int transactionCode, Guid creditChartOfAccountId, Guid debitChartOfAccountId, CustomerAccountDTO creditCustomerAccountDTO, CustomerAccountDTO debitCustomerAccountDTO, ObservableCollection<TariffWrapper> tariffs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndAddJournalWithCustomerAccountAndAlternateChannelLogAndTariffs(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalWithCustomerAccountAndAlternateChannelLogAndTariffs(branchId, alternateChannelLogId, totalValue, primaryDescription, secondaryDescription, reference, moduleNavigationItemCode, transactionCode, null, creditChartOfAccountId, debitChartOfAccountId, creditCustomerAccountDTO, debitCustomerAccountDTO, tariffs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalDTO> FindJournalAsync(Guid journalId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalDTO>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalDTO response = ((IJournalService)result.AsyncState).EndFindJournal(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournal(journalId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<JournalEntryDTO>> FindJournalEntriesByJournalIdAsync(Guid journalId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<JournalEntryDTO>>();

            IJournalService service = GetService<IJournalService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<JournalEntryDTO> response = ((IJournalService)result.AsyncState).EndFindJournalEntriesByJournalId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalEntriesByJournalId(journalId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region JournalEntryDTO

        public Task<PageCollectionInfo<GeneralLedgerTransaction>> FindLastXGeneralLedgerTransactionsByCustomerAccountIdAsync(CustomerAccountDTO customerAccountDTO, int lastXItems, bool tallyDebitsCredits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerTransaction>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerTransaction> response = ((IJournalEntryService)result.AsyncState).EndFindLastXGeneralLedgerTransactionsByCustomerAccountId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLastXGeneralLedgerTransactionsByCustomerAccountId(customerAccountDTO, lastXItems, tallyDebitsCredits, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerTransaction>> FindGeneralLedgerTransactionsByCustomerAccountIdAndDateRangeAsync(CustomerAccountDTO customerAccountDTO, DateTime startDate, DateTime endDate, bool tallyDebitsCredits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerTransaction>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerTransaction> response = ((IJournalEntryService)result.AsyncState).EndFindGeneralLedgerTransactionsByCustomerAccountIdAndDateRange(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerTransactionsByCustomerAccountIdAndDateRange(customerAccountDTO, startDate, endDate, tallyDebitsCredits, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerTransaction>> FindGeneralLedgerTransactionsByCustomerAccountIdAndDateRangeInPageAsync(int pageIndex, int pageSize, CustomerAccountDTO customerAccountDTO, DateTime startDate, DateTime endDate, string text, int journalEntryFilter, bool tallyDebitsCredits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerTransaction>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerTransaction> response = ((IJournalEntryService)result.AsyncState).EndFindGeneralLedgerTransactionsByCustomerAccountIdAndDateRangeInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerTransactionsByCustomerAccountIdAndDateRangeInPage(pageIndex, pageSize, customerAccountDTO, startDate, endDate, text, journalEntryFilter, tallyDebitsCredits, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerTransaction>> FindGeneralLedgerTransactionsByChartOfAccountIdAndDateRangeAndFilterInPageAsync(int pageIndex, int pageSize, Guid chartOfAccountId, DateTime startDate, DateTime endDate, string text, int journalEntryFilter, int transactionDateFilter, bool tallyDebitsCredits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerTransaction>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerTransaction> response = ((IJournalEntryService)result.AsyncState).EndFindGeneralLedgerTransactionsByChartOfAccountIdAndDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerTransactionsByChartOfAccountIdAndDateRangeAndFilterInPage(pageIndex, pageSize, chartOfAccountId, startDate, endDate, text, journalEntryFilter, transactionDateFilter, tallyDebitsCredits, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerTransaction>> FindGeneralLedgerTransactionsByChartOfAccountIdAndDateRangeAndTransactionCodeAndReferenceInPageAsync(int pageIndex, int pageSize, Guid chartOfAccountId, DateTime startDate, DateTime endDate, int transactionCode, string reference, int transactionDateFilter, bool tallyDebitsCredits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerTransaction>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerTransaction> response = ((IJournalEntryService)result.AsyncState).EndFindGeneralLedgerTransactionsByChartOfAccountIdAndDateRangeAndTransactionCodeAndReferenceInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerTransactionsByChartOfAccountIdAndDateRangeAndTransactionCodeAndReferenceInPage(pageIndex, pageSize, chartOfAccountId, startDate, endDate, transactionCode, reference, transactionDateFilter, tallyDebitsCredits, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerTransaction>> FindGeneralLedgerTransactionsByDateRangeAndFilterInPageAsync(int pageIndex, int pageSize, DateTime startDate, DateTime endDate, string text, int journalEntryFilter, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerTransaction>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerTransaction> response = ((IJournalEntryService)result.AsyncState).EndFindGeneralLedgerTransactionsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerTransactionsByDateRangeAndFilterInPage(pageIndex, pageSize, startDate, endDate, text, journalEntryFilter, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalEntryDTO>> FindReversibleJournalEntriesByDateRangeAndFilterInPageAsync(int systemTransactionCode, DateTime startDate, DateTime endDate, string text, int journalEntryFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalEntryDTO>>();

            IJournalEntryService service = GetService<IJournalEntryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalEntryDTO> response = ((IJournalEntryService)result.AsyncState).EndFindReversibleJournalEntriesByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReversibleJournalEntriesByDateRangeAndFilterInPage(systemTransactionCode, startDate, endDate, text, journalEntryFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region PostingPeriodDTO

        public Task<PageCollectionInfo<PostingPeriodDTO>> FindPostingPeriodsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PostingPeriodDTO>>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PostingPeriodDTO> response = ((IPostingPeriodService)result.AsyncState).EndFindPostingPeriodsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPostingPeriodsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<PostingPeriodDTO>> FindPostingPeriodsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<PostingPeriodDTO>>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<PostingPeriodDTO> response = ((IPostingPeriodService)result.AsyncState).EndFindPostingPeriodsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPostingPeriodsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PostingPeriodDTO> AddPostingPeriodAsync(PostingPeriodDTO postingPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PostingPeriodDTO>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PostingPeriodDTO response = ((IPostingPeriodService)result.AsyncState).EndAddPostingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddPostingPeriod(postingPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdatePostingPeriodAsync(PostingPeriodDTO postingPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IPostingPeriodService)result.AsyncState).EndUpdatePostingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdatePostingPeriod(postingPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PostingPeriodDTO> FindPostingPeriodAsync(Guid postingPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PostingPeriodDTO>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PostingPeriodDTO response = ((IPostingPeriodService)result.AsyncState).EndFindPostingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPostingPeriod(postingPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PostingPeriodDTO> FindCurrentPostingPeriodAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PostingPeriodDTO>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PostingPeriodDTO response = ((IPostingPeriodService)result.AsyncState).EndFindCurrentPostingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCurrentPostingPeriod(asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ClosePostingPeriodAsync(PostingPeriodDTO postingPeriodDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IPostingPeriodService)result.AsyncState).EndClosePostingPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginClosePostingPeriod(postingPeriodDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }
        public Task<List<PostingPeriodDTO>> FindPostingPeriodsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<PostingPeriodDTO>>();

            IPostingPeriodService service = GetService<IPostingPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PostingPeriodDTO> response = ((IPostingPeriodService)result.AsyncState).EndFindPostingPeriods(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPostingPeriods(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CommissionDTO

        public Task<PageCollectionInfo<CommissionDTO>> FindCommissionsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CommissionDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CommissionDTO> response = ((ICommissionService)result.AsyncState).EndFindCommissionsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CommissionDTO>> FindCommissionsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CommissionDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CommissionDTO> response = ((ICommissionService)result.AsyncState).EndFindCommissionsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((ICommissionService)result.AsyncState).EndFindCommissions(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissions(asyncCallback, service);

            return tcs.Task;
        }

        public Task<CommissionDTO> AddCommissionAsync(CommissionDTO commissionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CommissionDTO>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CommissionDTO response = ((ICommissionService)result.AsyncState).EndAddCommission(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCommission(commissionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionAsync(CommissionDTO commissionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndUpdateCommission(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommission(commissionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CommissionDTO> FindCommissionAsync(Guid commissionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CommissionDTO>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CommissionDTO response = ((ICommissionService)result.AsyncState).EndFindCommission(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommission(commissionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> GetCommissionsForSystemTransactionTypeAsync(int systemTransactionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((ICommissionService)result.AsyncState).EndGetCommissionsForSystemTransactionType(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetCommissionsForSystemTransactionType(systemTransactionType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionSplitDTO>> FindCommissionSplitsByCommissionIdAsync(Guid commissionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionSplitDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionSplitDTO> response = ((ICommissionService)result.AsyncState).EndFindCommissionSplitsByCommissionId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionSplitDTO>(response ?? new List<CommissionSplitDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionSplitsByCommissionId(commissionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionSplitsByCommissionIdAsync(Guid commissionId, ObservableCollection<CommissionSplitDTO> commissionSplits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndUpdateCommissionSplitsByCommissionId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionSplitsByCommissionId(commissionId, commissionSplits.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionLeviesByCommissionIdAsync(Guid commissionId, ObservableCollection<CommissionLevyDTO> commissionLevies, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndUpdateCommissionLeviesByCommissionId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionLeviesByCommissionId(commissionId, commissionLevies.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }


        public Task<ObservableCollection<GraduatedScaleDTO>> FindGraduatedScalesByCommissionIdAsync(Guid commissionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<GraduatedScaleDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<GraduatedScaleDTO> response = ((ICommissionService)result.AsyncState).EndFindGraduatedScalesByCommissionId(result);

                    tcs.TrySetResult(new ObservableCollection<GraduatedScaleDTO>(response ?? new List<GraduatedScaleDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGraduatedScalesByCommissionId(commissionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateGraduatedScalesByCommissionIdAsync(Guid commissionId, ObservableCollection<GraduatedScaleDTO> graduatedScales, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndUpdateGraduatedScalesByCommissionId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateGraduatedScalesByCommissionId(commissionId, graduatedScales.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MapSystemTransactionTypeToCommissionsAsync(int systemTransactionType, ObservableCollection<CommissionDTO> commissions, ChargeDTO chargeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndMapSystemTransactionTypeToCommissions(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMapSystemTransactionTypeToCommissions(systemTransactionType, commissions.ExtendedToArray(), chargeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionSplitAsync(CommissionSplitDTO commissionSplitDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndUpdateCommissionSplit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionSplit(commissionSplitDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LevyDTO>> FindLeviesByCommissionIdAsync(Guid commissionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LevyDTO>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LevyDTO> response = ((ICommissionService)result.AsyncState).EndFindLeviesByCommissionId(result);

                    tcs.TrySetResult(new ObservableCollection<LevyDTO>(response ?? new List<LevyDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeviesByCommissionId(commissionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLeviesByCommissionIdAsync(Guid commissionId, ObservableCollection<LevyDTO> levies, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionService)result.AsyncState).EndUpdateLeviesByCommissionId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLeviesByCommissionId(commissionId, levies.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsAsync(int systemTransactionType, decimal totalValue, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffs(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffs(systemTransactionType, totalValue, customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsByChequeTypeAsync(Guid chequeTypeId, decimal totalValue, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffsByChequeType(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffsByChequeType(chequeTypeId, totalValue, customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsByCreditBatchEntryAsync(CreditBatchEntryDTO creditBatchEntry, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffsByCreditBatchEntry(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffsByCreditBatchEntry(creditBatchEntry, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsBySavingsProductAsync(Guid savingsProductId, int savingsProductKnownChargeType, decimal totalValue, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffsBySavingsProduct(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffsBySavingsProduct(savingsProductId, savingsProductKnownChargeType, totalValue, customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsByAlternateChannelTypeAsync(int alternateChannelType, int alternateChannelTypeKnownChargeType, decimal totalValue, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffsByAlternateChannelType(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffsByAlternateChannelType(alternateChannelType, alternateChannelTypeKnownChargeType, totalValue, customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsByTextAlertAsync(int systemTransactionCode, decimal totalValue, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffsByTextAlert(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffsByTextAlert(systemTransactionCode, totalValue, customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTariffsByLoanProductAsync(Guid loanProductId, int loanProductKnownChargeType, decimal bookBalance, decimal principalBalance, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ICommissionService service = GetService<ICommissionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ICommissionService)result.AsyncState).EndComputeTariffsByLoanProduct(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTariffsByLoanProduct(loanProductId, loanProductKnownChargeType, bookBalance, principalBalance, customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LevyDTO

        public Task<PageCollectionInfo<LevyDTO>> FindLeviesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LevyDTO>>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LevyDTO> response = ((ILevyService)result.AsyncState).EndFindLeviesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeviesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LevyDTO>> FindLeviesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LevyDTO>>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LevyDTO> response = ((ILevyService)result.AsyncState).EndFindLeviesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeviesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LevyDTO>> FindLeviesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LevyDTO>>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LevyDTO> response = ((ILevyService)result.AsyncState).EndFindLevies(result);

                    tcs.TrySetResult(new ObservableCollection<LevyDTO>(response ?? new List<LevyDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLevies(asyncCallback, service);

            return tcs.Task;
        }

        public Task<LevyDTO> AddLevyAsync(LevyDTO levyDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LevyDTO>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LevyDTO response = ((ILevyService)result.AsyncState).EndAddLevy(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLevy(levyDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLevyAsync(LevyDTO levyDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILevyService)result.AsyncState).EndUpdateLevy(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLevy(levyDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LevyDTO> FindLevyAsync(Guid levyId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LevyDTO>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LevyDTO response = ((ILevyService)result.AsyncState).EndFindLevy(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLevy(levyId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LevySplitDTO>> FindLevySplitsByLevyIdAsync(Guid levyId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LevySplitDTO>>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LevySplitDTO> response = ((ILevyService)result.AsyncState).EndFindLevySplitsByLevyId(result);

                    tcs.TrySetResult(new ObservableCollection<LevySplitDTO>(response ?? new List<LevySplitDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLevySplitsByLevyId(levyId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLevySplitsByLevyIdAsync(Guid levyId, ObservableCollection<LevySplitDTO> levySplits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILevyService service = GetService<ILevyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILevyService)result.AsyncState).EndUpdateLevySplitsByLevyId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLevySplitsByLevyId(levyId, levySplits.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region SavingsProductDTO

        public Task<PageCollectionInfo<SavingsProductDTO>> FindSavingsProductsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SavingsProductDTO>>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SavingsProductDTO> response = ((ISavingsProductService)result.AsyncState).EndFindSavingsProductsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSavingsProductsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SavingsProductDTO>> FindSavingsProductsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SavingsProductDTO>>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SavingsProductDTO> response = ((ISavingsProductService)result.AsyncState).EndFindSavingsProducts(result);

                    tcs.TrySetResult(new ObservableCollection<SavingsProductDTO>(response ?? new List<SavingsProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSavingsProducts(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SavingsProductDTO>> FindMandatorySavingsProductsAsync(bool isMandatory, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SavingsProductDTO>>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SavingsProductDTO> response = ((ISavingsProductService)result.AsyncState).EndFindMandatorySavingsProducts(result);

                    tcs.TrySetResult(new ObservableCollection<SavingsProductDTO>(response ?? new List<SavingsProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMandatorySavingsProducts(isMandatory, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<SavingsProductDTO>> FindSavingsProductsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<SavingsProductDTO>>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<SavingsProductDTO> response = ((ISavingsProductService)result.AsyncState).EndFindSavingsProductsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSavingsProductsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SavingsProductDTO> AddSavingsProductAsync(SavingsProductDTO savingsProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SavingsProductDTO>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SavingsProductDTO response = ((ISavingsProductService)result.AsyncState).EndAddSavingsProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSavingsProduct(savingsProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSavingsProductAsync(SavingsProductDTO savingsProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISavingsProductService)result.AsyncState).EndUpdateSavingsProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSavingsProduct(savingsProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SavingsProductDTO> FindSavingsProductAsync(Guid savingsProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SavingsProductDTO>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SavingsProductDTO response = ((ISavingsProductService)result.AsyncState).EndFindSavingsProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSavingsProduct(savingsProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SavingsProductDTO> FindDefaultSavingsProductAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SavingsProductDTO>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SavingsProductDTO response = ((ISavingsProductService)result.AsyncState).EndFindDefaultSavingsProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDefaultSavingsProduct(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsBySavingsProductIdAsync(Guid savingsProductId, int savingsProductKnownChargeType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((ISavingsProductService)result.AsyncState).EndFindCommissionsBySavingsProductId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsBySavingsProductId(savingsProductId, savingsProductKnownChargeType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsBySavingsProductIdAsync(Guid savingsProductId, ObservableCollection<CommissionDTO> commissions, int savingsProductKnownChargeType, int chargeBenefactor, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISavingsProductService)result.AsyncState).EndUpdateCommissionsBySavingsProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsBySavingsProductId(savingsProductId, commissions.ExtendedToList(), savingsProductKnownChargeType, chargeBenefactor, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SavingsProductExemptionDTO>> FindSavingsProductExemptionsBySavingsProductIdAsync(Guid savingsProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SavingsProductExemptionDTO>>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SavingsProductExemptionDTO> response = ((ISavingsProductService)result.AsyncState).EndFindSavingsProductExemptionsBySavingsProductId(result);

                    tcs.TrySetResult(new ObservableCollection<SavingsProductExemptionDTO>(response ?? new List<SavingsProductExemptionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSavingsProductExemptionsBySavingsProductId(savingsProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateSavingsProductExemptionsBySavingsProductIdAsync(Guid savingsProductId, ObservableCollection<SavingsProductExemptionDTO> savingsProductExemptions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ISavingsProductService service = GetService<ISavingsProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ISavingsProductService)result.AsyncState).EndUpdateSavingsProductExemptionsBySavingsProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateSavingsProductExemptionsBySavingsProductId(savingsProductId, savingsProductExemptions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region InvestmentProductDTO

        public Task<PageCollectionInfo<InvestmentProductDTO>> FindInvestmentProductsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InvestmentProductDTO>>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InvestmentProductDTO> response = ((IInvestmentProductService)result.AsyncState).EndFindInvestmentProductsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInvestmentProductsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<InvestmentProductDTO>> FindInvestmentProductsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<InvestmentProductDTO>>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<InvestmentProductDTO> response = ((IInvestmentProductService)result.AsyncState).EndFindInvestmentProducts(result);

                    tcs.TrySetResult(new ObservableCollection<InvestmentProductDTO>(response ?? new List<InvestmentProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInvestmentProducts(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<InvestmentProductDTO>> FindMandatoryInvestmentProductsAsync(bool isMandatory, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<InvestmentProductDTO>>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<InvestmentProductDTO> response = ((IInvestmentProductService)result.AsyncState).EndFindMandatoryInvestmentProducts(result);

                    tcs.TrySetResult(new ObservableCollection<InvestmentProductDTO>(response ?? new List<InvestmentProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMandatoryInvestmentProducts(isMandatory, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<InvestmentProductDTO>> FindInvestmentProductsByCodeAsync(int code, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<InvestmentProductDTO>>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<InvestmentProductDTO> response = ((IInvestmentProductService)result.AsyncState).EndFindInvestmentProductsByCode(result);

                    tcs.TrySetResult(new ObservableCollection<InvestmentProductDTO>(response ?? new List<InvestmentProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInvestmentProductsByCode(code, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InvestmentProductDTO>> FindInvestmentProductsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InvestmentProductDTO>>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InvestmentProductDTO> response = ((IInvestmentProductService)result.AsyncState).EndFindInvestmentProductsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInvestmentProductsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InvestmentProductDTO> AddInvestmentProductAsync(InvestmentProductDTO investmentProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InvestmentProductDTO>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InvestmentProductDTO response = ((IInvestmentProductService)result.AsyncState).EndAddInvestmentProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddInvestmentProduct(investmentProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateInvestmentProductAsync(InvestmentProductDTO investmentProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInvestmentProductService)result.AsyncState).EndUpdateInvestmentProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateInvestmentProduct(investmentProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InvestmentProductDTO> FindInvestmentProductAsync(Guid investmentProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InvestmentProductDTO>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InvestmentProductDTO response = ((IInvestmentProductService)result.AsyncState).EndFindInvestmentProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInvestmentProduct(investmentProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InvestmentProductDTO> FindSuperSaverInvestmentProductAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InvestmentProductDTO>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InvestmentProductDTO response = ((IInvestmentProductService)result.AsyncState).EndFindSuperSaverInvestmentProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindSuperSaverInvestmentProduct(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<InvestmentProductExemptionDTO>> FindInvestmentProductExemptionsByInvestmentProductIdAsync(Guid investmentProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<InvestmentProductExemptionDTO>>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<InvestmentProductExemptionDTO> response = ((IInvestmentProductService)result.AsyncState).EndFindInvestmentProductExemptionsByInvestmentProductId(result);

                    tcs.TrySetResult(new ObservableCollection<InvestmentProductExemptionDTO>(response ?? new List<InvestmentProductExemptionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInvestmentProductExemptionsByInvestmentProductId(investmentProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateInvestmentProductExemptionsByInvestmentProductIdAsync(Guid investmentProductId, ObservableCollection<InvestmentProductExemptionDTO> investmentProductExemptions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInvestmentProductService service = GetService<IInvestmentProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInvestmentProductService)result.AsyncState).EndUpdateInvestmentProductExemptionsByInvestmentProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateInvestmentProductExemptionsByInvestmentProductId(investmentProductId, investmentProductExemptions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanProductDTO

        public Task<PageCollectionInfo<LoanProductDTO>> FindLoanProductsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanProductDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanProductDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        public Task<PageCollectionInfo<LoanProductDTO>> FindLoanProductsByLoanProductSectionAndFilterInPageAsync(int loanProductSection, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanProductDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanProductDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductsByLoanProductSectionAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductsByLoanProductSectionAndFilterInPage(loanProductSection, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanProductDTO>> FindLoanProductsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProducts(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductDTO>(response ?? new List<LoanProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProducts(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanProductDTO>> FindLoanProductsByCodeAsync(int code, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductsByCode(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductDTO>(response ?? new List<LoanProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductsByCode(code, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanProductDTO>> FindLoanProductsByInterestChargeModeAsync(int interestChargeMode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductsByInterestChargeMode(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductDTO>(response ?? new List<LoanProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductsByInterestChargeMode(interestChargeMode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanProductDTO>> FindLoanProductsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanProductDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanProductDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanProductDTO> AddLoanProductAsync(LoanProductDTO loanProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanProductDTO>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanProductDTO response = ((ILoanProductService)result.AsyncState).EndAddLoanProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanProduct(loanProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanProductAsync(LoanProductDTO loanProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateLoanProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanProduct(loanProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DynamicChargeDTO>> FindDynamicChargesByLoanProductIdAsync(Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DynamicChargeDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DynamicChargeDTO> response = ((ILoanProductService)result.AsyncState).EndFindDynamicChargesByLoanProductId(result);

                    tcs.TrySetResult(new ObservableCollection<DynamicChargeDTO>(response ?? new List<DynamicChargeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicChargesByLoanProductId(loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DynamicChargeDTO>> FindDynamicChargesByLoanProductIdAndRecoveryModeAsync(Guid loanProductId, int recoveryMode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DynamicChargeDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DynamicChargeDTO> response = ((ILoanProductService)result.AsyncState).EndFindDynamicChargesByLoanProductIdAndRecoveryMode(result);

                    tcs.TrySetResult(new ObservableCollection<DynamicChargeDTO>(response ?? new List<DynamicChargeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicChargesByLoanProductIdAndRecoveryMode(loanProductId, recoveryMode, asyncCallback, service);

            return tcs.Task;
        }


        public Task<bool> UpdateDynamicChargesByLoanProductIdAsync(Guid loanProductId, ObservableCollection<DynamicChargeDTO> dynamicCharges, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateDynamicChargesByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDynamicChargesByLoanProductId(loanProductId, dynamicCharges.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ProductCollectionInfo> FindAppraisalProductsByLoanProductIdAsync(Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ProductCollectionInfo>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ProductCollectionInfo response = ((ILoanProductService)result.AsyncState).EndFindAppraisalProductsByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAppraisalProductsByLoanProductId(loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAppraisalProductsByLoanProductIdAsync(Guid loanProductId, ProductCollectionInfo appraisalProductsTuple, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateAppraisalProductsByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAppraisalProductsByLoanProductId(loanProductId, appraisalProductsTuple, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanProductDTO> FindLoanProductAsync(Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanProductDTO>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanProductDTO response = ((ILoanProductService)result.AsyncState).EndFindLoanProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProduct(loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanCycleDTO>> FindLoanCyclesByLoanProductIdAsync(Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanCycleDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanCycleDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanCyclesByLoanProductId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanCycleDTO>(response ?? new List<LoanCycleDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanCyclesByLoanProductId(loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanCyclesByLoanProductIdAsync(Guid loanProductId, ObservableCollection<LoanCycleDTO> loanCycles, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateLoanCyclesByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanCyclesByLoanProductId(loanProductId, loanCycles.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanProductDeductibleDTO>> FindLoanProductDeductiblesByLoanProductIdAsync(Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductDeductibleDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductDeductibleDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductDeductiblesByLoanProductId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductDeductibleDTO>(response ?? new List<LoanProductDeductibleDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductDeductiblesByLoanProductId(loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanProductDeductiblesByLoanProductIdAsync(Guid loanProductId, ObservableCollection<LoanProductDeductibleDTO> loanProductDeductibles, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateLoanProductDeductiblesByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanProductDeductiblesByLoanProductId(loanProductId, loanProductDeductibles.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanProductAuxilliaryAppraisalFactorDTO>> FindLoanProductAuxilliaryAppraisalFactorsByLoanProductIdAsync(Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductAuxilliaryAppraisalFactorDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductAuxilliaryAppraisalFactorDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductAuxilliaryAppraisalFactorsByLoanProductId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductAuxilliaryAppraisalFactorDTO>(response ?? new List<LoanProductAuxilliaryAppraisalFactorDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductAuxilliaryAppraisalFactorsByLoanProductId(loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanProductAuxilliaryAppraisalFactorsByLoanProductIdAsync(Guid loanProductId, ObservableCollection<LoanProductAuxilliaryAppraisalFactorDTO> loanProductAuxilliaryAppraisalFactors, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateLoanProductAuxilliaryAppraisalFactorsByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanProductAuxilliaryAppraisalFactorsByLoanProductId(loanProductId, loanProductAuxilliaryAppraisalFactors.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<double> GetLoaneeAppraisalFactorAsync(Guid loanProductId, decimal totalValue, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((ILoanProductService)result.AsyncState).EndGetLoaneeAppraisalFactor(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetLoaneeAppraisalFactor(loanProductId, totalValue, asyncCallback, service);

            return tcs.Task;
        }

        public Task<double> GetGuarantorAppraisalFactorAsync(Guid loanProductId, decimal totalValue, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<double>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    double response = ((ILoanProductService)result.AsyncState).EndGetGuarantorAppraisalFactor(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0d);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginGetGuarantorAppraisalFactor(loanProductId, totalValue, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByLoanProductIdAsync(Guid loanProductId, int loanProductKnownChargeType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((ILoanProductService)result.AsyncState).EndFindCommissionsByLoanProductId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByLoanProductId(loanProductId, loanProductKnownChargeType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByLoanProductIdAsync(Guid loanProductId, ObservableCollection<CommissionDTO> commissions, int loanProductKnownChargeType, int loanProductChargeBasisValue, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateCommissionsByLoanProductId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByLoanProductId(loanProductId, commissions.ExtendedToList(), loanProductKnownChargeType, loanProductChargeBasisValue, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DynamicChargeDTO

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByDynamicChargeIdAsync(Guid dynamicChargeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((IDynamicChargeService)result.AsyncState).EndFindCommissionsByDynamicChargeId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByDynamicChargeId(dynamicChargeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByDynamicChargeIdAsync(Guid dynamicChargeId, ObservableCollection<CommissionDTO> commissions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDynamicChargeService)result.AsyncState).EndUpdateCommissionsByDynamicChargeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByDynamicChargeId(dynamicChargeId, commissions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DynamicChargeDTO>> FindDynamicChargesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DynamicChargeDTO>>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DynamicChargeDTO> response = ((IDynamicChargeService)result.AsyncState).EndFindDynamicChargesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicChargesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DynamicChargeDTO>> FindDynamicChargesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DynamicChargeDTO>>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DynamicChargeDTO> response = ((IDynamicChargeService)result.AsyncState).EndFindDynamicCharges(result);

                    tcs.TrySetResult(new ObservableCollection<DynamicChargeDTO>(response ?? new List<DynamicChargeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicCharges(asyncCallback, service);

            return tcs.Task;
        }

        public Task<DynamicChargeDTO> AddDynamicChargeAsync(DynamicChargeDTO dynamicChargeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DynamicChargeDTO>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DynamicChargeDTO response = ((IDynamicChargeService)result.AsyncState).EndAddDynamicCharge(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDynamicCharge(dynamicChargeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDynamicChargeAsync(DynamicChargeDTO dynamicChargeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDynamicChargeService)result.AsyncState).EndUpdateDynamicCharge(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDynamicCharge(dynamicChargeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DynamicChargeDTO> FindDynamicChargeAsync(Guid dynamicChargeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DynamicChargeDTO>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DynamicChargeDTO response = ((IDynamicChargeService)result.AsyncState).EndFindDynamicCharge(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicCharge(dynamicChargeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DynamicChargeDTO>> FindDynamicChargesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DynamicChargeDTO>>();

            IDynamicChargeService service = GetService<IDynamicChargeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DynamicChargeDTO> response = ((IDynamicChargeService)result.AsyncState).EndFindDynamicChargesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicChargesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CostCenterDTO

        public Task<PageCollectionInfo<CostCenterDTO>> FindCostCentersByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CostCenterDTO>>();

            ICostCenterService service = GetService<ICostCenterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CostCenterDTO> response = ((ICostCenterService)result.AsyncState).EndFindCostCentersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCostCentersByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CostCenterDTO>> FindCostCentersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CostCenterDTO>>();

            ICostCenterService service = GetService<ICostCenterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CostCenterDTO> response = ((ICostCenterService)result.AsyncState).EndFindCostCentersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCostCentersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CostCenterDTO> AddCostCenterAsync(CostCenterDTO costCenterDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CostCenterDTO>();

            ICostCenterService service = GetService<ICostCenterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CostCenterDTO response = ((ICostCenterService)result.AsyncState).EndAddCostCenter(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCostCenter(costCenterDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCostCenterAsync(CostCenterDTO costCenterDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICostCenterService service = GetService<ICostCenterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICostCenterService)result.AsyncState).EndUpdateCostCenter(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCostCenter(costCenterDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CostCenterDTO> FindCostCenterAsync(Guid costCenterId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CostCenterDTO>();

            ICostCenterService service = GetService<ICostCenterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CostCenterDTO response = ((ICostCenterService)result.AsyncState).EndFindCostCenter(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCostCenter(costCenterId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CostCenterDTO>> FindCostCentersAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CostCenterDTO>>();

            ICostCenterService service = GetService<ICostCenterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CostCenterDTO> response = ((ICostCenterService)result.AsyncState).EndFindCostCenters(result);

                    tcs.TrySetResult(new ObservableCollection<CostCenterDTO>(response ?? new List<CostCenterDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCostCenters(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region TellerDTO

        public Task<PageCollectionInfo<TellerDTO>> FindTellersByFilterInPageAsync(int tellerType, string text, int pageIndex, int pageSize, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TellerDTO>>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TellerDTO> response = ((ITellerService)result.AsyncState).EndFindTellersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTellersByFilterInPage(tellerType, text, pageIndex, pageSize, includeBalances, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TellerDTO> AddTellerAsync(TellerDTO tellerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TellerDTO>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TellerDTO response = ((ITellerService)result.AsyncState).EndAddTeller(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTeller(tellerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateTellerAsync(TellerDTO tellerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITellerService)result.AsyncState).EndUpdateTeller(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateTeller(tellerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TellerDTO> FindTellerAsync(Guid tellerId, bool includeBalance, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TellerDTO>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TellerDTO response = ((ITellerService)result.AsyncState).EndFindTeller(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTeller(tellerId, includeBalance, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TellerDTO> FindTellerByEmployeeIdAsync(Guid employeeId, bool includeBalance, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TellerDTO>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TellerDTO response = ((ITellerService)result.AsyncState).EndFindTellerByEmployeeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTellerByEmployeeId(employeeId, includeBalance, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TellerDTO>> FindTellersByTypeAsync(int tellerType, string reference, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TellerDTO>>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TellerDTO> response = ((ITellerService)result.AsyncState).EndFindTellersByType(result);

                    tcs.TrySetResult(new ObservableCollection<TellerDTO>(response ?? new List<TellerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTellersByType(tellerType, reference, includeBalances, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TellerDTO>> FindTellersByReferenceAsync(string reference, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TellerDTO>>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TellerDTO> response = ((ITellerService)result.AsyncState).EndFindTellersByReference(result);

                    tcs.TrySetResult(new ObservableCollection<TellerDTO>(response ?? new List<TellerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTellersByReference(reference, includeBalances, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TellerDTO>> FindTellersAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TellerDTO>>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TellerDTO> response = ((ITellerService)result.AsyncState).EndFindTellers(result);

                    tcs.TrySetResult(new ObservableCollection<TellerDTO>(response ?? new List<TellerDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTellers(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TariffWrapper>> ComputeTellerCashTariffsAsync(CustomerAccountDTO customerAccountDTO, decimal totalValue, int frontOfficeTransactionType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TariffWrapper>>();

            ITellerService service = GetService<ITellerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TariffWrapper> response = ((ITellerService)result.AsyncState).EndComputeTellerCashTariffs(result);

                    tcs.TrySetResult(new ObservableCollection<TariffWrapper>(response ?? new List<TariffWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginComputeTellerCashTariffs(customerAccountDTO, totalValue, frontOfficeTransactionType, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BankLinkageDTO

        public Task<PageCollectionInfo<BankLinkageDTO>> FindBankLinkagesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankLinkageDTO>>();

            IBankLinkageService service = GetService<IBankLinkageService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankLinkageDTO> response = ((IBankLinkageService)result.AsyncState).EndFindBankLinkagesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankLinkagesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BankLinkageDTO>> FindBankLinkagesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankLinkageDTO>>();

            IBankLinkageService service = GetService<IBankLinkageService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankLinkageDTO> response = ((IBankLinkageService)result.AsyncState).EndFindBankLinkagesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankLinkagesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankLinkageDTO> AddBankLinkageAsync(BankLinkageDTO bankLinkageDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankLinkageDTO>();

            IBankLinkageService service = GetService<IBankLinkageService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankLinkageDTO response = ((IBankLinkageService)result.AsyncState).EndAddBankLinkage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBankLinkage(bankLinkageDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBankLinkageAsync(BankLinkageDTO bankLinkageDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankLinkageService service = GetService<IBankLinkageService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankLinkageService)result.AsyncState).EndUpdateBankLinkage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBankLinkage(bankLinkageDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankLinkageDTO> FindBankLinkageAsync(Guid bankLinkageId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankLinkageDTO>();

            IBankLinkageService service = GetService<IBankLinkageService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankLinkageDTO response = ((IBankLinkageService)result.AsyncState).EndFindBankLinkage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankLinkage(bankLinkageId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BudgetDTO

        public Task<PageCollectionInfo<BudgetDTO>> FindBudgetsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BudgetDTO>>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BudgetDTO> response = ((IBudgetService)result.AsyncState).EndFindBudgetsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBudgetsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<BudgetDTO>> FindBudgetsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<BudgetDTO>>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BudgetDTO> response = ((IBudgetService)result.AsyncState).EndFindBudgets(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBudgets(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BudgetDTO>> FindBudgetsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BudgetDTO>>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BudgetDTO> response = ((IBudgetService)result.AsyncState).EndFindBudgetsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBudgetsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BudgetDTO> AddBudgetAsync(BudgetDTO budgetDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BudgetDTO>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BudgetDTO response = ((IBudgetService)result.AsyncState).EndAddBudget(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBudget(budgetDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBudgetAsync(BudgetDTO budgetDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBudgetService)result.AsyncState).EndUpdateBudget(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBudget(budgetDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BudgetDTO> FindBudgetAsync(Guid budgetId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BudgetDTO>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BudgetDTO response = ((IBudgetService)result.AsyncState).EndFindBudget(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBudget(budgetId, asyncCallback, service);

            return tcs.Task;
        }



        public Task<ObservableCollection<BudgetEntryDTO>> FindBudgetEntriesByBudgetIdAsync(Guid budgetId, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BudgetEntryDTO>>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BudgetEntryDTO> response = ((IBudgetService)result.AsyncState).EndFindBudgetEntriesByBudgetId(result);

                    tcs.TrySetResult(new ObservableCollection<BudgetEntryDTO>(response ?? new List<BudgetEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBudgetEntriesByBudgetId(budgetId, includeBalances, asyncCallback, service);

            return tcs.Task;
        }
        public Task<bool> UpdateBudgetEntriesByBudgetIdAsync(Guid budgetId, ObservableCollection<BudgetEntryDTO> budgetEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBudgetService)result.AsyncState).EndUpdateBudgetEntriesByBudgetId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBudgetEntriesByBudgetId(budgetId, budgetEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BudgetEntryDTO>> FindBudgetEntriesByBudgetIdInPageAsync(Guid budgetId, int pageIndex, int pageSize, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BudgetEntryDTO>>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BudgetEntryDTO> response = ((IBudgetService)result.AsyncState).EndFindBudgetEntriesByBudgetIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBudgetEntriesByBudgetIdInPage(budgetId, pageIndex, pageSize, includeBalances, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveBudgetEntriesAsync(ObservableCollection<BudgetEntryDTO> budgetEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBudgetService)result.AsyncState).EndRemoveBudgetEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveBudgetEntries(budgetEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<BudgetEntryDTO> AddBudgetEntryAsync(BudgetEntryDTO budgetEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BudgetEntryDTO>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BudgetEntryDTO response = ((IBudgetService)result.AsyncState).EndAddBudgetEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBudgetEntry(budgetEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<decimal> FetchBudgetBalanceByBranchIdAsync(Guid branchId, int type, Guid typeIdentifier, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<decimal>();

            IBudgetService service = GetService<IBudgetService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    decimal response = ((IBudgetService)result.AsyncState).EndFetchBudgetBalanceByBranchId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(0m); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFetchBudgetBalanceByBranchId(branchId, type, typeIdentifier, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region JournalVoucherDTO

        public Task<PageCollectionInfo<JournalVoucherDTO>> FindJournalVouchersByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalVoucherDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalVoucherDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVouchersByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVouchersByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        public Task<PageCollectionInfo<JournalVoucherDTO>> FindJournalVouchersByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalVoucherDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalVoucherDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVouchersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVouchersByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<JournalVoucherDTO>> FindJournalVouchersAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<JournalVoucherDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<JournalVoucherDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVouchers(result);

                    tcs.TrySetResult(new ObservableCollection<JournalVoucherDTO>(response ?? new List<JournalVoucherDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVouchers(asyncCallback, service);

            return tcs.Task;
        }


        public Task<PageCollectionInfo<JournalVoucherDTO>> FindJournalVouchersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalVoucherDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalVoucherDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVouchersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVouchersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalVoucherDTO>> FindJournalVouchersByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalVoucherDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalVoucherDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVouchersByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVouchersByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<JournalVoucherEntryDTO>> FindJournalVoucherEntriesByJournalVoucherIdAsync(Guid journalVoucherId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<JournalVoucherEntryDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<JournalVoucherEntryDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVoucherEntriesByJournalVoucherId(result);

                    tcs.TrySetResult(new ObservableCollection<JournalVoucherEntryDTO>(response ?? new List<JournalVoucherEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVoucherEntriesByJournalVoucherId(journalVoucherId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalVoucherEntryDTO>> FindJournalVoucherEntriesByJournalVoucherIdInPageAsync(Guid journalVoucherId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalVoucherEntryDTO>>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalVoucherEntryDTO> response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVoucherEntriesByJournalVoucherIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVoucherEntriesByJournalVoucherIdInPage(journalVoucherId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalVoucherDTO> AddJournalVoucherAsync(JournalVoucherDTO journalVoucherDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalVoucherDTO>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalVoucherDTO response = ((IJournalVoucherService)result.AsyncState).EndAddJournalVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalVoucher(journalVoucherDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalVoucherDTO> FindJournalVoucherAsync(Guid journalVoucherId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalVoucherDTO>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalVoucherDTO response = ((IJournalVoucherService)result.AsyncState).EndFindJournalVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalVoucher(journalVoucherId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalVoucherEntryDTO> AddJournalVoucherEntryAsync(JournalVoucherEntryDTO journalVoucherEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalVoucherEntryDTO>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalVoucherEntryDTO response = ((IJournalVoucherService)result.AsyncState).EndAddJournalVoucherEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalVoucherEntry(journalVoucherEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateJournalVoucherAsync(JournalVoucherDTO journalVoucherDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalVoucherService)result.AsyncState).EndUpdateJournalVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateJournalVoucher(journalVoucherDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveJournalVoucherEntriesAsync(ObservableCollection<JournalVoucherEntryDTO> journalVoucherEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalVoucherService)result.AsyncState).EndRemoveJournalVoucherEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveJournalVoucherEntries(journalVoucherEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditJournalVoucherAsync(JournalVoucherDTO journalVoucherDTO, int journalVoucherAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalVoucherService)result.AsyncState).EndAuditJournalVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditJournalVoucher(journalVoucherDTO, journalVoucherAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeJournalVoucherAsync(JournalVoucherDTO journalVoucherDTO, int journalVoucherAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalVoucherService)result.AsyncState).EndAuthorizeJournalVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeJournalVoucher(journalVoucherDTO, journalVoucherAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateJournalVoucherEntryCollectionAsync(Guid journalVoucherId, ObservableCollection<JournalVoucherEntryDTO> journalVoucherEntryCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalVoucherService)result.AsyncState).EndUpdateJournalVoucherEntryCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateJournalVoucherEntryCollection(journalVoucherId, journalVoucherEntryCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateJournalVoucherEntriesByJournalVoucherIdAsync(Guid journalVoucherId, ObservableCollection<JournalVoucherEntryDTO> journalVoucherEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalVoucherService service = GetService<IJournalVoucherService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalVoucherService)result.AsyncState).EndUpdateJournalVoucherEntriesByJournalVoucherId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateJournalVoucherEntriesByJournalVoucherId(journalVoucherId, journalVoucherEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region TreasuryDTO

        public Task<PageCollectionInfo<TreasuryDTO>> FindTreasuriesByFilterInPageAsync(string text, int pageIndex, int pageSize, bool includeBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<TreasuryDTO>>();

            ITreasuryService service = GetService<ITreasuryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<TreasuryDTO> response = ((ITreasuryService)result.AsyncState).EndFindTreasuriesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTreasuriesByFilterInPage(text, pageIndex, pageSize, includeBalances, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TreasuryDTO> AddTreasuryAsync(TreasuryDTO treasuryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TreasuryDTO>();

            ITreasuryService service = GetService<ITreasuryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TreasuryDTO response = ((ITreasuryService)result.AsyncState).EndAddTreasury(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddTreasury(treasuryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateTreasuryAsync(TreasuryDTO treasuryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ITreasuryService service = GetService<ITreasuryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ITreasuryService)result.AsyncState).EndUpdateTreasury(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateTreasury(treasuryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TreasuryDTO> FindTreasuryAsync(Guid treasuryId, bool includeBalance, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TreasuryDTO>();

            ITreasuryService service = GetService<ITreasuryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TreasuryDTO response = ((ITreasuryService)result.AsyncState).EndFindTreasury(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTreasury(treasuryId, includeBalance, asyncCallback, service);

            return tcs.Task;
        }

        public Task<TreasuryDTO> FindTreasuryByBranchIdAsync(Guid branchId, bool includeBalance, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<TreasuryDTO>();

            ITreasuryService service = GetService<ITreasuryService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    TreasuryDTO response = ((ITreasuryService)result.AsyncState).EndFindTreasuryByBranchId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTreasuryByBranchId(branchId, includeBalance, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region InsuranceCompanyDTO

        public Task<PageCollectionInfo<InsuranceCompanyDTO>> FindInsuranceCompaniesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InsuranceCompanyDTO>>();

            IInsuranceCompanyService service = GetService<IInsuranceCompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InsuranceCompanyDTO> response = ((IInsuranceCompanyService)result.AsyncState).EndFindInsuranceCompaniesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInsuranceCompaniesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InsuranceCompanyDTO>> FindInsuranceCompaniesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InsuranceCompanyDTO>>();

            IInsuranceCompanyService service = GetService<IInsuranceCompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InsuranceCompanyDTO> response = ((IInsuranceCompanyService)result.AsyncState).EndFindInsuranceCompaniesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInsuranceCompaniesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<InsuranceCompanyDTO>> FindInsuranceCompaniesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<InsuranceCompanyDTO>>();

            IInsuranceCompanyService service = GetService<IInsuranceCompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<InsuranceCompanyDTO> response = ((IInsuranceCompanyService)result.AsyncState).EndFindInsuranceCompanies(result);

                    tcs.TrySetResult(new ObservableCollection<InsuranceCompanyDTO>(response ?? new List<InsuranceCompanyDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInsuranceCompanies(asyncCallback, service);

            return tcs.Task;
        }

        public Task<InsuranceCompanyDTO> AddInsuranceCompanyAsync(InsuranceCompanyDTO insuranceCompanyDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InsuranceCompanyDTO>();

            IInsuranceCompanyService service = GetService<IInsuranceCompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InsuranceCompanyDTO response = ((IInsuranceCompanyService)result.AsyncState).EndAddInsuranceCompany(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddInsuranceCompany(insuranceCompanyDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateInsuranceCompanyAsync(InsuranceCompanyDTO insuranceCompanyDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInsuranceCompanyService service = GetService<IInsuranceCompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInsuranceCompanyService)result.AsyncState).EndUpdateInsuranceCompany(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateInsuranceCompany(insuranceCompanyDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InsuranceCompanyDTO> FindInsuranceCompanyAsync(Guid insuranceCompanyId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InsuranceCompanyDTO>();

            IInsuranceCompanyService service = GetService<IInsuranceCompanyService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InsuranceCompanyDTO response = ((IInsuranceCompanyService)result.AsyncState).EndFindInsuranceCompany(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInsuranceCompany(insuranceCompanyId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region UnPayReasonDTO

        public Task<PageCollectionInfo<UnPayReasonDTO>> FindUnPayReasonsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<UnPayReasonDTO>>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<UnPayReasonDTO> response = ((IUnPayReasonService)result.AsyncState).EndFindUnPayReasonsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnPayReasonsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<UnPayReasonDTO>> FindUnPayReasonsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<UnPayReasonDTO>>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<UnPayReasonDTO> response = ((IUnPayReasonService)result.AsyncState).EndFindUnPayReasonsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnPayReasonsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<UnPayReasonDTO> AddUnPayReasonAsync(UnPayReasonDTO unPayReasonDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<UnPayReasonDTO>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    UnPayReasonDTO response = ((IUnPayReasonService)result.AsyncState).EndAddUnPayReason(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddUnPayReason(unPayReasonDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateUnPayReasonAsync(UnPayReasonDTO unPayReasonDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUnPayReasonService)result.AsyncState).EndUpdateUnPayReason(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateUnPayReason(unPayReasonDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<UnPayReasonDTO> FindUnPayReasonAsync(Guid unPayReasonId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<UnPayReasonDTO>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    UnPayReasonDTO response = ((IUnPayReasonService)result.AsyncState).EndFindUnPayReason(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindUnPayReason(unPayReasonId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByUnPayReasonIdAsync(Guid unPayReasonId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((IUnPayReasonService)result.AsyncState).EndFindCommissionsByUnPayReasonId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByUnPayReasonId(unPayReasonId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByUnPayReasonIdAsync(Guid unPayReasonId, ObservableCollection<CommissionDTO> commissions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUnPayReasonService service = GetService<IUnPayReasonService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUnPayReasonService)result.AsyncState).EndUpdateCommissionsByUnPayReasonId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByUnPayReasonId(unPayReasonId, commissions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ChequeBookDTO

        public Task<ChequeBookDTO> AddChequeBookAsync(ChequeBookDTO chequeBookDTO, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ChequeBookDTO>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ChequeBookDTO response = ((IChequeBookService)result.AsyncState).EndAddChequeBook(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddChequeBook(chequeBookDTO, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateChequeBookAsync(ChequeBookDTO chequeBookDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChequeBookService)result.AsyncState).EndUpdateChequeBook(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateChequeBook(chequeBookDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ChequeBookDTO>> FindChequeBooksByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ChequeBookDTO>>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ChequeBookDTO> response = ((IChequeBookService)result.AsyncState).EndFindChequeBooksByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChequeBooksByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ChequeBookDTO>> FindChequeBooksByTypeAndFilterInPageAsync(int type, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ChequeBookDTO>>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ChequeBookDTO> response = ((IChequeBookService)result.AsyncState).EndFindChequeBooksByTypeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChequeBooksByTypeAndFilterInPage(type, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ChequeBookDTO> FindChequeBookAsync(Guid chequeBookId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ChequeBookDTO>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ChequeBookDTO response = ((IChequeBookService)result.AsyncState).EndFindChequeBook(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChequeBook(chequeBookId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<PaymentVoucherDTO>> FindPaymentVouchersByChequeBookIdAsync(Guid chequeBookId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<PaymentVoucherDTO>>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<PaymentVoucherDTO> response = ((IChequeBookService)result.AsyncState).EndFindPaymentVouchersByChequeBookId(result);

                    tcs.TrySetResult(new ObservableCollection<PaymentVoucherDTO>(response ?? new List<PaymentVoucherDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindPaymentVouchersByChequeBookId(chequeBookId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> FlagPaymentVoucherAsync(PaymentVoucherDTO paymentVoucherDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChequeBookService service = GetService<IChequeBookService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChequeBookService)result.AsyncState).EndFlagPaymentVoucher(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFlagPaymentVoucher(paymentVoucherDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ReportTemplateDTO

        public Task<ReportTemplateDTO> PopulateReportTemplateAsync(ReportTemplateDTO reportTemplateDTO, ObservableCollection<ReportTemplateDTO> templateBalances, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ReportTemplateDTO>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ReportTemplateDTO response = ((IReportTemplateService)result.AsyncState).EndPopulateReportTemplate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPopulateReportTemplate(reportTemplateDTO, templateBalances.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ReportTemplateDTO>> FindReportTemplateBalancesAsync(Guid rootTemplateId, DateTime cutOffDate, int transactionDateFilter, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ReportTemplateDTO>>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ReportTemplateDTO> response = ((IReportTemplateService)result.AsyncState).EndFindReportTemplateBalances(result);

                    tcs.TrySetResult(new ObservableCollection<ReportTemplateDTO>(response ?? new List<ReportTemplateDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReportTemplateBalances(rootTemplateId, cutOffDate, transactionDateFilter, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ReportTemplateDTO>> FindReportTemplatesAsync(bool updateDepth, bool traverseTree, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ReportTemplateDTO>>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ReportTemplateDTO> response = ((IReportTemplateService)result.AsyncState).EndFindReportTemplates(result);

                    tcs.TrySetResult(new ObservableCollection<ReportTemplateDTO>(response ?? new List<ReportTemplateDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReportTemplates(updateDepth, traverseTree, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ReportTemplateDTO> FindReportTemplateAsync(Guid reportTemplateId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ReportTemplateDTO>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ReportTemplateDTO response = ((IReportTemplateService)result.AsyncState).EndFindReportTemplate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReportTemplate(reportTemplateId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ReportTemplateDTO> AddReportTemplateAsync(ReportTemplateDTO reportTemplateDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ReportTemplateDTO>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ReportTemplateDTO response = ((IReportTemplateService)result.AsyncState).EndAddReportTemplate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddReportTemplate(reportTemplateDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateReportTemplateAsync(ReportTemplateDTO reportTemplateDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IReportTemplateService)result.AsyncState).EndUpdateReportTemplate(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateReportTemplate(reportTemplateDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ReportTemplateEntryDTO>> FindReportTemplateEntriesByReportTemplateIdAsync(Guid reportTemplateId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ReportTemplateEntryDTO>>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ReportTemplateEntryDTO> response = ((IReportTemplateService)result.AsyncState).EndFindReportTemplateEntriesByReportTemplateId(result);

                    tcs.TrySetResult(new ObservableCollection<ReportTemplateEntryDTO>(response ?? new List<ReportTemplateEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindReportTemplateEntriesByReportTemplateId(reportTemplateId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateReportTemplateEntriesAsync(Guid reportTemplateId, ObservableCollection<ReportTemplateEntryDTO> reportTemplateEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IReportTemplateService service = GetService<IReportTemplateService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IReportTemplateService)result.AsyncState).EndUpdateReportTemplateEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateReportTemplateEntries(reportTemplateId, reportTemplateEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region StandingOrderDTO

        public Task<ObservableCollection<StandingOrderDTO>> FindStandingOrdersByBenefactorCustomerIdAsync(Guid benefactorCustomerId, int benefactorCustomerAccountTypeProductCode, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StandingOrderDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StandingOrderDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrdersByBenefactorCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<StandingOrderDTO>(response ?? new List<StandingOrderDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrdersByBenefactorCustomerId(benefactorCustomerId, benefactorCustomerAccountTypeProductCode, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<StandingOrderDTO>> FindStandingOrdersByBenefactorCustomerAccountIdAsync(Guid benefactorCustomerAccountId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StandingOrderDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StandingOrderDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrdersByBenefactorCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<StandingOrderDTO>(response ?? new List<StandingOrderDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrdersByBenefactorCustomerAccountId(benefactorCustomerAccountId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<StandingOrderDTO>> FindStandingOrdersByBeneficiaryCustomerAccountIdAsync(Guid beneficiaryCustomerAccountId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<StandingOrderDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<StandingOrderDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrdersByBeneficiaryCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<StandingOrderDTO>(response ?? new List<StandingOrderDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrdersByBeneficiaryCustomerAccountId(beneficiaryCustomerAccountId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<StandingOrderDTO>> FindStandingOrdersInPageAsync(int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<StandingOrderDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<StandingOrderDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrdersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrdersInPage(pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<StandingOrderDTO>> FindStandingOrdersByFilterInPageAsync(string text, int customerAccountFilter, int customerFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<StandingOrderDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<StandingOrderDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrdersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrdersByFilterInPage(text, customerAccountFilter, customerFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<StandingOrderDTO>> FindStandingOrdersByTriggerAndFilterInPageAsync(int trigger, string text, int customerAccountFilter, int customerFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<StandingOrderDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<StandingOrderDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrdersByTriggerAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrdersByTriggerAndFilterInPage(trigger, text, customerAccountFilter, customerFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<StandingOrderDTO> AddStandingOrderAsync(StandingOrderDTO standingOrderDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<StandingOrderDTO>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    StandingOrderDTO response = ((IStandingOrderService)result.AsyncState).EndAddStandingOrder(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddStandingOrder(standingOrderDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateStandingOrderAsync(StandingOrderDTO standingOrderDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IStandingOrderService)result.AsyncState).EndUpdateStandingOrder(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateStandingOrder(standingOrderDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<StandingOrderHistoryDTO>> FindStandingOrderHistoryByStandingOrderIdInPageAsync(Guid standingOrderId, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<StandingOrderHistoryDTO>>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<StandingOrderHistoryDTO> response = ((IStandingOrderService)result.AsyncState).EndFindStandingOrderHistoryByStandingOrderIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindStandingOrderHistoryByStandingOrderIdInPage(standingOrderId, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> FixSkippedStandingOrdersAsync(DateTime targetDate, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IStandingOrderService service = GetService<IStandingOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IStandingOrderService)result.AsyncState).EndFixSkippedStandingOrders(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFixSkippedStandingOrders(targetDate, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        #endregion

        #region ChequeTypeDTO

        public Task<PageCollectionInfo<ChequeTypeDTO>> FindChequeTypesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ChequeTypeDTO>>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ChequeTypeDTO> response = ((IChequeTypeService)result.AsyncState).EndFindChequeTypesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChequeTypesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ChequeTypeDTO>> FindChequeTypesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ChequeTypeDTO>>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ChequeTypeDTO> response = ((IChequeTypeService)result.AsyncState).EndFindChequeTypesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChequeTypesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ChequeTypeDTO> AddChequeTypeAsync(ChequeTypeDTO chequeTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ChequeTypeDTO>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ChequeTypeDTO response = ((IChequeTypeService)result.AsyncState).EndAddChequeType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddChequeType(chequeTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateChequeTypeAsync(ChequeTypeDTO chequeTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChequeTypeService)result.AsyncState).EndUpdateChequeType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateChequeType(chequeTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ChequeTypeDTO> FindChequeTypeAsync(Guid chequeTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ChequeTypeDTO>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ChequeTypeDTO response = ((IChequeTypeService)result.AsyncState).EndFindChequeType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindChequeType(chequeTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByChequeTypeIdAsync(Guid chequeTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((IChequeTypeService)result.AsyncState).EndFindCommissionsByChequeTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByChequeTypeId(chequeTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByChequeTypeIdAsync(Guid chequeTypeId, ObservableCollection<CommissionDTO> commissions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChequeTypeService)result.AsyncState).EndUpdateCommissionsByChequeTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByChequeTypeId(chequeTypeId, commissions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ProductCollectionInfo> FindAttachedProductsByChequeTypeIdAsync(Guid chequeTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ProductCollectionInfo>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ProductCollectionInfo response = ((IChequeTypeService)result.AsyncState).EndFindAttachedProductsByChequeTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAttachedProductsByChequeTypeId(chequeTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAttachedProductsByChequeTypeIdAsync(Guid chequeTypeId, ProductCollectionInfo attachedProductsTuple, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IChequeTypeService service = GetService<IChequeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IChequeTypeService)result.AsyncState).EndUpdateAttachedProductsByChequeTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAttachedProductsByChequeTypeId(chequeTypeId, attachedProductsTuple, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region OverDeductionBatchDTO

        public Task<PageCollectionInfo<OverDeductionBatchDTO>> FindOverDeductionBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<OverDeductionBatchDTO>>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<OverDeductionBatchDTO> response = ((IOverDeductionBatchService)result.AsyncState).EndFindOverDeductionBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindOverDeductionBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<OverDeductionBatchEntryDTO>> FindOverDeductionBatchEntriesByOverDeductionBatchIdAsync(Guid overDeductionBatchId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<OverDeductionBatchEntryDTO>>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<OverDeductionBatchEntryDTO> response = ((IOverDeductionBatchService)result.AsyncState).EndFindOverDeductionBatchEntriesByOverDeductionBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<OverDeductionBatchEntryDTO>(response ?? new List<OverDeductionBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindOverDeductionBatchEntriesByOverDeductionBatchId(overDeductionBatchId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<OverDeductionBatchEntryDTO>> FindOverDeductionBatchEntriesByOverDeductionBatchIdInPageAsync(Guid overDeductionBatchId, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<OverDeductionBatchEntryDTO>>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<OverDeductionBatchEntryDTO> response = ((IOverDeductionBatchService)result.AsyncState).EndFindOverDeductionBatchEntriesByOverDeductionBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindOverDeductionBatchEntriesByOverDeductionBatchIdInPage(overDeductionBatchId, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<OverDeductionBatchDTO> AddOverDeductionBatchAsync(OverDeductionBatchDTO overDeductionBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<OverDeductionBatchDTO>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    OverDeductionBatchDTO response = ((IOverDeductionBatchService)result.AsyncState).EndAddOverDeductionBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddOverDeductionBatch(overDeductionBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<OverDeductionBatchDTO> FindOverDeductionBatchAsync(Guid overDeductionBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<OverDeductionBatchDTO>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    OverDeductionBatchDTO response = ((IOverDeductionBatchService)result.AsyncState).EndFindOverDeductionBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindOverDeductionBatch(overDeductionBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateOverDeductionBatchAsync(OverDeductionBatchDTO overDeductionBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IOverDeductionBatchService)result.AsyncState).EndUpdateOverDeductionBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateOverDeductionBatch(overDeductionBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditOverDeductionBatchAsync(OverDeductionBatchDTO overDeductionBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IOverDeductionBatchService)result.AsyncState).EndAuditOverDeductionBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditOverDeductionBatch(overDeductionBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeOverDeductionBatchAsync(OverDeductionBatchDTO overDeductionBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IOverDeductionBatchService)result.AsyncState).EndAuthorizeOverDeductionBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeOverDeductionBatch(overDeductionBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<BatchImportEntryWrapper>> ParseOverDeductionBatchImportAsync(Guid overDeductionBatchId, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BatchImportEntryWrapper>>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BatchImportEntryWrapper> response = ((IOverDeductionBatchService)result.AsyncState).EndParseOverDeductionBatchImport(result);

                    tcs.TrySetResult(new ObservableCollection<BatchImportEntryWrapper>(response ?? new List<BatchImportEntryWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseOverDeductionBatchImport(overDeductionBatchId, fileName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<OverDeductionBatchEntryDTO> AddOverDeductionBatchEntryAsync(OverDeductionBatchEntryDTO overDeductionBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<OverDeductionBatchEntryDTO>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    OverDeductionBatchEntryDTO response = ((IOverDeductionBatchService)result.AsyncState).EndAddOverDeductionBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddOverDeductionBatchEntry(overDeductionBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveOverDeductionBatchEntriesAsync(ObservableCollection<OverDeductionBatchEntryDTO> overDeductionBatchEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IOverDeductionBatchService service = GetService<IOverDeductionBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IOverDeductionBatchService)result.AsyncState).EndRemoveOverDeductionBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveOverDeductionBatchEntries(overDeductionBatchEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CreditTypeDTO

        public Task<PageCollectionInfo<CreditTypeDTO>> FindCreditTypesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditTypeDTO>>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditTypeDTO> response = ((ICreditTypeService)result.AsyncState).EndFindCreditTypesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditTypesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        public Task<CreditTypeDTO> FindCreditTypeAsync(Guid creditTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CreditTypeDTO>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CreditTypeDTO response = ((ICreditTypeService)result.AsyncState).EndFindCreditType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditType(creditTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CreditTypeDTO>> FindCreditTypesAsync(Guid creditTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditTypeDTO>>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditTypeDTO> response = ((ICreditTypeService)result.AsyncState).EndFindCreditTypes(result);

                    tcs.TrySetResult(new ObservableCollection<CreditTypeDTO>(response ?? new List<CreditTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditTypes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditTypeDTO>> FindCreditTypesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditTypeDTO>>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditTypeDTO> response = ((ICreditTypeService)result.AsyncState).EndFindCreditTypesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditTypesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CreditTypeDTO> AddCreditTypeAsync(CreditTypeDTO creditTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CreditTypeDTO>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CreditTypeDTO response = ((ICreditTypeService)result.AsyncState).EndAddCreditType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCreditType(creditTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCreditTypeAsync(CreditTypeDTO creditTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditTypeService)result.AsyncState).EndUpdateCreditType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCreditType(creditTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByCreditTypeIdAsync(Guid creditTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((ICreditTypeService)result.AsyncState).EndFindCommissionsByCreditTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByCreditTypeId(creditTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByCreditTypeIdAsync(Guid creditTypeId, ObservableCollection<CommissionDTO> commissions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditTypeService)result.AsyncState).EndUpdateCommissionsByCreditTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByCreditTypeId(creditTypeId, commissions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DirectDebitDTO>> FindDirectDebitsByCreditTypeIdAsync(Guid creditTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DirectDebitDTO>>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DirectDebitDTO> response = ((ICreditTypeService)result.AsyncState).EndFindDirectDebitsByCreditTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<DirectDebitDTO>(response ?? new List<DirectDebitDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirectDebitsByCreditTypeId(creditTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDirectDebitsByCreditTypeIdAsync(Guid creditTypeId, ObservableCollection<DirectDebitDTO> directDebits, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditTypeService)result.AsyncState).EndUpdateDirectDebitsByCreditTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDirectDebitsByCreditTypeId(creditTypeId, directDebits.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ProductCollectionInfo> FindAttachedProductsByCreditTypeIdAsync(Guid creditTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ProductCollectionInfo>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ProductCollectionInfo response = ((ICreditTypeService)result.AsyncState).EndFindAttachedProductsByCreditTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAttachedProductsByCreditTypeId(creditTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAttachedProductsByCreditTypeIdAsync(Guid creditTypeId, ProductCollectionInfo attachedProductsTuple, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditTypeService)result.AsyncState).EndUpdateAttachedProductsByCreditTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAttachedProductsByCreditTypeId(creditTypeId, attachedProductsTuple, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CreditTypeDTO>> FindCreditTypesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditTypeDTO>>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditTypeDTO> response = ((ICreditTypeService)result.AsyncState).EndFindCreditTypes(result);

                    tcs.TrySetResult(new ObservableCollection<CreditTypeDTO>(response ?? new List<CreditTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditTypes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ProductCollectionInfo> FindConcessionExemptProductsByCreditTypeIdAsync(Guid creditTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ProductCollectionInfo>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ProductCollectionInfo response = ((ICreditTypeService)result.AsyncState).EndFindConcessionExemptProductsByCreditTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindConcessionExemptProductsByCreditTypeId(creditTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateConcessionExemptProductsByCreditTypeIdAsync(Guid creditTypeId, ProductCollectionInfo concessionExemptProductsTuple, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditTypeService service = GetService<ICreditTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditTypeService)result.AsyncState).EndUpdateConcessionExemptProductsByCreditTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateConcessionExemptProductsByCreditTypeId(creditTypeId, concessionExemptProductsTuple, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DebitTypeDTO

        public Task<PageCollectionInfo<DebitTypeDTO>> FindDebitTypesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DebitTypeDTO>>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DebitTypeDTO> response = ((IDebitTypeService)result.AsyncState).EndFindDebitTypesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitTypesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DebitTypeDTO> FindDebitTypeAsync(Guid debitTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DebitTypeDTO>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DebitTypeDTO response = ((IDebitTypeService)result.AsyncState).EndFindDebitType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitType(debitTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DebitTypeDTO>> FindDebitTypesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DebitTypeDTO>>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitTypeDTO> response = ((IDebitTypeService)result.AsyncState).EndFindDebitTypes(result);

                    tcs.TrySetResult(new ObservableCollection<DebitTypeDTO>(response ?? new List<DebitTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitTypes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DebitTypeDTO>> FindMandatoryDebitTypesAsync(bool isMandatory, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DebitTypeDTO>>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitTypeDTO> response = ((IDebitTypeService)result.AsyncState).EndFindMandatoryDebitTypes(result);

                    tcs.TrySetResult(new ObservableCollection<DebitTypeDTO>(response ?? new List<DebitTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMandatoryDebitTypes(isMandatory, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DebitTypeDTO>> FindDebitTypesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DebitTypeDTO>>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DebitTypeDTO> response = ((IDebitTypeService)result.AsyncState).EndFindDebitTypesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitTypesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }
        public Task<List<DebitTypeDTO>> FindDebitTypeAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<DebitTypeDTO>>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitTypeDTO> response = ((IDebitTypeService)result.AsyncState).EndFindDebitTypes(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitTypes(asyncCallback, service);

            return tcs.Task;
        }
        public Task<DebitTypeDTO> AddDebitTypeAsync(DebitTypeDTO debitTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DebitTypeDTO>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DebitTypeDTO response = ((IDebitTypeService)result.AsyncState).EndAddDebitType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDebitType(debitTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDebitTypeAsync(DebitTypeDTO debitTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitTypeService)result.AsyncState).EndUpdateDebitType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDebitType(debitTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByDebitTypeIdAsync(Guid debitTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((IDebitTypeService)result.AsyncState).EndFindCommissionsByDebitTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByDebitTypeId(debitTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByDebitTypeIdAsync(Guid debitTypeId, ObservableCollection<CommissionDTO> commissions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitTypeService service = GetService<IDebitTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitTypeService)result.AsyncState).EndUpdateCommissionsByDebitTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByDebitTypeId(debitTypeId, commissions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DirectDebitDTO

        public Task<PageCollectionInfo<DirectDebitDTO>> FindDirectDebitsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DirectDebitDTO>>();

            IDirectDebitService service = GetService<IDirectDebitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DirectDebitDTO> response = ((IDirectDebitService)result.AsyncState).EndFindDirectDebitsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirectDebitsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DirectDebitDTO>> FindDirectDebitsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DirectDebitDTO>>();

            IDirectDebitService service = GetService<IDirectDebitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DirectDebitDTO> response = ((IDirectDebitService)result.AsyncState).EndFindDirectDebits(result);

                    tcs.TrySetResult(new ObservableCollection<DirectDebitDTO>(response ?? new List<DirectDebitDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirectDebits(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DirectDebitDTO>> FindDirectDebitsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DirectDebitDTO>>();

            IDirectDebitService service = GetService<IDirectDebitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DirectDebitDTO> response = ((IDirectDebitService)result.AsyncState).EndFindDirectDebitsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDirectDebitsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DirectDebitDTO> AddDirectDebitAsync(DirectDebitDTO directDebitDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DirectDebitDTO>();

            IDirectDebitService service = GetService<IDirectDebitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DirectDebitDTO response = ((IDirectDebitService)result.AsyncState).EndAddDirectDebit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDirectDebit(directDebitDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDirectDebitAsync(DirectDebitDTO directDebitDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDirectDebitService service = GetService<IDirectDebitService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDirectDebitService)result.AsyncState).EndUpdateDirectDebit(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDirectDebit(directDebitDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CreditBatchDTO

        public Task<ObservableCollection<BatchImportEntryWrapper>> ParseCreditBatchImportAsync(Guid creditBatchId, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BatchImportEntryWrapper>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BatchImportEntryWrapper> response = ((ICreditBatchService)result.AsyncState).EndParseCreditBatchImport(result);

                    tcs.TrySetResult(new ObservableCollection<BatchImportEntryWrapper>(response ?? new List<BatchImportEntryWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseCreditBatchImport(creditBatchId, fileName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CreditBatchDTO>> FindCreditBatchesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditBatchDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditBatchDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatches(result);

                    tcs.TrySetResult(new ObservableCollection<CreditBatchDTO>(response ?? new List<CreditBatchDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatches(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchDTO>> FindCreditBatchesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }


        public Task<ObservableCollection<CreditBatchEntryDTO>> FindLoanAppraisalCreditBatchEntriesByCustomerIdAsync(Guid customerId, Guid loanProductId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditBatchEntryDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditBatchEntryDTO> response = ((ICreditBatchService)result.AsyncState).EndFindLoanAppraisalCreditBatchEntriesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<CreditBatchEntryDTO>(response ?? new List<CreditBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanAppraisalCreditBatchEntriesByCustomerId(customerId, loanProductId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CreditBatchEntryDTO>> FindCreditBatchEntriesByCustomerIdAsync(int creditBatchType, Guid customerId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditBatchEntryDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditBatchEntryDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchEntriesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<CreditBatchEntryDTO>(response ?? new List<CreditBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchEntriesByCustomerId(creditBatchType, customerId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchDTO>> FindCreditBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CreditBatchEntryDTO>> FindCreditBatchEntriesByCreditBatchIdAsync(Guid creditBatchId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CreditBatchEntryDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CreditBatchEntryDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchEntriesByCreditBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<CreditBatchEntryDTO>(response ?? new List<CreditBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchEntriesByCreditBatchId(creditBatchId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchEntryDTO>> FindCreditBatchEntriesByCreditBatchIdInPageAsync(Guid creditBatchId, string text, int creditBatchEntryFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchEntryDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchEntryDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchEntriesByCreditBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchEntriesByCreditBatchIdInPage(creditBatchId, text, creditBatchEntryFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchDiscrepancyDTO>> FindCreditBatchDiscrepanciesByCreditBatchIdInPageAsync(Guid creditBatchId, string text, int creditBatchDiscrepancyFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchDiscrepancyDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchDiscrepancyDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchDiscrepanciesByCreditBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchDiscrepanciesByCreditBatchIdInPage(creditBatchId, text, creditBatchDiscrepancyFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchDiscrepancyDTO>> FindCreditBatchDiscrepanciesByCreditBatchTypeInPageAsync(int creditBatchType, int status, int productCode, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchDiscrepancyDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchDiscrepancyDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchDiscrepanciesByCreditBatchTypeInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchDiscrepanciesByCreditBatchTypeInPage(creditBatchType, status, productCode, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchDiscrepancyDTO>> FindCreditBatchDiscrepanciesInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int creditBatchDiscrepancyFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchDiscrepancyDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchDiscrepancyDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchDiscrepanciesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchDiscrepanciesInPage(status, startDate, endDate, text, creditBatchDiscrepancyFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchEntryDTO>> FindCreditBatchEntriesByCreditBatchTypeInPageAsync(int creditBatchType, DateTime startDate, DateTime endDate, string text, int creditBatchEntryFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchEntryDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchEntryDTO> response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatchEntriesByCreditBatchTypeInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatchEntriesByCreditBatchTypeInPage(creditBatchType, startDate, endDate, text, creditBatchEntryFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CreditBatchDTO> AddCreditBatchAsync(CreditBatchDTO creditBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CreditBatchDTO>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CreditBatchDTO response = ((ICreditBatchService)result.AsyncState).EndAddCreditBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCreditBatch(creditBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCreditBatchAsync(CreditBatchDTO creditBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndUpdateCreditBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCreditBatch(creditBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CreditBatchDTO> FindCreditBatchAsync(Guid creditBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CreditBatchDTO>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CreditBatchDTO response = ((ICreditBatchService)result.AsyncState).EndFindCreditBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCreditBatch(creditBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditCreditBatchAsync(CreditBatchDTO creditBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndAuditCreditBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditCreditBatch(creditBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeCreditBatchAsync(CreditBatchDTO creditBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndAuthorizeCreditBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeCreditBatch(creditBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MatchCreditBatchDiscrepancyByGeneralLedgerAccountAsync(CreditBatchDiscrepancyDTO creditBatchDiscrepancyDTO, Guid chartOfAccountId, int moduleNavigationItemCode, int discrepancyAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndMatchCreditBatchDiscrepancyByGeneralLedgerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchCreditBatchDiscrepancyByGeneralLedgerAccount(creditBatchDiscrepancyDTO, chartOfAccountId, moduleNavigationItemCode, discrepancyAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MatchCreditBatchDiscrepancyByCustomerAccountAsync(CreditBatchDiscrepancyDTO creditBatchDiscrepancyDTO, CustomerAccountDTO customerAccountDTO, int discrepancyAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndMatchCreditBatchDiscrepancyByCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchCreditBatchDiscrepancyByCustomerAccount(creditBatchDiscrepancyDTO, customerAccountDTO, discrepancyAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> MatchCreditBatchDiscrepanciesByCustomerAccountAsync(ObservableCollection<CreditBatchDiscrepancyDTO> creditBatchDiscrepancyDTOs, CustomerAccountDTO customerAccountDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndMatchCreditBatchDiscrepanciesByCustomerAccount(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchCreditBatchDiscrepanciesByCustomerAccount(creditBatchDiscrepancyDTOs.ExtendedToList(), customerAccountDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CreditBatchEntryDTO> AddCreditBatchEntryAsync(CreditBatchEntryDTO creditBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CreditBatchEntryDTO>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CreditBatchEntryDTO response = ((ICreditBatchService)result.AsyncState).EndAddCreditBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCreditBatchEntry(creditBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveCreditBatchEntriesAsync(ObservableCollection<CreditBatchEntryDTO> creditBatchEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndRemoveCreditBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveCreditBatchEntries(creditBatchEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<CreditBatchEntryDTO> FindLastCreditBatchEntryByCustomerAccountIdAsync(Guid customerAccountId, int creditBatchType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CreditBatchEntryDTO>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CreditBatchEntryDTO response = ((ICreditBatchService)result.AsyncState).EndFindLastCreditBatchEntryByCustomerAccountId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLastCreditBatchEntryByCustomerAccountId(customerAccountId, creditBatchType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostCreditBatchEntryAsync(Guid creditBatchEntryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICreditBatchService)result.AsyncState).EndPostCreditBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostCreditBatchEntry(creditBatchEntryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CreditBatchEntryDTO>> FindQueableCreditBatchEntriesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CreditBatchEntryDTO>>();

            ICreditBatchService service = GetService<ICreditBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CreditBatchEntryDTO> response = ((ICreditBatchService)result.AsyncState).EndFindQueableCreditBatchEntriesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableCreditBatchEntriesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DebitBatchDTO

        public Task<ObservableCollection<BatchImportEntryWrapper>> ParseDebitBatchImportAsync(Guid debitBatchId, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BatchImportEntryWrapper>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BatchImportEntryWrapper> response = ((IDebitBatchService)result.AsyncState).EndParseDebitBatchImport(result);

                    tcs.TrySetResult(new ObservableCollection<BatchImportEntryWrapper>(response ?? new List<BatchImportEntryWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseDebitBatchImport(debitBatchId, fileName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DebitBatchDTO>> FindDebitBatchesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DebitBatchDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitBatchDTO> response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatches(result);

                    tcs.TrySetResult(new ObservableCollection<DebitBatchDTO>(response ?? new List<DebitBatchDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatches(asyncCallback, service);

            return tcs.Task;
        }



        public Task<PageCollectionInfo<DebitBatchDTO>> FindDebitBatchesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DebitBatchDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DebitBatchDTO> response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatchesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatchesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }




        public Task<ObservableCollection<DebitBatchEntryDTO>> FindDebitBatchEntriesByCustomerIdAsync(Guid customerId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DebitBatchEntryDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitBatchEntryDTO> response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatchEntriesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<DebitBatchEntryDTO>(response ?? new List<DebitBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatchEntriesByCustomerId(customerId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DebitBatchDTO>> FindDebitBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DebitBatchDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DebitBatchDTO> response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DebitBatchEntryDTO>> FindDebitBatchEntriesByDebitBatchIdAsync(Guid debitBatchId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DebitBatchEntryDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DebitBatchEntryDTO> response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatchEntriesByDebitBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<DebitBatchEntryDTO>(response ?? new List<DebitBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatchEntriesByDebitBatchId(debitBatchId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DebitBatchEntryDTO>> FindDebitBatchEntriesByDebitBatchIdInPageAsync(Guid debitBatchId, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DebitBatchEntryDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DebitBatchEntryDTO> response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatchEntriesByDebitBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatchEntriesByDebitBatchIdInPage(debitBatchId, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DebitBatchDTO> AddDebitBatchAsync(DebitBatchDTO debitBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DebitBatchDTO>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DebitBatchDTO response = ((IDebitBatchService)result.AsyncState).EndAddDebitBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDebitBatch(debitBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DebitBatchDTO> FindDebitBatchAsync(Guid debitBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DebitBatchDTO>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DebitBatchDTO response = ((IDebitBatchService)result.AsyncState).EndFindDebitBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDebitBatch(debitBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDebitBatchAsync(DebitBatchDTO debitBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitBatchService)result.AsyncState).EndUpdateDebitBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDebitBatch(debitBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditDebitBatchAsync(DebitBatchDTO debitBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitBatchService)result.AsyncState).EndAuditDebitBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditDebitBatch(debitBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeDebitBatchAsync(DebitBatchDTO debitBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitBatchService)result.AsyncState).EndAuthorizeDebitBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeDebitBatch(debitBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostDebitBatchEntryAsync(Guid debitBatchEntryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitBatchService)result.AsyncState).EndPostDebitBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostDebitBatchEntry(debitBatchEntryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DebitBatchEntryDTO> AddDebitBatchEntryAsync(DebitBatchEntryDTO debitBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DebitBatchEntryDTO>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DebitBatchEntryDTO response = ((IDebitBatchService)result.AsyncState).EndAddDebitBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDebitBatchEntry(debitBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveDebitBatchEntriesAsync(ObservableCollection<DebitBatchEntryDTO> debitBatchEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDebitBatchService)result.AsyncState).EndRemoveDebitBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveDebitBatchEntries(debitBatchEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DebitBatchEntryDTO>> FindQueableDebitBatchEntriesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DebitBatchEntryDTO>>();

            IDebitBatchService service = GetService<IDebitBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DebitBatchEntryDTO> response = ((IDebitBatchService)result.AsyncState).EndFindQueableDebitBatchEntriesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableDebitBatchEntriesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region WireTransferBatchDTO

        public Task<PageCollectionInfo<WireTransferBatchDTO>> FindWireTransferBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WireTransferBatchDTO>>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WireTransferBatchDTO> response = ((IWireTransferBatchService)result.AsyncState).EndFindWireTransferBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<WireTransferBatchEntryDTO>> FindWireTransferBatchEntriesByWireTransferBatchIdAsync(Guid wireTransferBatchId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<WireTransferBatchEntryDTO>>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<WireTransferBatchEntryDTO> response = ((IWireTransferBatchService)result.AsyncState).EndFindWireTransferBatchEntriesByWireTransferBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<WireTransferBatchEntryDTO>(response ?? new List<WireTransferBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferBatchEntriesByWireTransferBatchId(wireTransferBatchId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<WireTransferBatchEntryDTO>> FindWireTransferBatchEntriesByWireTransferBatchIdInPageAsync(Guid wireTransferBatchId, string text, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WireTransferBatchEntryDTO>>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WireTransferBatchEntryDTO> response = ((IWireTransferBatchService)result.AsyncState).EndFindWireTransferBatchEntriesByWireTransferBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferBatchEntriesByWireTransferBatchIdInPage(wireTransferBatchId, text, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WireTransferBatchDTO> AddWireTransferBatchAsync(WireTransferBatchDTO wireTransferBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WireTransferBatchDTO>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WireTransferBatchDTO response = ((IWireTransferBatchService)result.AsyncState).EndAddWireTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddWireTransferBatch(wireTransferBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WireTransferBatchDTO> FindWireTransferBatchAsync(Guid wireTransferBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WireTransferBatchDTO>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WireTransferBatchDTO response = ((IWireTransferBatchService)result.AsyncState).EndFindWireTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferBatch(wireTransferBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateWireTransferBatchAsync(WireTransferBatchDTO wireTransferBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferBatchService)result.AsyncState).EndUpdateWireTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateWireTransferBatch(wireTransferBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditWireTransferBatchAsync(WireTransferBatchDTO wireTransferBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferBatchService)result.AsyncState).EndAuditWireTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditWireTransferBatch(wireTransferBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeWireTransferBatchAsync(WireTransferBatchDTO wireTransferBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferBatchService)result.AsyncState).EndAuthorizeWireTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeWireTransferBatch(wireTransferBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WireTransferBatchEntryDTO> AddWireTransferBatchEntryAsync(WireTransferBatchEntryDTO wireTransferBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WireTransferBatchEntryDTO>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WireTransferBatchEntryDTO response = ((IWireTransferBatchService)result.AsyncState).EndAddWireTransferBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddWireTransferBatchEntry(wireTransferBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveWireTransferBatchEntriesAsync(ObservableCollection<WireTransferBatchEntryDTO> wireTransferBatchEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferBatchService)result.AsyncState).EndRemoveWireTransferBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveWireTransferBatchEntries(wireTransferBatchEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<BatchImportEntryWrapper>> ParseWireTransferBatchImportAsync(Guid wireTransferBatchId, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BatchImportEntryWrapper>>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BatchImportEntryWrapper> response = ((IWireTransferBatchService)result.AsyncState).EndParseWireTransferBatchImport(result);

                    tcs.TrySetResult(new ObservableCollection<BatchImportEntryWrapper>(response ?? new List<BatchImportEntryWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseWireTransferBatchImport(wireTransferBatchId, fileName, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<WireTransferBatchEntryDTO>> FindQueableWireTransferBatchEntriesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WireTransferBatchEntryDTO>>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WireTransferBatchEntryDTO> response = ((IWireTransferBatchService)result.AsyncState).EndFindQueableWireTransferBatchEntriesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableWireTransferBatchEntriesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostWireTransferBatchEntryAsync(Guid wireTransferBatchEntryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferBatchService service = GetService<IWireTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferBatchService)result.AsyncState).EndPostWireTransferBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostWireTransferBatchEntry(wireTransferBatchEntryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanProductAuxiliaryConditionDTO

        public Task<ObservableCollection<LoanProductAuxiliaryConditionDTO>> FindLoanProductAuxiliaryConditionsAsync(Guid baseLoanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductAuxiliaryConditionDTO>>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductAuxiliaryConditionDTO> response = ((ILoanProductService)result.AsyncState).EndFindLoanProductAuxiliaryConditions(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductAuxiliaryConditionDTO>(response ?? new List<LoanProductAuxiliaryConditionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductAuxiliaryConditions(baseLoanProductId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanProductAuxiliaryConditionsByBaseLoanProductIdAsync(Guid baseLoanProductId, ObservableCollection<LoanProductAuxiliaryConditionDTO> loanProductAuxiliaryConditions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductService service = GetService<ILoanProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductService)result.AsyncState).EndUpdateLoanProductAuxiliaryConditions(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanProductAuxiliaryConditions(baseLoanProductId, loanProductAuxiliaryConditions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region AlternateChannelLogDTO

        public Task<AlternateChannelLogDTO> AddAlternateChannelLogAsync(AlternateChannelLogDTO alternateChannelLogDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AlternateChannelLogDTO>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AlternateChannelLogDTO response = ((IAlternateChannelLogService)result.AsyncState).EndAddAlternateChannelLog(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAlternateChannelLog(alternateChannelLogDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ISO8583AlternateChannelLogDTO> AddISO8583AlternateChannelLogAsync(ISO8583AlternateChannelLogDTO alternateChannelLogDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ISO8583AlternateChannelLogDTO>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ISO8583AlternateChannelLogDTO response = ((IAlternateChannelLogService)result.AsyncState).EndAddISO8583AlternateChannelLog(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddISO8583AlternateChannelLog(alternateChannelLogDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<SPARROWAlternateChannelLogDTO> AddSPARROWAlternateChannelLogAsync(SPARROWAlternateChannelLogDTO alternateChannelLogDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<SPARROWAlternateChannelLogDTO>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    SPARROWAlternateChannelLogDTO response = ((IAlternateChannelLogService)result.AsyncState).EndAddSPARROWAlternateChannelLog(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddSPARROWAlternateChannelLog(alternateChannelLogDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WALLETAlternateChannelLogDTO> AddWALLETAlternateChannelLogAsync(WALLETAlternateChannelLogDTO alternateChannelLogDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WALLETAlternateChannelLogDTO>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WALLETAlternateChannelLogDTO response = ((IAlternateChannelLogService)result.AsyncState).EndAddWALLETAlternateChannelLog(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddWALLETAlternateChannelLog(alternateChannelLogDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ISO8583AlternateChannelLogDTO>> MatchISO8583AlternateChannelLogsAsync(ISO8583AlternateChannelLogDTO alternateChannelLogDTO, bool includeMessageTypeIdentification, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ISO8583AlternateChannelLogDTO>>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ISO8583AlternateChannelLogDTO> response = ((IAlternateChannelLogService)result.AsyncState).EndMatchISO8583AlternateChannelLogs(result);

                    tcs.TrySetResult(new ObservableCollection<ISO8583AlternateChannelLogDTO>(response ?? new List<ISO8583AlternateChannelLogDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchISO8583AlternateChannelLogs(alternateChannelLogDTO, includeMessageTypeIdentification, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ISO8583AlternateChannelLogDTO>> MatchISO8583AlternateChannelLogsByRetrievalReferenceNumberAsync(ISO8583AlternateChannelLogDTO alternateChannelLogDTO, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ISO8583AlternateChannelLogDTO>>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ISO8583AlternateChannelLogDTO> response = ((IAlternateChannelLogService)result.AsyncState).EndMatchISO8583AlternateChannelLogsByRetrievalReferenceNumber(result);

                    tcs.TrySetResult(new ObservableCollection<ISO8583AlternateChannelLogDTO>(response ?? new List<ISO8583AlternateChannelLogDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchISO8583AlternateChannelLogsByRetrievalReferenceNumber(alternateChannelLogDTO, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAlternateChannelLogResponseAsync(Guid alternateChannelLogId, string payload, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelLogService)result.AsyncState).EndUpdateAlternateChannelLogResponse(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAlternateChannelLogResponse(alternateChannelLogId, payload, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<SPARROWAlternateChannelLogDTO>> MatchSPARROWAlternateChannelLogsAsync(SPARROWAlternateChannelLogDTO alternateChannelLogDTO, bool includeMessageTypeIdentification, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<SPARROWAlternateChannelLogDTO>>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<SPARROWAlternateChannelLogDTO> response = ((IAlternateChannelLogService)result.AsyncState).EndMatchSPARROWAlternateChannelLogs(result);

                    tcs.TrySetResult(new ObservableCollection<SPARROWAlternateChannelLogDTO>(response ?? new List<SPARROWAlternateChannelLogDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchSPARROWAlternateChannelLogs(alternateChannelLogDTO, includeMessageTypeIdentification, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<WALLETAlternateChannelLogDTO>> MatchWALLETAlternateChannelLogsAsync(WALLETAlternateChannelLogDTO alternateChannelLogDTO, bool includeMessageTypeIdentification, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<WALLETAlternateChannelLogDTO>>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<WALLETAlternateChannelLogDTO> response = ((IAlternateChannelLogService)result.AsyncState).EndMatchWALLETAlternateChannelLogs(result);

                    tcs.TrySetResult(new ObservableCollection<WALLETAlternateChannelLogDTO>(response ?? new List<WALLETAlternateChannelLogDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginMatchWALLETAlternateChannelLogs(alternateChannelLogDTO, includeMessageTypeIdentification, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateWALLETAlternateChannelLogCallbackPayloadAsync(WALLETAlternateChannelLogDTO alternateChannelLogDTO, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelLogService service = GetService<IAlternateChannelLogService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelLogService)result.AsyncState).EndUpdateWALLETAlternateChannelLogCallbackPayload(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateWALLETAlternateChannelLogCallbackPayload(alternateChannelLogDTO, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region CommissionExemptionDTO

        public Task<ObservableCollection<CommissionExemptionEntryDTO>> FindCommissionExemptionEntriesByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionExemptionEntryDTO>>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionExemptionEntryDTO> response = ((ICommissionExemptionService)result.AsyncState).EndFindCommissionExemptionEntriesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionExemptionEntryDTO>(response ?? new List<CommissionExemptionEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionExemptionEntriesByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CommissionExemptionDTO>> FindCommissionExemptionsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CommissionExemptionDTO>>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CommissionExemptionDTO> response = ((ICommissionExemptionService)result.AsyncState).EndFindCommissionExemptionsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionExemptionsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionExemptionEntryDTO>> FindCommissionExemptionEntriesByCommissionExemptionIdAsync(Guid commissionExemptionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionExemptionEntryDTO>>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionExemptionEntryDTO> response = ((ICommissionExemptionService)result.AsyncState).EndFindCommissionExemptionEntriesByCommissionExemptionId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionExemptionEntryDTO>(response ?? new List<CommissionExemptionEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionExemptionEntriesByCommissionExemptionId(commissionExemptionId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<CommissionExemptionEntryDTO>> FindCommissionExemptionEntriesByCommissionExemptionIdInPageAsync(Guid commissionExemptionId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<CommissionExemptionEntryDTO>>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<CommissionExemptionEntryDTO> response = ((ICommissionExemptionService)result.AsyncState).EndFindCommissionExemptionEntriesByCommissionExemptionIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionExemptionEntriesByCommissionExemptionIdInPage(commissionExemptionId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CommissionExemptionDTO> AddCommissionExemptionAsync(CommissionExemptionDTO commissionExemptionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CommissionExemptionDTO>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CommissionExemptionDTO response = ((ICommissionExemptionService)result.AsyncState).EndAddCommissionExemption(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCommissionExemption(commissionExemptionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionExemptionAsync(CommissionExemptionDTO commissionExemptionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionExemptionService)result.AsyncState).EndUpdateCommissionExemption(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionExemption(commissionExemptionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<CommissionExemptionEntryDTO> AddCommissionExemptionEntryAsync(CommissionExemptionEntryDTO commissionExemptionEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<CommissionExemptionEntryDTO>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    CommissionExemptionEntryDTO response = ((ICommissionExemptionService)result.AsyncState).EndAddCommissionExemptionEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddCommissionExemptionEntry(commissionExemptionEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveCommissionExemptionEntriesAsync(ObservableCollection<CommissionExemptionEntryDTO> commissionExemptionEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionExemptionService)result.AsyncState).EndRemoveCommissionExemptionEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveCommissionExemptionEntries(commissionExemptionEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionExemptionEntryCollectionByCommissionExemptionIdAsync(Guid commissionExemptionId, ObservableCollection<CommissionExemptionEntryDTO> commissionExemptionEntryCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ICommissionExemptionService service = GetService<ICommissionExemptionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ICommissionExemptionService)result.AsyncState).EndUpdateCommissionExemptionEntryCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionExemptionEntryCollection(commissionExemptionId, commissionExemptionEntryCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region RecurringBatchDTO

        public Task<bool> CapitalizeInterestByEmployersAndLoanProductsAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<EmployerDTO> employerDTOs, ObservableCollection<LoanProductDTO> loanProductDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndCapitalizeInterestByEmployersAndLoanProducts(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCapitalizeInterestByEmployersAndLoanProducts(recurringBatchDTO, employerDTOs.ExtendedToList(), loanProductDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CapitalizeInterestByCustomersAndLoanProductsAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<CustomerDTO> customerDTOs, ObservableCollection<LoanProductDTO> loanProductDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndCapitalizeInterestByCustomersAndLoanProducts(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCapitalizeInterestByCustomersAndLoanProducts(recurringBatchDTO, customerDTOs.ExtendedToList(), loanProductDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CapitalizeInterestByCreditTypesAndLoanProductsAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<CreditTypeDTO> creditTypeDTOs, ObservableCollection<LoanProductDTO> loanProductDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndCapitalizeInterestByCreditTypesAndLoanProducts(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCapitalizeInterestByCreditTypesAndLoanProducts(recurringBatchDTO, creditTypeDTOs.ExtendedToList(), loanProductDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CapitalizeInterestAsync(int priority, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndCapitalizeInterest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCapitalizeInterest(priority, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ProcessSavingsProductLedgerFeesAsync(int priority, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndProcessSavingsProductLedgerFees(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginProcessSavingsProductLedgerFees(priority, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ChargeLoanDynamicFeesAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<LoanProductDTO> loanProductDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndChargeLoanDynamicFees(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginChargeLoanDynamicFees(recurringBatchDTO, loanProductDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ChargeSavingsDynamicFeesAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<SavingsProductDTO> savingsProductDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndChargeSavingsDynamicFees(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginChargeSavingsDynamicFees(recurringBatchDTO, savingsProductDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteStandingOrdersAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<StandingOrderDTO> standingOrderDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteStandingOrders(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteStandingOrders(recurringBatchDTO, standingOrderDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteStandingOrdersByBenefactorEmployerAndTriggerAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<EmployerDTO> employerDTOs, int standingOrderTrigger, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteStandingOrdersByBenefactorEmployerAndTrigger(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteStandingOrdersByBenefactorEmployerAndTrigger(recurringBatchDTO, employerDTOs.ExtendedToList(), standingOrderTrigger, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostRecurringBatchEntryAsync(Guid recurringBatchEntryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndPostRecurringBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostRecurringBatchEntry(recurringBatchEntryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<RecurringBatchEntryDTO>> FindQueableRecurringBatchEntriesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<RecurringBatchEntryDTO>>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<RecurringBatchEntryDTO> response = ((IRecurringBatchService)result.AsyncState).EndFindQueableRecurringBatchEntriesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableRecurringBatchEntriesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<RecurringBatchDTO>> FindRecurringBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<RecurringBatchDTO>>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<RecurringBatchDTO> response = ((IRecurringBatchService)result.AsyncState).EndFindRecurringBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindRecurringBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<RecurringBatchEntryDTO>> FindRecurringBatchEntriesByRecurringBatchIdInPageAsync(Guid recurringBatchId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<RecurringBatchEntryDTO>>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<RecurringBatchEntryDTO> response = ((IRecurringBatchService)result.AsyncState).EndFindRecurringBatchEntriesByRecurringBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindRecurringBatchEntriesByRecurringBatchIdInPage(recurringBatchId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> NormalizeInvestmentBalancesAsync(string investmentNormalizationSets, int priority, bool enforceCeiling, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndNormalizeInvestmentBalances(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginNormalizeInvestmentBalances(investmentNormalizationSets, priority, enforceCeiling, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteScheduledStandingOrdersAsync(DateTime targetDate, int targetDateOption, int priority, int maximumStandingOrderExecuteAttemptCount, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteScheduledStandingOrders(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteScheduledStandingOrders(targetDate, targetDateOption, priority, maximumStandingOrderExecuteAttemptCount, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteStandingOrdersByBenefactorEmployersAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<EmployerDTO> employerDTOs, ObservableCollection<SavingsProductDTO> savingsProductDTOs, ObservableCollection<LoanProductDTO> loanProductDTOs, ObservableCollection<InvestmentProductDTO> investmentProductDTOs, int standingOrderTrigger, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteStandingOrdersByBenefactorEmployers(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteStandingOrdersByBenefactorEmployers(recurringBatchDTO, employerDTOs.ExtendedToList(), savingsProductDTOs.ExtendedToList(), loanProductDTOs.ExtendedToList(), investmentProductDTOs.ExtendedToList(), standingOrderTrigger, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteStandingOrdersByBenefactorCustomersAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<CustomerDTO> customerDTOs, ObservableCollection<SavingsProductDTO> savingsProductDTOs, ObservableCollection<LoanProductDTO> loanProductDTOs, ObservableCollection<InvestmentProductDTO> investmentProductDTOs, int standingOrderTrigger, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteStandingOrdersByBenefactorCustomers(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteStandingOrdersByBenefactorCustomers(recurringBatchDTO, customerDTOs.ExtendedToList(), savingsProductDTOs.ExtendedToList(), loanProductDTOs.ExtendedToList(), investmentProductDTOs.ExtendedToList(), standingOrderTrigger, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteStandingOrdersByBenefactorCreditTypesAsync(RecurringBatchDTO recurringBatchDTO, ObservableCollection<CreditTypeDTO> creditTypeDTOs, ObservableCollection<SavingsProductDTO> savingsProductDTOs, ObservableCollection<LoanProductDTO> loanProductDTOs, ObservableCollection<InvestmentProductDTO> investmentProductDTOs, int standingOrderTrigger, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteStandingOrdersByBenefactorCreditTypes(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteStandingOrdersByBenefactorCreditTypes(recurringBatchDTO, creditTypeDTOs.ExtendedToList(), savingsProductDTOs.ExtendedToList(), loanProductDTOs.ExtendedToList(), investmentProductDTOs.ExtendedToList(), standingOrderTrigger, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteSweepingStandingOrdersAsync(int priority, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteSweepingStandingOrders(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteSweepingStandingOrders(priority, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PoolInvestmentBalancesAsync(int priority, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndPoolInvestmentBalances(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPoolInvestmentBalances(priority, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReleaseLoanGuarantorsAsync(int priority, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndReleaseLoanGuarantors(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReleaseLoanGuarantors(priority, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ExecuteElectronicStatementOrdersAsync(DateTime targetDate, int targetDateOption, string sender, int priority, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndExecuteElectronicStatementOrders(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginExecuteElectronicStatementOrders(targetDate, targetDateOption, sender, priority, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RecoverArrearsAsync(int priority, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndRecoverArrears(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRecoverArrears(priority, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RecoverArrearsFromInvestmentProductAsync(int priority, string targetProductCodes, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IRecurringBatchService service = GetService<IRecurringBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IRecurringBatchService)result.AsyncState).EndRecoverArrearsFromInvestmentProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRecoverArrearsFromInvestmentProduct(priority, targetProductCodes, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LeaveTypeDTO

        public Task<LeaveTypeDTO> AddNewLeaveTypeAsync(LeaveTypeDTO leaveTypeDTO, ServiceHeader serviceHeader = null)
        {
            var tcs = new TaskCompletionSource<LeaveTypeDTO>();

            ILeaveTypeService service = GetService<ILeaveTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LeaveTypeDTO response = ((ILeaveTypeService)result.AsyncState).EndAddNewLeaveType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddNewLeaveType(leaveTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLeaveTypeAsync(LeaveTypeDTO leaveTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILeaveTypeService service = GetService<ILeaveTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILeaveTypeService)result.AsyncState).EndUpdateLeaveType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLeaveType(leaveTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<LeaveTypeDTO>> FindLeaveTypesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<LeaveTypeDTO>>();

            ILeaveTypeService service = GetService<ILeaveTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LeaveTypeDTO> response = ((ILeaveTypeService)result.AsyncState).EndFindLeaveTypes(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveTypes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LeaveTypeDTO>> FindLeaveTypesFilterInPageAsync(string filterText, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LeaveTypeDTO>>();

            ILeaveTypeService service = GetService<ILeaveTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LeaveTypeDTO> response = ((ILeaveTypeService)result.AsyncState).EndFindLeaveTypesFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveTypesFilterInPage(filterText, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LeaveTypeDTO> FindLeaveTypeAsync(Guid leaveTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LeaveTypeDTO>();

            ILeaveTypeService service = GetService<ILeaveTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LeaveTypeDTO response = ((ILeaveTypeService)result.AsyncState).EndFindLeaveType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveType(leaveTypeId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LeaveApplicationDTO

        public Task<PageCollectionInfo<LeaveApplicationDTO>> FindLeaveApplicationsByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LeaveApplicationDTO>>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LeaveApplicationDTO> response = ((ILeaveApplicationService)result.AsyncState).EndFindLeaveApplicationsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveApplicationsByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LeaveApplicationDTO>> FindLeaveApplicationsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LeaveApplicationDTO>>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LeaveApplicationDTO> response = ((ILeaveApplicationService)result.AsyncState).EndFindLeaveApplicationsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveApplicationsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LeaveApplicationDTO>> FindLeaveApplicationsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LeaveApplicationDTO>>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LeaveApplicationDTO> response = ((ILeaveApplicationService)result.AsyncState).EndFindLeaveApplicationsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveApplicationsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LeaveApplicationDTO> AddLeaveApplicationAsync(LeaveApplicationDTO leaveApplicationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LeaveApplicationDTO>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LeaveApplicationDTO response = ((ILeaveApplicationService)result.AsyncState).EndAddLeaveApplication(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLeaveApplication(leaveApplicationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLeaveApplicationAsync(LeaveApplicationDTO leaveApplicationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILeaveApplicationService)result.AsyncState).EndUpdateLeaveApplication(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLeaveApplication(leaveApplicationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeLeaveApplicationAsync(LeaveApplicationDTO leaveApplicationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILeaveApplicationService)result.AsyncState).EndAuthorizeLeaveApplication(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeLeaveApplication(leaveApplicationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RecallLeaveApplicationAsync(LeaveApplicationDTO leaveApplicationDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILeaveApplicationService)result.AsyncState).EndRecallLeaveApplication(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRecallLeaveApplication(leaveApplicationDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LeaveApplicationDTO> FindLeaveApplicationAsync(Guid leaveApplicationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LeaveApplicationDTO>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LeaveApplicationDTO response = ((ILeaveApplicationService)result.AsyncState).EndFindLeaveApplication(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveApplication(leaveApplicationId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<LeaveApplicationDTO>> FindLeaveApplicationsByEmployeeIdAsync(Guid employeeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<LeaveApplicationDTO>>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LeaveApplicationDTO> response = ((ILeaveApplicationService)result.AsyncState).EndFindLeaveApplicationsByEmployeeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveApplicationsByEmployeeId(employeeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<LeaveApplicationDTO>> FindLeaveApplicationsByEmployeeIdAndLeaveTypeIdAsync(Guid employeeId, Guid leaveTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<LeaveApplicationDTO>>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LeaveApplicationDTO> response = ((ILeaveApplicationService)result.AsyncState).EndFindLeaveApplicationsByEmployeeIdAndLeaveTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeaveApplicationsByEmployeeIdAndLeaveTypeId(employeeId, leaveTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<decimal> FindEmployeeLeaveBalancesAsync(Guid employeeId, Guid leaveTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<decimal>();

            ILeaveApplicationService service = GetService<ILeaveApplicationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    decimal response = ((ILeaveApplicationService)result.AsyncState).EndFindEmployeeLeaveBalances(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0m);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeLeaveBalances(employeeId, leaveTypeId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanDisbursementBatchDTO

        public Task<ObservableCollection<LoanDisbursementBatchEntryDTO>> FindLoanDisbursementBatchEntriesByCustomerIdAsync(int loanDisbursementBatchType, Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanDisbursementBatchEntryDTO>>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanDisbursementBatchEntryDTO> response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindLoanDisbursementBatchEntriesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanDisbursementBatchEntryDTO>(response ?? new List<LoanDisbursementBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanDisbursementBatchEntriesByCustomerId(loanDisbursementBatchType, customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanDisbursementBatchDTO>> FindLoanDisbursementBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanDisbursementBatchDTO>>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanDisbursementBatchDTO> response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindLoanDisbursementBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanDisbursementBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanDisbursementBatchEntryDTO>> FindLoanDisbursementBatchEntriesByLoanDisbursementBatchIdAsync(Guid loanDisbursementBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanDisbursementBatchEntryDTO>>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanDisbursementBatchEntryDTO> response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindLoanDisbursementBatchEntriesByLoanDisbursementBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<LoanDisbursementBatchEntryDTO>(response ?? new List<LoanDisbursementBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanDisbursementBatchEntriesByLoanDisbursementBatchId(loanDisbursementBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanDisbursementBatchEntryDTO>> FindLoanDisbursementBatchEntriesByLoanDisbursementBatchIdInPageAsync(Guid loanDisbursementBatchId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanDisbursementBatchEntryDTO>>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanDisbursementBatchEntryDTO> response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindLoanDisbursementBatchEntriesByLoanDisbursementBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanDisbursementBatchEntriesByLoanDisbursementBatchIdInPage(loanDisbursementBatchId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanDisbursementBatchEntryDTO>> FindLoanDisbursementBatchEntriesByLoanDisbursementBatchTypeInPageAsync(int loanDisbursementBatchType, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanDisbursementBatchEntryDTO>>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanDisbursementBatchEntryDTO> response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindLoanDisbursementBatchEntriesByLoanDisbursementBatchTypeInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanDisbursementBatchEntriesByLoanDisbursementBatchTypeInPage(loanDisbursementBatchType, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanDisbursementBatchDTO> AddLoanDisbursementBatchAsync(LoanDisbursementBatchDTO loanDisbursementBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanDisbursementBatchDTO>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanDisbursementBatchDTO response = ((ILoanDisbursementBatchService)result.AsyncState).EndAddLoanDisbursementBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanDisbursementBatch(loanDisbursementBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanDisbursementBatchDTO> FindLoanDisbursementBatchAsync(Guid loanDisbursementBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanDisbursementBatchDTO>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanDisbursementBatchDTO response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindLoanDisbursementBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanDisbursementBatch(loanDisbursementBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanDisbursementBatchAsync(LoanDisbursementBatchDTO loanDisbursementBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndUpdateLoanDisbursementBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanDisbursementBatch(loanDisbursementBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditLoanDisbursementBatchAsync(LoanDisbursementBatchDTO loanDisbursementBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndAuditLoanDisbursementBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditLoanDisbursementBatch(loanDisbursementBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeLoanDisbursementBatchAsync(LoanDisbursementBatchDTO loanDisbursementBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndAuthorizeLoanDisbursementBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeLoanDisbursementBatch(loanDisbursementBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanDisbursementBatchEntryDTO> AddLoanDisbursementBatchEntryAsync(LoanDisbursementBatchEntryDTO loanDisbursementBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanDisbursementBatchEntryDTO>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanDisbursementBatchEntryDTO response = ((ILoanDisbursementBatchService)result.AsyncState).EndAddLoanDisbursementBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanDisbursementBatchEntry(loanDisbursementBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveLoanDisbursementBatchEntriesAsync(ObservableCollection<LoanDisbursementBatchEntryDTO> loanDisbursementBatchEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndRemoveLoanDisbursementBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveLoanDisbursementBatchEntries(loanDisbursementBatchEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanDisbursementBatchEntriesAsync(Guid loanDisbursementBatchId, List<LoanDisbursementBatchEntryDTO> loanDisbursementBatchEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndUpdateLoanDisbursementBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanDisbursementBatchEntries(loanDisbursementBatchId, loanDisbursementBatchEntries, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostLoanDisbursementBatchEntryAsync(Guid loanDisbursementBatchEntryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndPostLoanDisbursementBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostLoanDisbursementBatchEntry(loanDisbursementBatchEntryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<decimal> DisburseMicroLoanAsync(Guid alternateChannelLogId, Guid settlementChartOfAccountId, CustomerAccountDTO customerLoanAccountDTO, decimal totalValue, string primaryDescription, string secondaryDescription, string reference, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<decimal>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    decimal response = ((ILoanDisbursementBatchService)result.AsyncState).EndDisburseMicroLoan(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        tcs.TrySetResult(0m);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginDisburseMicroLoan(alternateChannelLogId, settlementChartOfAccountId, customerLoanAccountDTO, totalValue, primaryDescription, secondaryDescription, reference, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanDisbursementBatchEntryDTO>> FindQueableLoanDisbursementBatchEntriesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanDisbursementBatchEntryDTO>>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanDisbursementBatchEntryDTO> response = ((ILoanDisbursementBatchService)result.AsyncState).EndFindQueableLoanDisbursementBatchEntriesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableLoanDisbursementBatchEntriesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ValidateLoanDisbursementBatchEntriesExceedTransactionThresholdAsync(Guid loanDisbursementBatchId, Guid designationId, int transactionThresholdType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanDisbursementBatchService service = GetService<ILoanDisbursementBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanDisbursementBatchService)result.AsyncState).EndValidateLoanDisbursementBatchEntriesExceedTransactionThreshold(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginValidateLoanDisbursementBatchEntriesExceedTransactionThreshold(loanDisbursementBatchId, designationId, transactionThresholdType, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ApplicationDomainWrapper

        public Task<PageCollectionInfo<ApplicationDomainWrapper>> FindApplicationDomainsByFilterInPageAsync(int pageIndex, int pageSize, string filter, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ApplicationDomainWrapper>>();

            IUtilityService service = GetService<IUtilityService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ApplicationDomainWrapper> response = ((IUtilityService)result.AsyncState).EndFindApplicationDomainsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindApplicationDomainsByFilterInPage(filter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ConfigureApplicationDatabaseAsync(ServiceHeader serviceHeader, double timeoutMinutes)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUtilityService service = GetService<IUtilityService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUtilityService)result.AsyncState).EndConfigureApplicationDatabase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginConfigureApplicationDatabase(asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ConfigureAspNetIdentityDatabaseAsync(ServiceHeader serviceHeader, double timeoutMinutes)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUtilityService service = GetService<IUtilityService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUtilityService)result.AsyncState).EndConfigureAspNetIdentityDatabase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginConfigureAspNetIdentityDatabase(asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ConfigureAspNetMembershipDatabaseAsync(ServiceHeader serviceHeader, double timeoutMinutes)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUtilityService service = GetService<IUtilityService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUtilityService)result.AsyncState).EndConfigureAspNetMembershipDatabase(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginConfigureAspNetMembershipDatabase(asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> SeedEnumerationsAsync(ServiceHeader serviceHeader, double timeoutMinutes)
        {
            var tcs = new TaskCompletionSource<bool>();

            IUtilityService service = GetService<IUtilityService>(serviceHeader, timeoutMinutes);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IUtilityService)result.AsyncState).EndSeedEnumerations(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginSeedEnumerations(asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BankReconciliationPeriodDTO

        public Task<PageCollectionInfo<BankReconciliationPeriodDTO>> FindBankReconciliationPeriodsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankReconciliationPeriodDTO>>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankReconciliationPeriodDTO> response = ((IBankReconciliationPeriodService)result.AsyncState).EndFindBankReconciliationPeriodsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankReconciliationPeriodsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BankReconciliationPeriodDTO>> FindBankReconciliationPeriodsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankReconciliationPeriodDTO>>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankReconciliationPeriodDTO> response = ((IBankReconciliationPeriodService)result.AsyncState).EndFindBankReconciliationPeriodsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankReconciliationPeriodsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankReconciliationPeriodDTO> AddBankReconciliationPeriodAsync(BankReconciliationPeriodDTO bankReconciliationPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankReconciliationPeriodDTO>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankReconciliationPeriodDTO response = ((IBankReconciliationPeriodService)result.AsyncState).EndAddBankReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBankReconciliationPeriod(bankReconciliationPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBankReconciliationPeriodAsync(BankReconciliationPeriodDTO bankReconciliationPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankReconciliationPeriodService)result.AsyncState).EndUpdateBankReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBankReconciliationPeriod(bankReconciliationPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankReconciliationPeriodDTO> FindBankReconciliationPeriodAsync(Guid bankReconciliationPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankReconciliationPeriodDTO>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankReconciliationPeriodDTO response = ((IBankReconciliationPeriodService)result.AsyncState).EndFindBankReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankReconciliationPeriod(bankReconciliationPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BankReconciliationEntryDTO>> FindBankReconciliationEntriesByBankReconciliationPeriodIdAndFilterInPageAsync(Guid bankReconciliationPeriodId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankReconciliationEntryDTO>>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankReconciliationEntryDTO> response = ((IBankReconciliationPeriodService)result.AsyncState).EndFindBankReconciliationEntriesByBankReconciliationPeriodIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankReconciliationEntriesByBankReconciliationPeriodIdAndFilterInPage(bankReconciliationPeriodId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankReconciliationEntryDTO> AddBankReconciliationEntryAsync(BankReconciliationEntryDTO bankReconciliationEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankReconciliationEntryDTO>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankReconciliationEntryDTO response = ((IBankReconciliationPeriodService)result.AsyncState).EndAddBankReconciliationEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBankReconciliationEntry(bankReconciliationEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveBankReconciliationEntriesAsync(ObservableCollection<BankReconciliationEntryDTO> bankReconciliationEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankReconciliationPeriodService)result.AsyncState).EndRemoveBankReconciliationEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveBankReconciliationEntries(bankReconciliationEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CloseBankReconciliationPeriodAsync(BankReconciliationPeriodDTO bankReconciliationPeriodDTO, int bankReconciliationPeriodAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankReconciliationPeriodService service = GetService<IBankReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankReconciliationPeriodService)result.AsyncState).EndCloseBankReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCloseBankReconciliationPeriod(bankReconciliationPeriodDTO, bankReconciliationPeriodAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region JournalReversalBatchDTO

        public Task<PageCollectionInfo<JournalReversalBatchDTO>> FindJournalReversalBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalReversalBatchDTO>>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalReversalBatchDTO> response = ((IJournalReversalBatchService)result.AsyncState).EndFindJournalReversalBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalReversalBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalReversalBatchDTO> FindJournalReversalBatchByIdAsync(Guid journalReversalBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalReversalBatchDTO>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalReversalBatchDTO response = ((IJournalReversalBatchService)result.AsyncState).EndFindJournalReversalBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalReversalBatch(journalReversalBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<JournalReversalBatchEntryDTO>> FindJournalReversalBatchEntriesByJournalReversalBatchIdAsync(Guid journalReversalBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<JournalReversalBatchEntryDTO>>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<JournalReversalBatchEntryDTO> response = ((IJournalReversalBatchService)result.AsyncState).EndFindJournalReversalBatchEntriesByJournalReversalBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<JournalReversalBatchEntryDTO>(response ?? new List<JournalReversalBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalReversalBatchEntriesByJournalReversalBatchId(journalReversalBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalReversalBatchEntryDTO>> FindJournalReversalBatchEntriesByJournalReversalBatchIdInPageAsync(Guid journalReversalBatchId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalReversalBatchEntryDTO>>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalReversalBatchEntryDTO> response = ((IJournalReversalBatchService)result.AsyncState).EndFindJournalReversalBatchEntriesByJournalReversalBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalReversalBatchEntriesByJournalReversalBatchIdInPage(journalReversalBatchId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalEntryDTO>> FindJournalEntriesByJournalReversalBatchIdInPageAsync(Guid journalReversalBatchId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalEntryDTO>>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalEntryDTO> response = ((IJournalReversalBatchService)result.AsyncState).EndFindJournalEntriesByJournalReversalBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindJournalEntriesByJournalReversalBatchIdInPage(journalReversalBatchId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalReversalBatchDTO> AddJournalReversalBatchAsync(JournalReversalBatchDTO journalReversalBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalReversalBatchDTO>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalReversalBatchDTO response = ((IJournalReversalBatchService)result.AsyncState).EndAddJournalReversalBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalReversalBatch(journalReversalBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateJournalReversalBatchAsync(JournalReversalBatchDTO journalReversalBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalReversalBatchService)result.AsyncState).EndUpdateJournalReversalBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateJournalReversalBatch(journalReversalBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditJournalReversalBatchAsync(JournalReversalBatchDTO journalReversalBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalReversalBatchService)result.AsyncState).EndAuditJournalReversalBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditJournalReversalBatch(journalReversalBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeJournalReversalBatchAsync(JournalReversalBatchDTO journalReversalBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalReversalBatchService)result.AsyncState).EndAuthorizeJournalReversalBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeJournalReversalBatch(journalReversalBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateJournalReversalBatchEntriesAsync(Guid journalReversalBatchId, List<JournalReversalBatchEntryDTO> journalReversalBatchEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalReversalBatchService)result.AsyncState).EndUpdateJournalReversalBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateJournalReversalBatchEntries(journalReversalBatchId, journalReversalBatchEntries, asyncCallback, service);

            return tcs.Task;
        }

        public Task<JournalReversalBatchEntryDTO> AddJournalReversalBatchEntryAsync(JournalReversalBatchEntryDTO journalReversalBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<JournalReversalBatchEntryDTO>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    JournalReversalBatchEntryDTO response = ((IJournalReversalBatchService)result.AsyncState).EndAddJournalReversalBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddJournalReversalBatchEntry(journalReversalBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveJournalReversalBatchEntriesAsync(ObservableCollection<JournalReversalBatchEntryDTO> journalReversalBatchEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalReversalBatchService)result.AsyncState).EndRemoveJournalReversalBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveJournalReversalBatchEntries(journalReversalBatchEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<JournalReversalBatchEntryDTO>> FindQueableJournalReversalBatchEntriesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<JournalReversalBatchEntryDTO>>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<JournalReversalBatchEntryDTO> response = ((IJournalReversalBatchService)result.AsyncState).EndFindQueableJournalReversalBatchEntriesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindQueableJournalReversalBatchEntriesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> PostJournalReversalBatchEntryAsync(Guid journalReversalBatchEntryId, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IJournalReversalBatchService service = GetService<IJournalReversalBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IJournalReversalBatchService)result.AsyncState).EndPostJournalReversalBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginPostJournalReversalBatchEntry(journalReversalBatchEntryId, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region InterAccountTransferBatchDTO

        public Task<PageCollectionInfo<InterAccountTransferBatchDTO>> FindInterAccountTransferBatchesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InterAccountTransferBatchDTO>>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InterAccountTransferBatchDTO> response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindInterAccountTransferBatchesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInterAccountTransferBatchesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InterAccountTransferBatchDTO>> FindInterAccountTransferBatchesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InterAccountTransferBatchDTO>>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InterAccountTransferBatchDTO> response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindInterAccountTransferBatchesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInterAccountTransferBatchesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InterAccountTransferBatchDTO>> FindInterAccountTransferBatchesByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InterAccountTransferBatchDTO>>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InterAccountTransferBatchDTO> response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindInterAccountTransferBatchesByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInterAccountTransferBatchesByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<InterAccountTransferBatchEntryDTO>> FindInterAccountTransferBatchEntriesByInterAccountTransferBatchIdAsync(Guid interAccountTransferBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<InterAccountTransferBatchEntryDTO>>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<InterAccountTransferBatchEntryDTO> response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindInterAccountTransferBatchEntriesByInterAccountTransferBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<InterAccountTransferBatchEntryDTO>(response ?? new List<InterAccountTransferBatchEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInterAccountTransferBatchEntriesByInterAccountTransferBatchId(interAccountTransferBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<InterAccountTransferBatchEntryDTO>> FindInterAccountTransferBatchEntriesByInterAccountTransferBatchIdInPageAsync(Guid interAccountTransferBatchId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<InterAccountTransferBatchEntryDTO>>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<InterAccountTransferBatchEntryDTO> response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindInterAccountTransferBatchEntriesByInterAccountTransferBatchIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInterAccountTransferBatchEntriesByInterAccountTransferBatchIdInPage(interAccountTransferBatchId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InterAccountTransferBatchDTO> AddInterAccountTransferBatchAsync(InterAccountTransferBatchDTO interAccountTransferBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InterAccountTransferBatchDTO>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InterAccountTransferBatchDTO response = ((IInterAccountTransferBatchService)result.AsyncState).EndAddInterAccountTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddInterAccountTransferBatch(interAccountTransferBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InterAccountTransferBatchDTO> FindInterAccountTransferBatchAsync(Guid interAccountTransferBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InterAccountTransferBatchDTO>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InterAccountTransferBatchDTO response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindInterAccountTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindInterAccountTransferBatch(interAccountTransferBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<InterAccountTransferBatchEntryDTO> AddInterAccountTransferBatchEntryAsync(InterAccountTransferBatchEntryDTO interAccountTransferBatchEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<InterAccountTransferBatchEntryDTO>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    InterAccountTransferBatchEntryDTO response = ((IInterAccountTransferBatchService)result.AsyncState).EndAddInterAccountTransferBatchEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddInterAccountTransferBatchEntry(interAccountTransferBatchEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<DynamicChargeDTO>> FindDynamicChargesByInterAccountTransferBatchIdAsync(Guid interAccountTransferBatchId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DynamicChargeDTO>>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DynamicChargeDTO> response = ((IInterAccountTransferBatchService)result.AsyncState).EndFindDynamicChargesByInterAccountTransferBatchId(result);

                    tcs.TrySetResult(new ObservableCollection<DynamicChargeDTO>(response ?? new List<DynamicChargeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDynamicChargesByInterAccountTransferBatchId(interAccountTransferBatchId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateInterAccountTransferBatchAsync(InterAccountTransferBatchDTO interAccountTransferBatchDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInterAccountTransferBatchService)result.AsyncState).EndUpdateInterAccountTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateInterAccountTransferBatch(interAccountTransferBatchDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveInterAccountTransferBatchEntriesAsync(ObservableCollection<InterAccountTransferBatchEntryDTO> interAccountTransferBatchEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInterAccountTransferBatchService)result.AsyncState).EndRemoveInterAccountTransferBatchEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveInterAccountTransferBatchEntries(interAccountTransferBatchEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditInterAccountTransferBatchAsync(InterAccountTransferBatchDTO interAccountTransferBatchDTO, int batchAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInterAccountTransferBatchService)result.AsyncState).EndAuditInterAccountTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditInterAccountTransferBatch(interAccountTransferBatchDTO, batchAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeInterAccountTransferBatchAsync(InterAccountTransferBatchDTO interAccountTransferBatchDTO, int batchAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInterAccountTransferBatchService)result.AsyncState).EndAuthorizeInterAccountTransferBatch(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeInterAccountTransferBatch(interAccountTransferBatchDTO, batchAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateInterAccountTransferBatchEntryCollectionAsync(Guid interAccountTransferBatchId, ObservableCollection<InterAccountTransferBatchEntryDTO> interAccountTransferBatchEntryCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInterAccountTransferBatchService)result.AsyncState).EndUpdateInterAccountTransferBatchEntryCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateInterAccountTransferBatchEntryCollection(interAccountTransferBatchId, interAccountTransferBatchEntryCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDynamicChargesByInterAccountTransferBatchIdAsync(Guid interAccountTransferBatchId, ObservableCollection<DynamicChargeDTO> dynamicCharges, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IInterAccountTransferBatchService service = GetService<IInterAccountTransferBatchService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IInterAccountTransferBatchService)result.AsyncState).EndUpdateDynamicChargesByInterAccountTransferBatchId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDynamicChargesByInterAccountTransferBatchId(interAccountTransferBatchId, dynamicCharges.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ExpensePayableDTO

        public Task<PageCollectionInfo<ExpensePayableDTO>> FindExpensePayablesByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExpensePayableDTO>>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExpensePayableDTO> response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayablesByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayablesByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExpensePayableDTO>> FindExpensePayablesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExpensePayableDTO>>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExpensePayableDTO> response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayablesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayablesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }
        public Task<PageCollectionInfo<ExpensePayableDTO>> FindExpensePayablesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExpensePayableDTO>>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExpensePayableDTO> response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayablesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayablesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExpensePayableDTO>> FindExpensePayablesByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExpensePayableDTO>>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExpensePayableDTO> response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayablesByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayablesByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ExpensePayableEntryDTO>> FindExpensePayableEntriesByExpensePayableIdAsync(Guid expensePayableId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ExpensePayableEntryDTO>>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ExpensePayableEntryDTO> response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayableEntriesByExpensePayableId(result);

                    tcs.TrySetResult(new ObservableCollection<ExpensePayableEntryDTO>(response ?? new List<ExpensePayableEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayableEntriesByExpensePayableId(expensePayableId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ExpensePayableEntryDTO>> FindExpensePayableEntriesByExpensePayableIdInPageAsync(Guid expensePayableId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ExpensePayableEntryDTO>>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ExpensePayableEntryDTO> response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayableEntriesByExpensePayableIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayableEntriesByExpensePayableIdInPage(expensePayableId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ExpensePayableDTO> AddExpensePayableAsync(ExpensePayableDTO expensePayableDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ExpensePayableDTO>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ExpensePayableDTO response = ((IExpensePayableService)result.AsyncState).EndAddExpensePayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddExpensePayable(expensePayableDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ExpensePayableDTO> FindExpensePayableAsync(Guid expensePayableId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ExpensePayableDTO>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ExpensePayableDTO response = ((IExpensePayableService)result.AsyncState).EndFindExpensePayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindExpensePayable(expensePayableId, asyncCallback, service);

            return tcs.Task;
        }


        public Task<bool> UpdateExpensePayableEntriesByExpensePayableIdAsync(Guid expensePayableId, ObservableCollection<ExpensePayableEntryDTO> expensePayableEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExpensePayableService)result.AsyncState).EndUpdateExpensePayableEntriesByExpensePayableId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

           
            service.BeginUpdateExpensePayableEntriesByExpensePayableId(expensePayableId, expensePayableEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }




        public Task<ExpensePayableEntryDTO> AddExpensePayableEntryAsync(ExpensePayableEntryDTO expensePayableEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ExpensePayableEntryDTO>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ExpensePayableEntryDTO response = ((IExpensePayableService)result.AsyncState).EndAddExpensePayableEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddExpensePayableEntry(expensePayableEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateExpensePayableAsync(ExpensePayableDTO expensePayableDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExpensePayableService)result.AsyncState).EndUpdateExpensePayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateExpensePayable(expensePayableDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveExpensePayableEntriesAsync(ObservableCollection<ExpensePayableEntryDTO> expensePayableEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExpensePayableService)result.AsyncState).EndRemoveExpensePayableEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveExpensePayableEntries(expensePayableEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditExpensePayableAsync(ExpensePayableDTO expensePayableDTO, int expensePayableAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExpensePayableService)result.AsyncState).EndAuditExpensePayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditExpensePayable(expensePayableDTO, expensePayableAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeExpensePayableAsync(ExpensePayableDTO expensePayableDTO, int expensePayableAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExpensePayableService)result.AsyncState).EndAuthorizeExpensePayable(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeExpensePayable(expensePayableDTO, expensePayableAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateExpensePayableEntryCollectionAsync(Guid expensePayableId, ObservableCollection<ExpensePayableEntryDTO> expensePayableEntryCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IExpensePayableService service = GetService<IExpensePayableService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IExpensePayableService)result.AsyncState).EndUpdateExpensePayableEntryCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateExpensePayableEntryCollection(expensePayableId, expensePayableEntryCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region MobileToBankRequestDTO

        public Task<PageCollectionInfo<MobileToBankRequestDTO>> FindMobileToBankRequestsByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MobileToBankRequestDTO>>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MobileToBankRequestDTO> response = ((IMobileToBankRequestService)result.AsyncState).EndFindMobileToBankRequestsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMobileToBankRequestsByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<MobileToBankRequestDTO>> FindMobileToBankRequestsByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MobileToBankRequestDTO>>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MobileToBankRequestDTO> response = ((IMobileToBankRequestService)result.AsyncState).EndFindMobileToBankRequestsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMobileToBankRequestsByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<MobileToBankRequestDTO>> FindMobileToBankRequestsByStatusRecordStatusAndFilterInPageAsync(int status, int recordStatus, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<MobileToBankRequestDTO>>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<MobileToBankRequestDTO> response = ((IMobileToBankRequestService)result.AsyncState).EndFindMobileToBankRequestsByStatusRecordStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMobileToBankRequestsByStatusRecordStatusAndFilterInPage(status, recordStatus, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MobileToBankRequestDTO> AddMobileToBankRequestAsync(MobileToBankRequestDTO mobileToBankRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MobileToBankRequestDTO>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MobileToBankRequestDTO response = ((IMobileToBankRequestService)result.AsyncState).EndAddMobileToBankRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddMobileToBankRequest(mobileToBankRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ReconcileMobileToBankRequestAsync(MobileToBankRequestDTO mobileToBankRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMobileToBankRequestService)result.AsyncState).EndReconcileMobileToBankRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginReconcileMobileToBankRequest(mobileToBankRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditMobileToBankRequestReconciliationAsync(MobileToBankRequestDTO mobileToBankRequestDTO, int requestAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IMobileToBankRequestService)result.AsyncState).EndAuditMobileToBankRequestReconciliation(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditMobileToBankRequestReconciliation(mobileToBankRequestDTO, requestAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<MobileToBankRequestDTO> FindMobileToBankRequestAsync(Guid mobileToBankRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<MobileToBankRequestDTO>();

            IMobileToBankRequestService service = GetService<IMobileToBankRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    MobileToBankRequestDTO response = ((IMobileToBankRequestService)result.AsyncState).EndFindMobileToBankRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindMobileToBankRequest(mobileToBankRequestId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BankToMobileRequestDTO

        public Task<PageCollectionInfo<BankToMobileRequestDTO>> FindBankToMobileRequestsByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankToMobileRequestDTO>>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankToMobileRequestDTO> response = ((IBankToMobileRequestService)result.AsyncState).EndFindBankToMobileRequestsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankToMobileRequestsByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BankToMobileRequestDTO>> FindThirdPartyNotifiableBankToMobileRequestsByFilterInPageAsync(string text, int pageIndex, int pageSize, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BankToMobileRequestDTO>>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BankToMobileRequestDTO> response = ((IBankToMobileRequestService)result.AsyncState).EndFindThirdPartyNotifiableBankToMobileRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindThirdPartyNotifiableBankToMobileRequestsByFilterInPage(text, pageIndex, pageSize, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankToMobileRequestDTO> AddBankToMobileRequestAsync(BankToMobileRequestDTO bankToMobileRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankToMobileRequestDTO>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankToMobileRequestDTO response = ((IBankToMobileRequestService)result.AsyncState).EndAddBankToMobileRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBankToMobileRequest(bankToMobileRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBankToMobileRequestResponseAsync(Guid bankToMobileRequestId, string outgoingPlainTextPayload, string outgoingCipherTextPayload, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankToMobileRequestService)result.AsyncState).EndUpdateBankToMobileRequestResponse(result);

                    tcs.TrySetResult(false);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBankToMobileRequestResponse(bankToMobileRequestId, outgoingPlainTextPayload, outgoingCipherTextPayload, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBankToMobileRequestIPNStatusAsync(Guid bankToMobileRequestId, int ipnStatus, string ipnResponse, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankToMobileRequestService)result.AsyncState).EndUpdateBankToMobileRequestIPNStatus(result);

                    tcs.TrySetResult(false);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBankToMobileRequestIPNStatus(bankToMobileRequestId, ipnStatus, ipnResponse, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ResetBankToMobileRequestsIPNStatusAsync(Guid[] bankToMobileRequestIds, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBankToMobileRequestService)result.AsyncState).EndResetBankToMobileRequestsIPNStatus(result);

                    tcs.TrySetResult(false);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginResetBankToMobileRequestsIPNStatus(bankToMobileRequestIds, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BankToMobileRequestDTO> FindBankToMobileRequestAsync(Guid bankToMobileRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BankToMobileRequestDTO>();

            IBankToMobileRequestService service = GetService<IBankToMobileRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BankToMobileRequestDTO response = ((IBankToMobileRequestService)result.AsyncState).EndFindBankToMobileRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBankToMobileRequest(bankToMobileRequestId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region BrokerRequestDTO

        public Task<PageCollectionInfo<BrokerRequestDTO>> FindBrokerRequestsByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BrokerRequestDTO>>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BrokerRequestDTO> response = ((IBrokerRequestService)result.AsyncState).EndFindBrokerRequestsByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBrokerRequestsByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<BrokerRequestDTO>> FindThirdPartyNotifiableBrokerRequestsByFilterInPageAsync(string text, int pageIndex, int pageSize, int daysCap, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<BrokerRequestDTO>>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<BrokerRequestDTO> response = ((IBrokerRequestService)result.AsyncState).EndFindThirdPartyNotifiableBrokerRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindThirdPartyNotifiableBrokerRequestsByFilterInPage(text, pageIndex, pageSize, daysCap, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BrokerRequestDTO> AddBrokerRequestAsync(BrokerRequestDTO brokerRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BrokerRequestDTO>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BrokerRequestDTO response = ((IBrokerRequestService)result.AsyncState).EndAddBrokerRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    }, true);
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddBrokerRequest(brokerRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBrokerRequestResponseAsync(Guid brokerRequestId, string outgoingPlainTextPayload, string outgoingCipherTextPayload, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBrokerRequestService)result.AsyncState).EndUpdateBrokerRequestResponse(result);

                    tcs.TrySetResult(false);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBrokerRequestResponse(brokerRequestId, outgoingPlainTextPayload, outgoingCipherTextPayload, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateBrokerRequestIPNStatusAsync(Guid brokerRequestId, int ipnStatus, string ipnResponse, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBrokerRequestService)result.AsyncState).EndUpdateBrokerRequestIPNStatus(result);

                    tcs.TrySetResult(false);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateBrokerRequestIPNStatus(brokerRequestId, ipnStatus, ipnResponse, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ResetBrokerRequestsIPNStatusAsync(Guid[] brokerRequestIds, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IBrokerRequestService)result.AsyncState).EndResetBrokerRequestsIPNStatus(result);

                    tcs.TrySetResult(false);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginResetBrokerRequestsIPNStatus(brokerRequestIds, asyncCallback, service);

            return tcs.Task;
        }

        public Task<BrokerRequestDTO> FindBrokerRequestAsync(Guid brokerRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BrokerRequestDTO>();

            IBrokerRequestService service = GetService<IBrokerRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BrokerRequestDTO response = ((IBrokerRequestService)result.AsyncState).EndFindBrokerRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindBrokerRequest(brokerRequestId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region TransactionThresholdDTO

        public Task<ObservableCollection<TransactionThresholdDTO>> FindTransactionThresholdCollectionByDesignationIdAsync(Guid designationId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TransactionThresholdDTO>>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TransactionThresholdDTO> response = ((IDesignationService)result.AsyncState).EndFindTransactionThresholdCollectionByDesignationId(result);

                    tcs.TrySetResult(new ObservableCollection<TransactionThresholdDTO>(response ?? new List<TransactionThresholdDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTransactionThresholdCollectionByDesignationId(designationId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<TransactionThresholdDTO>> FindTransactionThresholdCollectionByDesignationIdAndTransactionThresholdTypeAsync(Guid designationId, int transactionThresholdType, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<TransactionThresholdDTO>>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<TransactionThresholdDTO> response = ((IDesignationService)result.AsyncState).EndFindTransactionThresholdCollectionByDesignationIdAndTransactionThresholdType(result);

                    tcs.TrySetResult(new ObservableCollection<TransactionThresholdDTO>(response ?? new List<TransactionThresholdDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindTransactionThresholdCollectionByDesignationIdAndTransactionThresholdType(designationId, transactionThresholdType, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateTransactionThresholdCollectionByDesignationIdAsync(Guid designationId, ObservableCollection<TransactionThresholdDTO> transactionThresholdCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDesignationService)result.AsyncState).EndUpdateTransactionThresholdCollectionByDesignationId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateTransactionThresholdCollectionByDesignationId(designationId, transactionThresholdCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ValidateTransactionThresholdByDesignationIdAsync(Guid designationId, int transactionThresholdType, decimal transactionAmount, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDesignationService service = GetService<IDesignationService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDesignationService)result.AsyncState).EndValidateTransactionThreshold(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginValidateTransactionThreshold(designationId, transactionThresholdType, transactionAmount, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EducationVenueDTO

        public Task<PageCollectionInfo<EducationVenueDTO>> FindEducationVenuesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EducationVenueDTO>>();

            IEducationVenueService service = GetService<IEducationVenueService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EducationVenueDTO> response = ((IEducationVenueService)result.AsyncState).EndFindEducationVenuesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationVenuesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EducationVenueDTO>> FindEducationVenuesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EducationVenueDTO>>();

            IEducationVenueService service = GetService<IEducationVenueService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EducationVenueDTO> response = ((IEducationVenueService)result.AsyncState).EndFindEducationVenuesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationVenuesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EducationVenueDTO> AddEducationVenueAsync(EducationVenueDTO educationVenueDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EducationVenueDTO>();

            IEducationVenueService service = GetService<IEducationVenueService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EducationVenueDTO response = ((IEducationVenueService)result.AsyncState).EndAddEducationVenue(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEducationVenue(educationVenueDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEducationVenueAsync(EducationVenueDTO educationVenueDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEducationVenueService service = GetService<IEducationVenueService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEducationVenueService)result.AsyncState).EndUpdateEducationVenue(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEducationVenue(educationVenueDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EducationVenueDTO> FindEducationVenueAsync(Guid educationVenueId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EducationVenueDTO>();

            IEducationVenueService service = GetService<IEducationVenueService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EducationVenueDTO response = ((IEducationVenueService)result.AsyncState).EndFindEducationVenue(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationVenue(educationVenueId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EducationRegisterDTO

        public Task<PageCollectionInfo<EducationRegisterDTO>> FindEducationRegistersByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EducationRegisterDTO>>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EducationRegisterDTO> response = ((IEducationRegisterService)result.AsyncState).EndFindEducationRegistersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationRegistersByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EducationRegisterDTO> AddEducationRegisterAsync(EducationRegisterDTO educationRegisterDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EducationRegisterDTO>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EducationRegisterDTO response = ((IEducationRegisterService)result.AsyncState).EndAddEducationRegister(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEducationRegister(educationRegisterDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEducationRegisterAsync(EducationRegisterDTO educationRegisterDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEducationRegisterService)result.AsyncState).EndUpdateEducationRegister(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEducationRegister(educationRegisterDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EducationRegisterDTO> FindEducationRegisterAsync(Guid educationRegisterId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EducationRegisterDTO>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EducationRegisterDTO response = ((IEducationRegisterService)result.AsyncState).EndFindEducationRegister(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationRegister(educationRegisterId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EducationAttendeeDTO>> FindEducationAttendeesByEducationRegisterIdAsync(Guid educationRegisterId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EducationAttendeeDTO>>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EducationAttendeeDTO> response = ((IEducationRegisterService)result.AsyncState).EndFindEducationAttendeesByEducationRegisterId(result);

                    tcs.TrySetResult(new ObservableCollection<EducationAttendeeDTO>(response ?? new List<EducationAttendeeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationAttendeesByEducationRegisterId(educationRegisterId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EducationAttendeeDTO>> FindEducationAttendeesByEducationRegisterIdInPageAsync(Guid educationRegisterId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EducationAttendeeDTO>>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EducationAttendeeDTO> response = ((IEducationRegisterService)result.AsyncState).EndFindEducationAttendeesByEducationRegisterIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEducationAttendeesByEducationRegisterIdInPage(educationRegisterId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EducationAttendeeDTO> AddEducationAttendeeAsync(EducationAttendeeDTO educationAttendeeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EducationAttendeeDTO>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EducationAttendeeDTO response = ((IEducationRegisterService)result.AsyncState).EndAddEducationAttendee(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEducationAttendee(educationAttendeeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveEducationAttendeesAsync(ObservableCollection<EducationAttendeeDTO> educationAttendeeDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEducationRegisterService)result.AsyncState).EndRemoveEducationAttendees(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveEducationAttendees(educationAttendeeDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateMicroCreditMemberGroupCollectionByEducationRegisterIdAsync(Guid educationRegisterId, ObservableCollection<EducationAttendeeDTO> educationAttendeeCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEducationRegisterService service = GetService<IEducationRegisterService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEducationRegisterService)result.AsyncState).EndUpdateEducationAttendeeCollectionByEducationRegisterId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEducationAttendeeCollectionByEducationRegisterId(educationRegisterId, educationAttendeeCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region GeneralLedgerDTO

        public Task<PageCollectionInfo<GeneralLedgerDTO>> FindGeneralLedgersByStatusAndFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerDTO>>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerDTO> response = ((IGeneralLedgerService)result.AsyncState).EndFindGeneralLedgersByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgersByStatusAndFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerDTO>> FindGeneralLedgersInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerDTO>>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerDTO> response = ((IGeneralLedgerService)result.AsyncState).EndFindGeneralLedgersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgersInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerDTO>> FindGeneralLedgersByDateRangeAndFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerDTO>>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerDTO> response = ((IGeneralLedgerService)result.AsyncState).EndFindGeneralLedgersByDateRangeAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgersByDateRangeAndFilterInPage(startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<GeneralLedgerEntryDTO>> FindGeneralLedgerEntriesByGeneralLedgerIdAsync(Guid generalLedgerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<GeneralLedgerEntryDTO>>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<GeneralLedgerEntryDTO> response = ((IGeneralLedgerService)result.AsyncState).EndFindGeneralLedgerEntriesByGeneralLedgerId(result);

                    tcs.TrySetResult(new ObservableCollection<GeneralLedgerEntryDTO>(response ?? new List<GeneralLedgerEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerEntriesByGeneralLedgerId(generalLedgerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<GeneralLedgerEntryDTO>> FindGeneralLedgerEntriesByGeneralLedgerIdInPageAsync(Guid generalLedgerId, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<GeneralLedgerEntryDTO>>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<GeneralLedgerEntryDTO> response = ((IGeneralLedgerService)result.AsyncState).EndFindGeneralLedgerEntriesByGeneralLedgerIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedgerEntriesByGeneralLedgerIdInPage(generalLedgerId, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<GeneralLedgerDTO> AddGeneralLedgerAsync(GeneralLedgerDTO generalLedgerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<GeneralLedgerDTO>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    GeneralLedgerDTO response = ((IGeneralLedgerService)result.AsyncState).EndAddGeneralLedger(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddGeneralLedger(generalLedgerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<GeneralLedgerDTO> FindGeneralLedgerAsync(Guid generalLedgerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<GeneralLedgerDTO>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    GeneralLedgerDTO response = ((IGeneralLedgerService)result.AsyncState).EndFindGeneralLedger(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGeneralLedger(generalLedgerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<GeneralLedgerEntryDTO> AddGeneralLedgerEntryAsync(GeneralLedgerEntryDTO generalLedgerEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<GeneralLedgerEntryDTO>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    GeneralLedgerEntryDTO response = ((IGeneralLedgerService)result.AsyncState).EndAddGeneralLedgerEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddGeneralLedgerEntry(generalLedgerEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateGeneralLedgerAsync(GeneralLedgerDTO generalLedgerDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IGeneralLedgerService)result.AsyncState).EndUpdateGeneralLedger(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateGeneralLedger(generalLedgerDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveGeneralLedgerEntriesAsync(ObservableCollection<GeneralLedgerEntryDTO> generalLedgerEntries, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IGeneralLedgerService)result.AsyncState).EndRemoveGeneralLedgerEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveGeneralLedgerEntries(generalLedgerEntries.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditGeneralLedgerAsync(GeneralLedgerDTO generalLedgerDTO, int generalLedgerAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IGeneralLedgerService)result.AsyncState).EndAuditGeneralLedger(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditGeneralLedger(generalLedgerDTO, generalLedgerAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuthorizeGeneralLedgerAsync(GeneralLedgerDTO generalLedgerDTO, int generalLedgerAuthOption, int moduleNavigationItemCode, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IGeneralLedgerService)result.AsyncState).EndAuthorizeGeneralLedger(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuthorizeGeneralLedger(generalLedgerDTO, generalLedgerAuthOption, moduleNavigationItemCode, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateGeneralLedgerEntryCollectionAsync(Guid generalLedgerId, ObservableCollection<GeneralLedgerEntryDTO> generalLedgerEntryCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IGeneralLedgerService)result.AsyncState).EndUpdateGeneralLedgerEntryCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateGeneralLedgerEntryCollection(generalLedgerId, generalLedgerEntryCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<BatchImportParseInfo> ParseGeneralLedgerImportEntriesAsync(GeneralLedgerEntryDTO generalLedgerEntryDTO, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<BatchImportParseInfo>();

            IGeneralLedgerService service = GetService<IGeneralLedgerService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    BatchImportParseInfo response = ((IGeneralLedgerService)result.AsyncState).EndParseGeneralLedgerImportEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseGeneralLedgerImportEntries(generalLedgerEntryDTO, fileName, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ConditionalLendingDTO

        public Task<ObservableCollection<ConditionalLendingEntryDTO>> FindConditionalLendingEntriesByCustomerIdAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ConditionalLendingEntryDTO>>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ConditionalLendingEntryDTO> response = ((IConditionalLendingService)result.AsyncState).EndFindConditionalLendingEntriesByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<ConditionalLendingEntryDTO>(response ?? new List<ConditionalLendingEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindConditionalLendingEntriesByCustomerId(customerId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ConditionalLendingDTO>> FindConditionalLendingsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ConditionalLendingDTO>>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ConditionalLendingDTO> response = ((IConditionalLendingService)result.AsyncState).EndFindConditionalLendingsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindConditionalLendingsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ConditionalLendingEntryDTO>> FindConditionalLendingEntriesByConditionalLendingIdAsync(Guid conditionalLendingId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ConditionalLendingEntryDTO>>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ConditionalLendingEntryDTO> response = ((IConditionalLendingService)result.AsyncState).EndFindConditionalLendingEntriesByConditionalLendingId(result);

                    tcs.TrySetResult(new ObservableCollection<ConditionalLendingEntryDTO>(response ?? new List<ConditionalLendingEntryDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindConditionalLendingEntriesByConditionalLendingId(conditionalLendingId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ConditionalLendingEntryDTO>> FindConditionalLendingEntriesByConditionalLendingIdInPageAsync(Guid conditionalLendingId, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ConditionalLendingEntryDTO>>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ConditionalLendingEntryDTO> response = ((IConditionalLendingService)result.AsyncState).EndFindConditionalLendingEntriesByConditionalLendingIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindConditionalLendingEntriesByConditionalLendingIdInPage(conditionalLendingId, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ConditionalLendingDTO> AddConditionalLendingAsync(ConditionalLendingDTO conditionalLendingDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ConditionalLendingDTO>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ConditionalLendingDTO response = ((IConditionalLendingService)result.AsyncState).EndAddConditionalLending(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddConditionalLending(conditionalLendingDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateConditionalLendingAsync(ConditionalLendingDTO conditionalLendingDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IConditionalLendingService)result.AsyncState).EndUpdateConditionalLending(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateConditionalLending(conditionalLendingDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ConditionalLendingEntryDTO> AddConditionalLendingEntryAsync(ConditionalLendingEntryDTO conditionalLendingEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ConditionalLendingEntryDTO>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ConditionalLendingEntryDTO response = ((IConditionalLendingService)result.AsyncState).EndAddConditionalLendingEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddConditionalLendingEntry(conditionalLendingEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveConditionalLendingEntriesAsync(ObservableCollection<ConditionalLendingEntryDTO> conditionalLendingEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IConditionalLendingService)result.AsyncState).EndRemoveConditionalLendingEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveConditionalLendingEntries(conditionalLendingEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateConditionalLendingEntryCollectionByConditionalLendingIdAsync(Guid conditionalLendingId, ObservableCollection<ConditionalLendingEntryDTO> conditionalLendingEntryCollection, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IConditionalLendingService)result.AsyncState).EndUpdateConditionalLendingEntryCollection(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateConditionalLendingEntryCollection(conditionalLendingId, conditionalLendingEntryCollection.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> FetchCustomerConditionalLendingStatusAsync(Guid customerId, Guid loanProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IConditionalLendingService service = GetService<IConditionalLendingService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IConditionalLendingService)result.AsyncState).EndFetchCustomerConditionalLendingStatus(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFetchCustomerConditionalLendingStatus(customerId, loanProductId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region AlternateChannelReconciliationPeriodDTO

        public Task<PageCollectionInfo<AlternateChannelReconciliationPeriodDTO>> FindAlternateChannelReconciliationPeriodsByFilterInPageAsync(int status, DateTime startDate, DateTime endDate, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelReconciliationPeriodDTO>>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelReconciliationPeriodDTO> response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndFindAlternateChannelReconciliationPeriodsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelReconciliationPeriodsByFilterInPage(status, startDate, endDate, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AlternateChannelReconciliationPeriodDTO>> FindAlternateChannelReconciliationPeriodsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelReconciliationPeriodDTO>>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelReconciliationPeriodDTO> response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndFindAlternateChannelReconciliationPeriodsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelReconciliationPeriodsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AlternateChannelReconciliationPeriodDTO> AddAlternateChannelReconciliationPeriodAsync(AlternateChannelReconciliationPeriodDTO alternateChannelReconciliationPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AlternateChannelReconciliationPeriodDTO>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AlternateChannelReconciliationPeriodDTO response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndAddAlternateChannelReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAlternateChannelReconciliationPeriod(alternateChannelReconciliationPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAlternateChannelReconciliationPeriodAsync(AlternateChannelReconciliationPeriodDTO alternateChannelReconciliationPeriodDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndUpdateAlternateChannelReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAlternateChannelReconciliationPeriod(alternateChannelReconciliationPeriodDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AlternateChannelReconciliationPeriodDTO> FindAlternateChannelReconciliationPeriodAsync(Guid alternateChannelReconciliationPeriodId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AlternateChannelReconciliationPeriodDTO>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AlternateChannelReconciliationPeriodDTO response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndFindAlternateChannelReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelReconciliationPeriod(alternateChannelReconciliationPeriodId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AlternateChannelReconciliationEntryDTO>> FindAlternateChannelReconciliationEntriesByAlternateChannelReconciliationPeriodIdAndFilterInPageAsync(Guid alternateChannelReconciliationPeriodId, int status, string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AlternateChannelReconciliationEntryDTO>>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AlternateChannelReconciliationEntryDTO> response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndFindAlternateChannelReconciliationEntriesByAlternateChannelReconciliationPeriodIdAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAlternateChannelReconciliationEntriesByAlternateChannelReconciliationPeriodIdAndFilterInPage(alternateChannelReconciliationPeriodId, status, text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AlternateChannelReconciliationEntryDTO> AddAlternateChannelReconciliationEntryAsync(AlternateChannelReconciliationEntryDTO alternateChannelReconciliationEntryDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AlternateChannelReconciliationEntryDTO>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AlternateChannelReconciliationEntryDTO response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndAddAlternateChannelReconciliationEntry(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAlternateChannelReconciliationEntry(alternateChannelReconciliationEntryDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveAlternateChannelReconciliationEntriesAsync(ObservableCollection<AlternateChannelReconciliationEntryDTO> alternateChannelReconciliationEntryDTOs, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndRemoveAlternateChannelReconciliationEntries(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveAlternateChannelReconciliationEntries(alternateChannelReconciliationEntryDTOs.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CloseAlternateChannelReconciliationPeriodAsync(AlternateChannelReconciliationPeriodDTO alternateChannelReconciliationPeriodDTO, int alternateChannelReconciliationPeriodAuthOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndCloseAlternateChannelReconciliationPeriod(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCloseAlternateChannelReconciliationPeriod(alternateChannelReconciliationPeriodDTO, alternateChannelReconciliationPeriodAuthOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<BatchImportEntryWrapper>> ParseAlternateChannelReconciliationImportAsync(Guid alternateChannelReconciliationPeriodId, string fileName, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<BatchImportEntryWrapper>>();

            IAlternateChannelReconciliationPeriodService service = GetService<IAlternateChannelReconciliationPeriodService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<BatchImportEntryWrapper> response = ((IAlternateChannelReconciliationPeriodService)result.AsyncState).EndParseAlternateChannelReconciliationImport(result);

                    tcs.TrySetResult(new ObservableCollection<BatchImportEntryWrapper>(response ?? new List<BatchImportEntryWrapper>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginParseAlternateChannelReconciliationImport(alternateChannelReconciliationPeriodId, fileName, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region AccountClosureRequestDTO

        public Task<PageCollectionInfo<AccountClosureRequestDTO>> FindAccountClosureRequestsByStatusAndFilterInPageAsync(DateTime startDate, DateTime endDate, int status, string text, int customerFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AccountClosureRequestDTO>>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AccountClosureRequestDTO> response = ((IAccountClosureRequestService)result.AsyncState).EndFindAccountClosureRequestsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAccountClosureRequestsByStatusAndFilterInPage(startDate, endDate, status, text, customerFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AccountClosureRequestDTO>> FindAccountClosureRequestsInPageAsync(int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AccountClosureRequestDTO>>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AccountClosureRequestDTO> response = ((IAccountClosureRequestService)result.AsyncState).EndFindAccountClosureRequestsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAccountClosureRequestsInPage(pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AccountClosureRequestDTO>> FindAccountClosureRequestsByFilterInPageAsync(string text, int customerFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AccountClosureRequestDTO>>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AccountClosureRequestDTO> response = ((IAccountClosureRequestService)result.AsyncState).EndFindAccountClosureRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAccountClosureRequestsByFilterInPage(text, customerFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AccountClosureRequestDTO> AddAccountClosureRequestAsync(AccountClosureRequestDTO accountClosureRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AccountClosureRequestDTO>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AccountClosureRequestDTO response = ((IAccountClosureRequestService)result.AsyncState).EndAddAccountClosureRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAccountClosureRequest(accountClosureRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> ApproveAccountClosureRequestAsync(AccountClosureRequestDTO accountClosureRequestDTO, int accountClosureApprovalOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAccountClosureRequestService)result.AsyncState).EndApproveAccountClosureRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginApproveAccountClosureRequest(accountClosureRequestDTO, accountClosureApprovalOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> AuditAccountClosureRequestAsync(AccountClosureRequestDTO accountClosureRequestDTO, int accountClosureAuditOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAccountClosureRequestService)result.AsyncState).EndAuditAccountClosureRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAuditAccountClosureRequest(accountClosureRequestDTO, accountClosureAuditOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> SettleAccountClosureRequestAsync(AccountClosureRequestDTO accountClosureRequestDTO, int accountClosureSettlementOption, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAccountClosureRequestService)result.AsyncState).EndSettleAccountClosureRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginSettleAccountClosureRequest(accountClosureRequestDTO, accountClosureSettlementOption, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AccountClosureRequestDTO> FindAccountClosureRequestAsync(Guid accountClosureRequestId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AccountClosureRequestDTO>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AccountClosureRequestDTO response = ((IAccountClosureRequestService)result.AsyncState).EndFindAccountClosureRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAccountClosureRequest(accountClosureRequestId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }


        public Task<bool> UpdateAccountClosureRequestAsync(AccountClosureRequestDTO accountClosureRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAccountClosureRequestService service = GetService<IAccountClosureRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAccountClosureRequestService)result.AsyncState).EndUpdateAccountclosureRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAccountclosureRequest(accountClosureRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FixedDepositTypeDTO

        public Task<PageCollectionInfo<FixedDepositTypeDTO>> FindFixedDepositTypesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositTypeDTO>>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositTypeDTO> response = ((IFixedDepositTypeService)result.AsyncState).EndFindFixedDepositTypesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositTypesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<FixedDepositTypeDTO>> FindFixedDepositTypesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<FixedDepositTypeDTO>>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<FixedDepositTypeDTO> response = ((IFixedDepositTypeService)result.AsyncState).EndFindFixedDepositTypesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositTypesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FixedDepositTypeDTO> AddFixedDepositTypeAsync(FixedDepositTypeDTO fixedDepositTypeDTO, bool enforceFixedDepositBands, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FixedDepositTypeDTO>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FixedDepositTypeDTO response = ((IFixedDepositTypeService)result.AsyncState).EndAddFixedDepositType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddFixedDepositType(fixedDepositTypeDTO, enforceFixedDepositBands, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateFixedDepositTypeAsync(FixedDepositTypeDTO fixedDepositTypeDTO, bool enforceFixedDepositBands, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositTypeService)result.AsyncState).EndUpdateFixedDepositType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateFixedDepositType(fixedDepositTypeDTO, enforceFixedDepositBands, asyncCallback, service);

            return tcs.Task;
        }

        public Task<FixedDepositTypeDTO> FindFixedDepositTypeAsync(Guid fixedDepositTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<FixedDepositTypeDTO>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    FixedDepositTypeDTO response = ((IFixedDepositTypeService)result.AsyncState).EndFindFixedDepositType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositType(fixedDepositTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<List<FixedDepositTypeDTO>> FindFixedDepositTypesByMonthsAsync(int months, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<List<FixedDepositTypeDTO>>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<FixedDepositTypeDTO> response = ((IFixedDepositTypeService)result.AsyncState).EndFindFixedDepositTypesByMonths(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindFixedDepositTypesByMonths(months, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LevyDTO>> FindLeviesByFixedDepositTypeIdAsync(Guid fixedDepositTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LevyDTO>>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LevyDTO> response = ((IFixedDepositTypeService)result.AsyncState).EndFindLeviesByFixedDepositTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<LevyDTO>(response ?? new List<LevyDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLeviesByFixedDepositTypeId(fixedDepositTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLeviesByFixedDepositTypeIdAsync(Guid fixedDepositTypeId, ObservableCollection<LevyDTO> levies, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositTypeService)result.AsyncState).EndUpdateLeviesByFixedDepositTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLeviesByFixedDepositTypeId(fixedDepositTypeId, levies.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        public Task<ProductCollectionInfo> FindAttachedProductsByFixedDepositTypeIdAsync(Guid fixedDepositTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ProductCollectionInfo>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ProductCollectionInfo response = ((IFixedDepositTypeService)result.AsyncState).EndFindAttachedProductsByFixedDepositTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAttachedProductsByFixedDepositTypeId(fixedDepositTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAttachedProductsByFixedDepositTypeIdAsync(Guid fixedDepositTypeId, ProductCollectionInfo attachedProductsTuple, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositTypeService)result.AsyncState).EndUpdateAttachedProductsByFixedDepositTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAttachedProductsByFixedDepositTypeId(fixedDepositTypeId, attachedProductsTuple, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region FixedDepositTypeGraduatedScaleDTO

        public Task<ObservableCollection<FixedDepositTypeGraduatedScaleDTO>> FindGraduatedScalesByFixedDepositTypeIdAsync(Guid fixedDepositTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<FixedDepositTypeGraduatedScaleDTO>>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<FixedDepositTypeGraduatedScaleDTO> response = ((IFixedDepositTypeService)result.AsyncState).EndFindGraduatedScalesByFixedDepositTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<FixedDepositTypeGraduatedScaleDTO>(response ?? new List<FixedDepositTypeGraduatedScaleDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindGraduatedScalesByFixedDepositTypeId(fixedDepositTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateGraduatedScalesByFixedDepositTypeIdAsync(Guid fixedDepositTypeId, ObservableCollection<FixedDepositTypeGraduatedScaleDTO> graduatedScales, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IFixedDepositTypeService service = GetService<IFixedDepositTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IFixedDepositTypeService)result.AsyncState).EndUpdateGraduatedScalesByFixedDepositTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateGraduatedScalesByFixedDepositTypeId(fixedDepositTypeId, graduatedScales.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region WireTransferTypeDTO

        public Task<PageCollectionInfo<WireTransferTypeDTO>> FindWireTransferTypesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WireTransferTypeDTO>>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WireTransferTypeDTO> response = ((IWireTransferTypeService)result.AsyncState).EndFindWireTransferTypesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferTypesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<WireTransferTypeDTO>> FindWireTransferTypesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<WireTransferTypeDTO>>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<WireTransferTypeDTO> response = ((IWireTransferTypeService)result.AsyncState).EndFindWireTransferTypes(result);

                    tcs.TrySetResult(new ObservableCollection<WireTransferTypeDTO>(response ?? new List<WireTransferTypeDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferTypes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<WireTransferTypeDTO>> FindWireTransferTypesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<WireTransferTypeDTO>>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<WireTransferTypeDTO> response = ((IWireTransferTypeService)result.AsyncState).EndFindWireTransferTypesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindWireTransferTypesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<WireTransferTypeDTO> AddWireTransferTypeAsync(WireTransferTypeDTO wireTransferTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<WireTransferTypeDTO>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    WireTransferTypeDTO response = ((IWireTransferTypeService)result.AsyncState).EndAddWireTransferType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddWireTransferType(wireTransferTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateWireTransferTypeAsync(WireTransferTypeDTO wireTransferTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferTypeService)result.AsyncState).EndUpdateWireTransferType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateWireTransferType(wireTransferTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<CommissionDTO>> FindCommissionsByWireTransferTypeIdAsync(Guid wireTransferTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<CommissionDTO>>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<CommissionDTO> response = ((IWireTransferTypeService)result.AsyncState).EndFindCommissionsByWireTransferTypeId(result);

                    tcs.TrySetResult(new ObservableCollection<CommissionDTO>(response ?? new List<CommissionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindCommissionsByWireTransferTypeId(wireTransferTypeId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateCommissionsByWireTransferTypeIdAsync(Guid wireTransferTypeId, ObservableCollection<CommissionDTO> commissions, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IWireTransferTypeService service = GetService<IWireTransferTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IWireTransferTypeService)result.AsyncState).EndUpdateCommissionsByWireTransferTypeId(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateCommissionsByWireTransferTypeId(wireTransferTypeId, commissions.ExtendedToList(), asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region ElectronicStatementOrderDTO

        public Task<ObservableCollection<ElectronicStatementOrderDTO>> FindElectronicStatementOrdersByCustomerIdAsync(Guid customerId, int customerAccountTypeProductCode, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ElectronicStatementOrderDTO>>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ElectronicStatementOrderDTO> response = ((IElectronicStatementOrderService)result.AsyncState).EndFindElectronicStatementOrdersByCustomerId(result);

                    tcs.TrySetResult(new ObservableCollection<ElectronicStatementOrderDTO>(response ?? new List<ElectronicStatementOrderDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicStatementOrdersByCustomerId(customerId, customerAccountTypeProductCode, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<ElectronicStatementOrderDTO>> FindElectronicStatementOrdersByCustomerAccountIdAsync(Guid customerAccountId, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<ElectronicStatementOrderDTO>>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<ElectronicStatementOrderDTO> response = ((IElectronicStatementOrderService)result.AsyncState).EndFindElectronicStatementOrdersByCustomerAccountId(result);

                    tcs.TrySetResult(new ObservableCollection<ElectronicStatementOrderDTO>(response ?? new List<ElectronicStatementOrderDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicStatementOrdersByCustomerAccountId(customerAccountId, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ElectronicStatementOrderDTO>> FindElectronicStatementOrdersInPageAsync(int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ElectronicStatementOrderDTO>>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ElectronicStatementOrderDTO> response = ((IElectronicStatementOrderService)result.AsyncState).EndFindElectronicStatementOrdersInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicStatementOrdersInPage(pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ElectronicStatementOrderDTO>> FindElectronicStatementOrdersByFilterInPageAsync(string text, int customerFilter, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ElectronicStatementOrderDTO>>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ElectronicStatementOrderDTO> response = ((IElectronicStatementOrderService)result.AsyncState).EndFindElectronicStatementOrdersByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicStatementOrdersByFilterInPage(text, customerFilter, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ElectronicStatementOrderDTO> AddElectronicStatementOrderAsync(ElectronicStatementOrderDTO electronicStatementOrderDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ElectronicStatementOrderDTO>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ElectronicStatementOrderDTO response = ((IElectronicStatementOrderService)result.AsyncState).EndAddElectronicStatementOrder(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddElectronicStatementOrder(electronicStatementOrderDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateElectronicStatementOrderAsync(ElectronicStatementOrderDTO electronicStatementOrderDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IElectronicStatementOrderService)result.AsyncState).EndUpdateElectronicStatementOrder(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateElectronicStatementOrder(electronicStatementOrderDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<ElectronicStatementOrderHistoryDTO>> FindElectronicStatementOrderHistoryByElectronicStatementOrderIdInPageAsync(Guid electronicStatementOrderId, int pageIndex, int pageSize, bool includeProductDescription, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<ElectronicStatementOrderHistoryDTO>>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<ElectronicStatementOrderHistoryDTO> response = ((IElectronicStatementOrderService)result.AsyncState).EndFindElectronicStatementOrderHistoryByElectronicStatementOrderIdInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicStatementOrderHistoryByElectronicStatementOrderIdInPage(electronicStatementOrderId, pageIndex, pageSize, includeProductDescription, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ElectronicStatementOrderHistoryDTO> FindElectronicStatementOrderHistoryAsync(Guid electronicStatementOrderHistoryId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ElectronicStatementOrderHistoryDTO>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    ElectronicStatementOrderHistoryDTO response = ((IElectronicStatementOrderService)result.AsyncState).EndFindElectronicStatementOrderHistory(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindElectronicStatementOrderHistory(electronicStatementOrderHistoryId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> FixSkippedElectronicStatementOrdersAsync(DateTime targetDate, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IElectronicStatementOrderService service = GetService<IElectronicStatementOrderService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IElectronicStatementOrderService)result.AsyncState).EndFixSkippedElectronicStatementOrders(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFixSkippedElectronicStatementOrders(targetDate, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region EmployeeTypeDTO

        public Task<PageCollectionInfo<EmployeeTypeDTO>> FindEmployeeTypesInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeTypeDTO>>();

            IEmployeeTypeService service = GetService<IEmployeeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeTypeDTO> response = ((IEmployeeTypeService)result.AsyncState).EndFindEmployeeTypesInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeTypesInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<EmployeeTypeDTO>> FindEmployeeTypesAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<EmployeeTypeDTO>>();

            IEmployeeTypeService service = GetService<IEmployeeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<EmployeeTypeDTO> response = ((IEmployeeTypeService)result.AsyncState).EndFindEmployeeTypes(result);

                    tcs.TrySetResult(new ObservableCollection<EmployeeTypeDTO>(response));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeTypes(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<EmployeeTypeDTO>> FindEmployeeTypesByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<EmployeeTypeDTO>>();

            IEmployeeTypeService service = GetService<IEmployeeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<EmployeeTypeDTO> response = ((IEmployeeTypeService)result.AsyncState).EndFindEmployeeTypesByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeTypesByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeTypeDTO> AddEmployeeTypeAsync(EmployeeTypeDTO employeeTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeTypeDTO>();

            IEmployeeTypeService service = GetService<IEmployeeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeTypeDTO response = ((IEmployeeTypeService)result.AsyncState).EndAddEmployeeType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddEmployeeType(employeeTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateEmployeeTypeAsync(EmployeeTypeDTO employeeTypeDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IEmployeeTypeService service = GetService<IEmployeeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IEmployeeTypeService)result.AsyncState).EndUpdateEmployeeType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateEmployeeType(employeeTypeDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<EmployeeTypeDTO> FindEmployeeTypeAsync(Guid employeeTypeId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<EmployeeTypeDTO>();

            IEmployeeTypeService service = GetService<IEmployeeTypeService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    EmployeeTypeDTO response = ((IEmployeeTypeService)result.AsyncState).EndFindEmployeeType(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindEmployeeType(employeeTypeId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanRequestDTO

        public Task<LoanRequestDTO> AddLoanRequestAsync(LoanRequestDTO loanRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanRequestDTO>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanRequestDTO response = ((ILoanRequestService)result.AsyncState).EndAddLoanRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanRequest(loanRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> CancelLoanRequestAsync(LoanRequestDTO loanRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanRequestService)result.AsyncState).EndCancelLoanRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginCancelLoanRequest(loanRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RegisterLoanRequestAsync(LoanRequestDTO loanRequestDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanRequestService)result.AsyncState).EndRegisterLoanRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRegisterLoanRequest(loanRequestDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> RemoveLoanRequestAsync(Guid loanRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanRequestService)result.AsyncState).EndRemoveLoanRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginRemoveLoanRequest(loanRequestId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanRequestDTO> FindLoanRequestAsync(Guid loanRequestId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanRequestDTO>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanRequestDTO response = ((ILoanRequestService)result.AsyncState).EndFindLoanRequest(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanRequest(loanRequestId, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanRequestDTO>> FindLoanRequestsByFilterInPageAsync(DateTime startDate, DateTime endDate, string text, int loanRequestFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanRequestDTO>>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanRequestDTO> response = ((ILoanRequestService)result.AsyncState).EndFindLoanRequestsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanRequestsByFilterInPage(startDate, endDate, text, loanRequestFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanRequestDTO>> FindLoanRequestsByStatusAndFilterInPageAsync(DateTime startDate, DateTime endDate, int status, string text, int loanRequestFilter, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanRequestDTO>>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanRequestDTO> response = ((ILoanRequestService)result.AsyncState).EndFindLoanRequestsByStatusAndFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanRequestsByStatusAndFilterInPage(startDate, endDate, status, text, loanRequestFilter, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<ObservableCollection<LoanRequestDTO>> FindLoanRequestsByCustomerIdInProcessAsync(Guid customerId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanRequestDTO>>();

            ILoanRequestService service = GetService<ILoanRequestService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanRequestDTO> response = ((ILoanRequestService)result.AsyncState).EndFindLoanRequestsByCustomerIdInProcess(result);

                    tcs.TrySetResult(new ObservableCollection<LoanRequestDTO>(response ?? new List<LoanRequestDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanRequestsByCustomerIdInProcess(customerId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region AdministrativeDivisionDTO

        public Task<ObservableCollection<AdministrativeDivisionDTO>> FindAdministrativeDivisionsAsync(bool updateDepth, bool traverseTree, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<AdministrativeDivisionDTO>>();

            IAdministrativeDivisionService service = GetService<IAdministrativeDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<AdministrativeDivisionDTO> response = ((IAdministrativeDivisionService)result.AsyncState).EndFindAdministrativeDivisions(result);

                    tcs.TrySetResult(new ObservableCollection<AdministrativeDivisionDTO>(response ?? new List<AdministrativeDivisionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAdministrativeDivisions(updateDepth, traverseTree, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AdministrativeDivisionDTO>> FindAdministrativeDivisionsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AdministrativeDivisionDTO>>();

            IAdministrativeDivisionService service = GetService<IAdministrativeDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AdministrativeDivisionDTO> response = ((IAdministrativeDivisionService)result.AsyncState).EndFindAdministrativeDivisionsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAdministrativeDivisionsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<AdministrativeDivisionDTO>> FindAdministrativeDivisionsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<AdministrativeDivisionDTO>>();

            IAdministrativeDivisionService service = GetService<IAdministrativeDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<AdministrativeDivisionDTO> response = ((IAdministrativeDivisionService)result.AsyncState).EndFindAdministrativeDivisionsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAdministrativeDivisionsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AdministrativeDivisionDTO> AddAdministrativeDivisionAsync(AdministrativeDivisionDTO administrativeDivisionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AdministrativeDivisionDTO>();

            IAdministrativeDivisionService service = GetService<IAdministrativeDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AdministrativeDivisionDTO response = ((IAdministrativeDivisionService)result.AsyncState).EndAddAdministrativeDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddAdministrativeDivision(administrativeDivisionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateAdministrativeDivisionAsync(AdministrativeDivisionDTO administrativeDivisionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IAdministrativeDivisionService service = GetService<IAdministrativeDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IAdministrativeDivisionService)result.AsyncState).EndUpdateAdministrativeDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateAdministrativeDivision(administrativeDivisionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<AdministrativeDivisionDTO> FindAdministrativeDivisionAsync(Guid administrativeDivisionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<AdministrativeDivisionDTO>();

            IAdministrativeDivisionService service = GetService<IAdministrativeDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    AdministrativeDivisionDTO response = ((IAdministrativeDivisionService)result.AsyncState).EndFindAdministrativeDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindAdministrativeDivision(administrativeDivisionId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region DivisionDTO

        public Task<ObservableCollection<DivisionDTO>> FindDivisionsAsync(bool updateDepth, bool traverseTree, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<DivisionDTO>>();

            IDivisionService service = GetService<IDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<DivisionDTO> response = ((IDivisionService)result.AsyncState).EndFindDivisions(result);

                    tcs.TrySetResult(new ObservableCollection<DivisionDTO>(response ?? new List<DivisionDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDivisions(updateDepth, traverseTree, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DivisionDTO>> FindDivisionsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DivisionDTO>>();

            IDivisionService service = GetService<IDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DivisionDTO> response = ((IDivisionService)result.AsyncState).EndFindDivisionsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDivisionsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<DivisionDTO>> FindDivisionsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<DivisionDTO>>();

            IDivisionService service = GetService<IDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<DivisionDTO> response = ((IDivisionService)result.AsyncState).EndFindDivisionsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDivisionsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DivisionDTO> AddDivisionAsync(DivisionDTO divisionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DivisionDTO>();

            IDivisionService service = GetService<IDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DivisionDTO response = ((IDivisionService)result.AsyncState).EndAddDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddDivision(divisionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateDivisionAsync(DivisionDTO divisionDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            IDivisionService service = GetService<IDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((IDivisionService)result.AsyncState).EndUpdateDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateDivision(divisionDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<DivisionDTO> FindDivisionAsync(Guid divisionId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<DivisionDTO>();

            IDivisionService service = GetService<IDivisionService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    DivisionDTO response = ((IDivisionService)result.AsyncState).EndFindDivision(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindDivision(divisionId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion

        #region LoanProductAppraisalProductDTO

        public Task<ObservableCollection<LoanProductAppraisalProductDTO>> FindLoanProductAppraisalProductsAsync(ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<ObservableCollection<LoanProductAppraisalProductDTO>>();

            ILoanProductAppraisalProductService service = GetService<ILoanProductAppraisalProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    List<LoanProductAppraisalProductDTO> response = ((ILoanProductAppraisalProductService)result.AsyncState).EndFindLoanProductAppraisalProducts(result);

                    tcs.TrySetResult(new ObservableCollection<LoanProductAppraisalProductDTO>(response ?? new List<LoanProductAppraisalProductDTO>()));
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductAppraisalProducts(asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanProductAppraisalProductDTO>> FindLoanProductAppraisalProductsByFilterInPageAsync(string text, int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanProductAppraisalProductDTO>>();

            ILoanProductAppraisalProductService service = GetService<ILoanProductAppraisalProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanProductAppraisalProductDTO> response = ((ILoanProductAppraisalProductService)result.AsyncState).EndFindLoanProductAppraisalProductsByFilterInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductAppraisalProductsByFilterInPage(text, pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<PageCollectionInfo<LoanProductAppraisalProductDTO>> FindLoanProductAppraisalProductsInPageAsync(int pageIndex, int pageSize, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<PageCollectionInfo<LoanProductAppraisalProductDTO>>();

            ILoanProductAppraisalProductService service = GetService<ILoanProductAppraisalProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    PageCollectionInfo<LoanProductAppraisalProductDTO> response = ((ILoanProductAppraisalProductService)result.AsyncState).EndFindLoanProductAppraisalProductsInPage(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductAppraisalProductsInPage(pageIndex, pageSize, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanProductAppraisalProductDTO> AddLoanProductAppraisalProductAsync(LoanProductAppraisalProductDTO LoanProductAppraisalProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanProductAppraisalProductDTO>();

            ILoanProductAppraisalProductService service = GetService<ILoanProductAppraisalProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanProductAppraisalProductDTO response = ((ILoanProductAppraisalProductService)result.AsyncState).EndAddLoanProductAppraisalProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginAddLoanProductAppraisalProduct(LoanProductAppraisalProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<bool> UpdateLoanProductAppraisalProductAsync(LoanProductAppraisalProductDTO LoanProductAppraisalProductDTO, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<bool>();

            ILoanProductAppraisalProductService service = GetService<ILoanProductAppraisalProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    bool response = ((ILoanProductAppraisalProductService)result.AsyncState).EndUpdateLoanProductAppraisalProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(false); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginUpdateLoanProductAppraisalProduct(LoanProductAppraisalProductDTO, asyncCallback, service);

            return tcs.Task;
        }

        public Task<LoanProductAppraisalProductDTO> FindLoanProductAppraisalProductAsync(Guid LoanProductAppraisalProductId, ServiceHeader serviceHeader)
        {
            var tcs = new TaskCompletionSource<LoanProductAppraisalProductDTO>();

            ILoanProductAppraisalProductService service = GetService<ILoanProductAppraisalProductService>(serviceHeader);

            AsyncCallback asyncCallback = (result =>
            {
                try
                {
                    LoanProductAppraisalProductDTO response = ((ILoanProductAppraisalProductService)result.AsyncState).EndFindLoanProductAppraisalProduct(result);

                    tcs.TrySetResult(response);
                }
                catch (Exception ex)
                {
                    HandleFault(ex, (msgcb) =>
                    {
                        if (!string.IsNullOrWhiteSpace(msgcb)) tcs.TrySetResult(null); else tcs.TrySetException(ex);
                    });
                }
                finally
                {
                    DisposeService(service as IClientChannel);
                }
            });

            service.BeginFindLoanProductAppraisalProduct(LoanProductAppraisalProductId, asyncCallback, service);

            return tcs.Task;
        }

        #endregion


#if !SILVERLIGHT

        public void SetupServiceProxy<TProxy, TService>(Action<Disposable.IDisposableWrapper<TProxy>> callback, double timeoutMinutes)
            where TProxy : System.ServiceModel.ClientBase<TService>, new()
            where TService : class
        {
            IDisposableWrapper<TProxy> disposableProxy =
                new TProxy()
                .Wrap<TProxy, TService>(timeoutMinutes);

            callback(disposableProxy);
        }

        public IDisposableWrapper<TProxy> SetupServiceProxy<TProxy, TService>(double timeoutMinutes)
            where TProxy : System.ServiceModel.ClientBase<TService>, new()
            where TService : class
        {
            IDisposableWrapper<TProxy> disposableProxy =
               new TProxy()
               .Wrap<TProxy, TService>(timeoutMinutes);

            return disposableProxy;
        }

        public IDisposableWrapper<TProxy> SetupServiceProxy<TProxy, TService>(IEndpointBehavior behavior, double timeoutMinutes)
            where TProxy : System.ServiceModel.ClientBase<TService>, new()
            where TService : class
        {
            IDisposableWrapper<TProxy> disposableProxy =
               new TProxy()
               .Wrap<TProxy, TService>(behavior, timeoutMinutes);

            return disposableProxy;
        }

        public IDisposableWrapper<TProxy> SetupServiceProxy<TProxy, TService>(string endpointConfigurationName, IEndpointBehavior behavior, double timeoutMinutes)
            where TProxy : System.ServiceModel.ClientBase<TService>, new()
            where TService : class
        {
            IDisposableWrapper<TProxy> disposableProxy =
               ((TProxy)Activator.CreateInstance(typeof(TProxy), endpointConfigurationName))
               .Wrap<TProxy, TService>(behavior, timeoutMinutes);

            return disposableProxy;
        }

#endif

        private TChannel GetService<TChannel>(ServiceHeader serviceHeader, double timeoutMinutes = 10d)
        {
            lock (SyncRoot)
            {
                serviceHeader = serviceHeader ?? new ServiceHeader { ApplicationDomainName = DefaultSettings.Instance.CurrentAppDomainName, ApplicationUserName = DefaultSettings.Instance.CurrentAppUserName };

                var endpointConfigurationName = string.Format("{0}", typeof(TChannel));

                ChannelFactory<TChannel> factory = null;

                if (_channelFactoryHashtable.ContainsKey(endpointConfigurationName))
                {
                    factory = (ChannelFactory<TChannel>)_channelFactoryHashtable[endpointConfigurationName];
                }
                else
                {
                    var configurationName = endpointConfigurationName.Substring(endpointConfigurationName.LastIndexOf('.') + 1);

                    factory = new ChannelFactory<TChannel>(configurationName);

                    _channelFactoryHashtable.Add(endpointConfigurationName, factory);
                }

                if (factory.Endpoint.Behaviors.Any())
                    factory.Endpoint.Behaviors.Clear();

                factory.Endpoint.Behaviors.Add(new CustomBehavior(serviceHeader));

                var channel = factory.CreateChannel();

                ((IContextChannel)channel).OperationTimeout = TimeSpan.FromMinutes(timeoutMinutes);

                return channel;
            }
        }

        private void DisposeService(IClientChannel channel)
        {
            try
            {
                if (channel.State != CommunicationState.Faulted)
                {
                    channel.Close();
                }
            }
            finally
            {
                if (channel.State != CommunicationState.Closed)
                {
                    channel.Abort();
                }
            }
        }

        private ChannelFactory<TChannel> GetChannelFactory<TChannel>()
        {
            lock (SyncRoot)
            {
                var endpointConfigurationName = string.Format("{0}", typeof(TChannel));

                ChannelFactory<TChannel> factory = null;

                if (_channelFactoryHashtable.ContainsKey(endpointConfigurationName))
                {
                    factory = (ChannelFactory<TChannel>)_channelFactoryHashtable[endpointConfigurationName];
                }
                else
                {
                    var configurationName = endpointConfigurationName.Substring(endpointConfigurationName.LastIndexOf('.') + 1);

                    factory = new ChannelFactory<TChannel>(configurationName);

                    _channelFactoryHashtable.Add(endpointConfigurationName, factory);
                }

                return factory;
            }
        }

        private void HandleFault(Exception exception, Action<string> callback, bool callerRequiresErrorMessage = false)
        {
#if SILVERLIGHT

            var assemblyAttributes = new AssemblyAttributes();

            if (exception is FaultException<ApplicationServiceError>)
            {
                var fault = exception as FaultException<ApplicationServiceError>;

                _messageService.Show("We're sorry, we've hit an error!", assemblyAttributes.Product, fault.Detail.ErrorMessage, SwiftFinancials.Common.Notification.MessageBoxIcon.Exclamation, SwiftFinancials.Common.Notification.MessageBoxButtons.Ok, (result) =>
                {
                    callback(fault.Detail.ErrorMessage);
                });
            }
            else
            {
                _messageService.Show("We're sorry, we've hit an unexpected error!", assemblyAttributes.Product, exception.Message, SwiftFinancials.Common.Notification.MessageBoxIcon.Exclamation, SwiftFinancials.Common.Notification.MessageBoxButtons.Ok, (result) =>
                {
                    callback(exception.Message);
                });
            }
#else

            if (exception is FaultException<ApplicationServiceError>)
            {
                var fault = exception as FaultException<ApplicationServiceError>;

                _logger.LogError("HandleFault -> {0}", exception, fault.Message);

                callback(callerRequiresErrorMessage ? string.Format("{0}", fault.Detail.ErrorMessage) : null);
            }
            else if (exception is ProtocolException)
            {
                var responseStream = (exception.InnerException as System.Net.WebException).Response.GetResponseStream() as System.IO.MemoryStream;

                if (responseStream != null)
                {
                    var responseBytes = responseStream.ToArray();

                    var responseString = System.Text.Encoding.UTF8.GetString(responseBytes);

                    _logger.LogError("HandleFault -> {0}", exception, responseString);

                    callback(callerRequiresErrorMessage ? string.Format("{0}", responseString) : null);
                }
                else
                {
                    _logger.LogError("HandleFault", exception);

                    callback(callerRequiresErrorMessage ? string.Format("{0}", exception.Message) : null);
                }
            }
            else
            {
                _logger.LogError("HandleFault", exception);

                callback(callerRequiresErrorMessage ? string.Format("{0}", exception.Message) : null);
            }
#endif
        }
    }
}
