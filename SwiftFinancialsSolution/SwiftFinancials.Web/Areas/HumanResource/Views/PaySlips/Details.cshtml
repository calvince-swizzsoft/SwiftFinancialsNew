@model IEnumerable<Application.MainBoundedContext.DTO.HumanResourcesModule.PaySlipDTO>

@{
    ViewBag.Title = "Salary Payslips";
}

<h2>Salary Payslips</h2>

<div class="row mb-3">
    <div class="col-md-3">
        <label for="salaryPeriod" class="form-label">Salary Period:</label>
        <input type="text" class="form-control" id="salaryPeriod" placeholder="Enter Text..." />
    </div>
    <div class="col-md-3">
        <label for="employeeCategory" class="form-label">Employee Category:</label>
        <input type="text" class="form-control" id="employeeCategory" placeholder="Enter Text..." />
    </div>
    <div class="col-md-3">
        <label for="status" class="form-label">Status:</label>
        <input type="text" class="form-control" id="status" placeholder="Enter Text..." />
    </div>
    <div class="col-md-3">
        <label for="remarks" class="form-label">Remarks:</label>
        <input type="text" class="form-control" id="remarks" placeholder="Enter Text..." />
    </div>
</div>

<div class="row mb-3">
    <div class="col-md-3">
        <label for="taxRelief" class="form-label">Tax Relief:</label>
        <input type="text" class="form-control" id="taxRelief" />
    </div>
    <div class="col-md-3">
        <label for="maxProvidentFundRelief" class="form-label">Max. Provident Fund Relief:</label>
        <input type="text" class="form-control" id="maxProvidentFundRelief" />
    </div>
    <div class="col-md-3">
        <label for="maxInsuranceRelief" class="form-label">Max. Insurance Relief:</label>
        <input type="text" class="form-control" id="maxInsuranceRelief" />
    </div>
    <div class="col-md-3">
        <label for="totalNetPay" class="form-label">Total Net Pay:</label>
        <input type="text" class="form-control" id="totalNetPay" />
    </div>
</div>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Card Number</th>
            <th>Salary Group</th>
            <th>Posting Period</th>
            <th>Net Pay</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var payslip in Model)
        {
            <tr class="clickable-row" data-payslip-id="@payslip.Id">
                <td>@payslip.PaddedSalaryCardCardNumber</td>
                <td>@payslip.SalaryCardSalaryGroupDescription</td>
                <td>@payslip.SalaryPeriodPostingPeriodDescription</td>
                <td>@payslip.NetPay.ToString("N2")</td>
            </tr>
        }
    </tbody>
</table>

<script>
    $(".clickable-row").click(function () {
        var payslipId = $(this).data("payslip-id");
        // Load pay slip entries for the selected payslip
        loadPaySlipEntries(payslipId);
    });

    function loadPaySlipEntries(payslipId) {
        // Make an AJAX request to the controller to fetch the pay slip entries
        $.ajax({
            url: "@Url.Action("GetPaySlipEntries", "Payslips")",
            data: { payslipId: payslipId },
            success: function (data) {
                // Update the pay slip entries section of the view with the returned data
                $("#pay-slip-entries").html(data);
            }
        });
    }
</script>

<div class="row">
    <div class="col-md-12">
        <partial name="_PaySlipEntries" model="Model.SelectMany(p => p.PaySlipEntries)" />
    </div>
</div>
