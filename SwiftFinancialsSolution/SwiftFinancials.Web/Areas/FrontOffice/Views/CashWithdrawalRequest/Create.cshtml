@model Application.MainBoundedContext.DTO.FrontOfficeModule.CashWithdrawalRequestDTO


@{
    ViewBag.Title = "Cash Transactions";
    var withdrawalNotificationCategories = ViewBag.WithdrawalNotificationCategorySelectList as List<SelectListItem>;
}

<head>
    <style>
        .nav-tabs .nav-link {
            background-color: transparent;
        }

            .nav-tabs .nav-link.active {
                background-color: #f8f9fa; /* light grey */
            }

        .tab-pane {
            display: none;
        }

            .tab-pane.show {
                display: block;
            }
    </style>
</head>

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-12">
        <h2>Cash Transactions</h2>
        <ol class="breadcrumb">
            <li class="breadcrumb-item">
                @Html.ActionLink("Dashboard", "Index", "Home", new { Area = "" }, null)
            </li>
            <li class="breadcrumb-item">
                @Html.ActionLink("Home", "Index", "CashWithdrawalRequest", new { Area = "FrontOffice" }, null)
            </li>
            <li class="breadcrumb-item active">
                <strong>Cash Transactions</strong>
            </li>
        </ol>
    </div>
</div>

<div class="container-fluid mt-3">
    <div class="card">
        <div class="card-body">
            @using (Html.BeginForm("Create", "CashWithdrawalRequest", new { Area = "FrontOffice" }, FormMethod.Post))
            {
                @Html.AntiForgeryToken()
                <ul class="nav nav-tabs mb-3" id="mainTabs" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" href="#cashDepositTab">Cash Deposit Requests</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" href="#cashWithdrawalTab">Cash Withdrawal Requests</a>
                    </li>
                </ul>

                <div class="tab-content" id="mainTabContent">
                    <div id="cashDepositTab" class="tab-pane fade show active">
                        <div class="card">
                            <div class="card-body">
                                <ul class="nav nav-tabs mt-3" id="cashDepositSubTabs" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" data-toggle="tab" href="#depositRequestsTab">Cash Deposit Requests</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#createDepositRequestTab">Create Cash Deposit Request</a>
                                    </li>
                                </ul>

                                <div class="tab-content mt-3" id="cashDepositSubTabContent">
                                    <div id="depositRequestsTab" class="tab-pane fade show active" role="tabpanel">
                                        <div class="table-responsive">
                                            <table id="cashDepositRequestsTable" class="table table-striped table-bordered table-hover" style="width:100%;">
                                                <tbody>
                                                    <tr>
                                                        <td class="dataTables_empty">
                                                            Loading data from server
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                        @*<h4>Cash Deposit Requests</h4>
                                            @if (Model.CashDepositRequests != null && Model.CashDepositRequests.Any())
                                            {
                                                <table class="table table-striped table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>Actions</th>
                                                            <th>Authorization Status</th>
                                                            <th>Request Type</th>
                                                            <th>Amount</th>
                                                            <th>Customer Account Number</th>
                                                            <th>Customer Name</th>
                                                            <th>Account Number</th>
                                                            <th>Membership Number</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        @foreach (var request in Model.CashDepositRequests)
                                                        {
                                                            <tr>
                                                                <td>
                                                                    <a href="#" class="btn btn-sm btn-primary" title="View"><i class="fa fa-eye"></i></a>
                                                                    <a href="#" class="btn btn-sm btn-success" title="Authorize"><i class="fa fa-check"></i></a>
                                                                    <a href="#" class="btn btn-sm btn-danger" title="Reject"><i class="fa fa-times"></i></a>
                                                                </td>
                                                                <td>@request.StatusDescription</td>
                                                                <td>@request.TypeDescription</td>
                                                                <td>@request.Amount.ToString("N2")</td>
                                                                <td>@request.CustomerAccountFullAccountNumber</td>
                                                                <td>@request.CustomerAccountCustomerFullName</td>
                                                                <td>@request.CustomerAccountCustomerReference1</td>
                                                                <td>@request.CustomerAccountCustomerReference2</td>
                                                            </tr>
                                                        }
                                                    </tbody>
                                                </table>
                                            }
                                            else
                                            {
                                                <p>No cash deposit requests available.</p>
                                            }*@

                                    </div>

                                    <div id="createDepositRequestTab" class="tab-pane fade" role="tabpanel">
                                        <!-- Content for Create Cash Deposit Request form -->
                                        <h4>Create Cash Deposit Request</h4>
                                        <!-- Add your form for creating a new deposit request here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="cashWithdrawalTab" class="tab-pane fade">
                        <div class="card">
                            <div class="card-body">
                                <ul class="nav nav-tabs mt-3" id="cashWithdrawalSubTabs" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" data-toggle="tab" href="#withdrawalRequestsTab">Cash Withdrawal Requests</a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" data-toggle="tab" href="#createWithdrawalRequestTab">Create Cash Withdrawal Request</a>
                                    </li>
                                </ul>

                                <div class="tab-content mt-3" id="cashWithdrawalSubTabContent">
                                    <div id="withdrawalRequestsTab" class="tab-pane fade show active" role="tabpanel">
                                        <div class="table-responsive">
                                            <table id="cashWithdrawalRequestsTable" class="table table-striped table-bordered table-hover" style="width:100%;">
                                                <tbody>
                                                    <tr>
                                                        <td class="dataTables_empty">
                                                            Loading data from server
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <div id="createWithdrawalRequestTab" class="tab-pane fade" role="tabpanel">
                                        <!-- Content for Create Cash Withdrawal Request form -->
                                        <h4>Create Cash Withdrawal Request</h4>
                                        <!-- Add your form for creating a new withdrawal request here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <div style="margin-top: 20px; text-align: right;">
                        <button type="submit" class="btn btn-primary">Process Transaction</button>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<input type='hidden' id='h' name='h' />


@section Styles{
    @Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
    @Styles.Render("~/plugins/wizardStepsStyles")
    @Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
    @Styles.Render("~/plugins/awesomeCheckboxStyles")
    @Styles.Render("~/plugins/clockpickerStyles")
    @Styles.Render("~/plugins/dateRangeStyles")
    @Styles.Render("~/Content/plugins/chosen/chosenStyles")
    @Styles.Render("~/plugins/switcheryStyles")
    @Styles.Render("~/plugins/jasnyBootstrapStyles")
    @Styles.Render("~/plugins/nouiSliderStyles")
    @Styles.Render("~/plugins/dataPickerStyles")
    @Styles.Render("~/Content/plugins/ionRangeSlider/ionRangeStyles")
    @Styles.Render("~/plugins/imagecropperStyles")
    @Styles.Render("~/Content/plugins/colorpicker/colorpickerStyles")
    @Styles.Render("~/plugins/select2Styles")
    @Styles.Render("~/plugins/touchSpinStyles")
    @Styles.Render("~/plugins/tagInputsStyles")
    @Styles.Render("~/plugins/duallistStyles")
}


@section Scripts {

    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/wizardSteps")
    @Scripts.Render("~/plugins/validate")
    @Scripts.Render("~/plugins/typehead")
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/iCheck")
    @Scripts.Render("~/plugins/dataPicker")
    @Scripts.Render("~/plugins/ionRange")
    @Scripts.Render("~/plugins/nouiSlider")
    @Scripts.Render("~/plugins/jasnyBootstrap")
    @Scripts.Render("~/plugins/switchery")
    @Scripts.Render("~/plugins/chosen")
    @Scripts.Render("~/plugins/knob")
    @Scripts.Render("~/plugins/imagecropper")
    @Scripts.Render("~/plugins/colorpicker")
    @Scripts.Render("~/plugins/clockpicker")
    @Scripts.Render("~/plugins/dateRange")
    @Scripts.Render("~/plugins/select2")
    @Scripts.Render("~/plugins/touchSpin")
    @Scripts.Render("~/plugins/tagInputs")
    @Scripts.Render("~/plugins/duallist")



<script>
        $(document).ready(function () {
            $('#mainTabs a').on('click', function (e) {
                e.preventDefault()
                $(this).tab('show')
            })

            $('#cashDepositSubTabs a').on('click', function (e) {
                e.preventDefault()
                $(this).tab('show')
            })

            $('#cashWithdrawalSubTabs a').on('click', function (e) {
                e.preventDefault()
                $(this).tab('show')
            })
        })




    $('#cashDepositRequestsTable').DataTable({
        "sPaginationType": "full_numbers",
        "bProcessing": true,
        "bServerSide": true,
        "sAjaxSource": "@(Url.Action("CashDepositRequestsIndex", "CashWithdrawalRequest", new { Area = "FrontOffice"}))",
        "sServerMethod": "POST",
        "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {

            var requestType = 0;
            var dropDownHtml = `
                        <div class="dropdown">
                            <button style="width: 150px;" class="btn btn-outline-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Action
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
    <a class="dropdown-item" href="/FrontOffice/CashWithdrawalRequest/HandleRequest/${aData.Id}?requestType=${requestType}&isApproval=true">Approve</a>
                    <a class="dropdown-item" href="/FrontOffice/CashWithdrawalRequest/HandleRequest/${aData.Id}?requestType=${requestType}&isApproval=false">Reject</a>
                            </div>
                        </div>`;



            $('td:eq(6)', nRow).html(dropDownHtml);
            return nRow;
        },
        "aoColumns": [
            { "mDataProp": "CustomerAccountCustomerFullName", "sTitle": "Customer Name", "sWidth": "15%" },
            { "mDataProp": "StatusDescription", "sTitle": "Authorization Status", "sWidth": "15%" },
            { "mDataProp": "Amount", "sTitle": "Amounts", "sWidth": "10%" },
            { "mDataProp": "CustomerAccountFullAccountNumber", "sTitle": "Account Number", "sWidth": "15%" },
            { "mDataProp": "CustomerAccountCustomerReference1", "sTitle": "Customer Refernce 1", "sWidth": "10%" },
            { "mDataProp": "CustomerAccountCustomerReference2", "sTitle": "Customer Reference 2", "sWidth": "10%" },
            { "mDataProp": "PostedDate", "sTitle": "Action", "sWidth": "15%", "bSortable": false }
        ],
        "aaSorting": [[1, "desc"]]
    });

           $('#cashWithdrawalRequestsTable').DataTable({
        "sPaginationType": "full_numbers",
        "bProcessing": true,
        "bServerSide": true,
        "sAjaxSource": "@(Url.Action("CashWithdrawalRequestsIndex", "CashWithdrawalRequest", new { Area = "FrontOffice"}))",
        "sServerMethod": "POST",
        "fnRowCallback": function (nRow, aData, iDisplayIndex, iDisplayIndexFull) {


            var requestType = 1;

            var dropDownHtml = `
                        <div class="dropdown">
                            <button style="width: 150px;" class="btn btn-outline-info dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Action
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                 <a class="dropdown-item" href="/FrontOffice/CashWithdrawalRequest/HandleRequest/${aData.Id}?requestType=${requestType}&isApproval=true">Approve</a>
                    <a class="dropdown-item" href="/FrontOffice/CashWithdrawalRequest/HandleRequest/${aData.Id}?requestType=${requestType}&isApproval=false">Reject</a>
                            </div>
                        </div>`;



            $('td:eq(6)', nRow).html(dropDownHtml);
            return nRow;
        },
        "aoColumns": [
            { "mDataProp": "CustomerAccountCustomerFullName", "sTitle": "Customer Name", "sWidth": "15%" },
            { "mDataProp": "StatusDescription", "sTitle": "Authorization Status", "sWidth": "15%" },
            { "mDataProp": "Amount", "sTitle": "Amounts", "sWidth": "10%" },
            { "mDataProp": "CustomerAccountFullAccountNumber", "sTitle": "Account Number", "sWidth": "15%" },
            { "mDataProp": "CustomerAccountCustomerReference1", "sTitle": "Customer Refernce 1", "sWidth": "10%" },
            { "mDataProp": "CustomerAccountCustomerReference2", "sTitle": "Customer Reference 2", "sWidth": "10%" },
            { "mDataProp": "PostedDate", "sTitle": "Action", "sWidth": "15%", "bSortable": false }
        ],
        "aaSorting": [[1, "desc"]]
    });
</script>



}