@model Application.MainBoundedContext.DTO.GeneralLedgerTransaction

@{
    ViewBag.Title = "G/L Account Transactions Journal";
    var accountTypes = ViewBag.CustomerTypeSelectList as List<SelectListItem>;
    var costCenters = ViewBag.CustomerTypeSelectList as List<SelectListItem>;
}

<div class="page-header">
    <h1>G/L Account Transactions Journal</h1>
</div>

<style>
    body {
        font-family: Arial, sans-serif;
    }

    .form-row {
        background-color: #f5f5f5;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 10px;
    }

    .form-group label {
        font-weight: bold;
    }

    .table-container {
        margin-top: 10px;
    }

    .summary-box {
        border: 2px solid #ccc;
        padding: 10px;
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
        background-color: #f9f9f9;
    }

    .pagination-container {
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
    }

    .filter-form {
        margin-top: 10px;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
    }

        .filter-form input, .filter-form select {
            margin-bottom: 10px;
        }
</style>

<!-- Top Filters -->
<div class="form-row">
    <div class="col-md-4 form-group">
        @Html.LabelFor(model => model.GLAccountName, htmlAttributes: new { @class = "control-label" })
        @Html.HiddenFor(model => model.GLAccountId)
        @Html.EditorFor(model => model.GLAccountName, new { htmlAttributes = new { @class = "ChartOfAccountsLookup form-control required", @placeholder = "Enter space to autofill G/L Account" } })
        @Html.ValidationMessageFor(model => model.GLAccountName, "", new { @class = "text-danger" })
    </div>
    <div class="col-md-4 form-group">
        @Html.LabelFor(model => model.GLAccountType, htmlAttributes: new { @class = "control-label" })
        @Html.EditorFor(model => model.GLAccountType, new { htmlAttributes = new { @class = "form-control", @placeholder = "Enter Bank Branch name", @readonly = "readonly" } })
    </div>
    <div class="col-md-4 form-group">
        @Html.LabelFor(model => model.GLAccountCode, htmlAttributes: new { @class = "control-label" })
        @Html.EditorFor(model => model.GLAccountCode, new { htmlAttributes = new { @class = "form-control", @placeholder = "Enter Bank Branch name", @readonly = "readonly" } })
    </div>
</div>

<!-- Transactions Table -->
<div class="table-container">
    <table id="TransactionsGrid" class="table table-striped table-bordered table-hover" width="100%">
        <thead>
            <tr>
                <th>Branch</th>
                <th>Transaction Date</th>
                <th>Primary Description</th>
                <th>Debit</th>
                <th>Credit</th>
                <th>Running Balance</th>
                <th>Contra G/L Account</th>
                <th>Secondary</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td colspan="8" class="dataTables_empty">Loading data from server</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Summary Box -->
<div class="summary-box">
    <div>Balance B/F: <span id="balanceBF">Ksh. 644.45</span></div>
    <div>Debits: <span id="debits">Ksh. 0.00</span></div>
    <div>Credits: <span id="credits">Ksh. 0.00</span></div>
    <div>Balance C/F: <span id="balanceCF">Ksh. 644.45</span></div>
</div>

<!-- Pagination & Items Per Page -->
<div class="pagination-container">
    <div class="items-per-page">
        <label>Items per page:</label>
        <select id="itemsPerPage" class="form-control" style="width: 60px;">
            <option value="15">15</option>
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="100">100</option>
        </select>
    </div>
</div>

<!-- Filter Form -->
<div class="filter-form">
    <div class="form-row">
        <div class="form-group col-md-4">
            <label for="startDate">Start Date</label>
            <input type="text" class="form-control" id="startDate" placeholder="DD/MM/YYYY">
        </div>
        <div class="form-group col-md-4">
            <label for="endDate">End Date</label>
            <input type="text" class="form-control" id="endDate" placeholder="DD/MM/YYYY">
        </div>
        <div class="form-group col-md-4">
            <label for="reference">Reference</label>
            <input type="text" class="form-control" id="reference" placeholder="Enter Reference">
        </div>
    </div>
    <div class="text-right">
        <button type="button" class="btn btn-primary" id="refreshData">Refresh</button>
    </div>
</div>
@section Styles{
    @Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
    @Styles.Render("~/plugins/wizardStepsStyles")
    @Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
    @Styles.Render("~/plugins/awesomeCheckboxStyles")
    @Styles.Render("~/plugins/clockpickerStyles")
    @Styles.Render("~/plugins/dateRangeStyles")
    @Styles.Render("~/Content/plugins/chosen/chosenStyles")
    @Styles.Render("~/plugins/switcheryStyles")
    @Styles.Render("~/plugins/jasnyBootstrapStyles")
    @Styles.Render("~/plugins/nouiSliderStyles")
    @Styles.Render("~/plugins/dataPickerStyles")
    @Styles.Render("~/Content/plugins/ionRangeSlider/ionRangeStyles")
    @Styles.Render("~/plugins/imagecropperStyles")
    @Styles.Render("~/Content/plugins/colorpicker/colorpickerStyles")
    @Styles.Render("~/plugins/select2Styles")
    @Styles.Render("~/plugins/touchSpinStyles")
    @Styles.Render("~/plugins/tagInputsStyles")
    @Styles.Render("~/plugins/duallistStyles")
}

@section Scripts{
    @Scripts.Render("~/plugins/wizardSteps")
    @Scripts.Render("~/plugins/validate")
    @Scripts.Render("~/plugins/typehead")
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/iCheck")
    @Scripts.Render("~/plugins/dataPicker")
    @Scripts.Render("~/plugins/ionRange")
    @Scripts.Render("~/plugins/nouiSlider")
    @Scripts.Render("~/plugins/jasnyBootstrap")
    @Scripts.Render("~/plugins/switchery")
    @Scripts.Render("~/plugins/chosen")
    @Scripts.Render("~/plugins/knob")
    @Scripts.Render("~/plugins/imagecropper")
    @Scripts.Render("~/plugins/colorpicker")
    @Scripts.Render("~/plugins/clockpicker")
    @Scripts.Render("~/plugins/dateRange")
    @Scripts.Render("~/plugins/select2")
    @Scripts.Render("~/plugins/touchSpin")
    @Scripts.Render("~/plugins/tagInputs")
    @Scripts.Render("~/plugins/duallist")

    <script>
        $(document).ready(function () {
            var dataTable = $('#TransactionsGrid').DataTable({
                "sPaginationType": "full_numbers",
                "bProcessing": true,
                "bServerSide": true,
                "sAjaxSource": "@(Url.Action("Index", "TransactionJournals", new { Area = "Accounts" }))",
                "sServerMethod": "POST",
                "fnServerParams": function (aoData) {
                    aoData.push(
                        { "name": "itemsPerPage", "value": $('#itemsPerPage').val() || 15 },
                        { "name": "startDate", "value": $('#startDate').val() || null },
                        { "name": "endDate", "value": $('#endDate').val() || null },
                        { "name": "reference", "value": $('#reference').val() || null }
                    );
                },
                "aoColumns": [
                    { "mDataProp": "BranchDescription", "sTitle": "Branch", "sWidth": "15%" },
                    { "mDataProp": "TransactionDate", "sTitle": "Transaction Date", "sWidth": "15%" },
                    { "mDataProp": "PrimaryDescription", "sTitle": "Primary Description", "sWidth": "20%" },
                    { "mDataProp": "Debit", "sTitle": "Debit", "sWidth": "10%" },
                    { "mDataProp": "Credit", "sTitle": "Credit", "sWidth": "10%" },
                    { "mDataProp": "RunningBalance", "sTitle": "Running Balance", "sWidth": "10%" },
                    { "mDataProp": "ContraGLAccountName", "sTitle": "Contra G/L Account", "sWidth": "10%" },
                    { "mDataProp": "Secondary", "sTitle": "Secondary", "sWidth": "10%" }
                ]
            });

            $('#refreshData').on('click', function (e) {
                e.preventDefault();
                dataTable.ajax.reload();
            });
        });
    </script>
}
