@model Application.MainBoundedContext.DTO.SupplierDTO
@{
    ViewBag.Title = "Create Supplier";
}

<div class="container-fluid">
    <div class="card shadow mb-4">
        <div class="card-header py-3 d-flex justify-content-between align-items-center">
            <h4 class="m-0 font-weight-bold text-primary">Create New Supplier</h4>
            @Html.ActionLink("Back to List", "Index", null, new { @class = "btn btn-secondary btn-sm" })
        </div>

        <div class="card-body">
            @using (Html.BeginForm("Create", "Supplier", FormMethod.Post, new { id = "createSupplierForm", @class = "needs-validation", novalidate = "novalidate" }))
            {
                @Html.AntiForgeryToken()

                <div class="row mb-4">
                    <div class="col-md-6">
                        <h5 class="text-primary mb-3">Basic Information</h5>

                        <div class="form-group">
                            @Html.LabelFor(m => m.Name, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.Name, new { @class = "form-control", placeholder = "Enter supplier name...", required = "required" })
                            <div class="invalid-feedback">Please provide a supplier name.</div>
                        </div>


                    </div>

                    <div class="col-md-6">
                        <h5 class="text-primary mb-3">G/L Account</h5>

                        <div class="form-group">
                            @Html.LabelFor(m => m.ChartofAccountName, new { @class = "font-weight-bold" })
                            @Html.HiddenFor(m => m.ChartOfAccountId)
                            @Html.EditorFor(m => m.ChartofAccountName, new
                            {
                                htmlAttributes = new
                                {
                                    @class = "ChartOfAccountsLookup form-control",
                                    @placeholder = "Enter space to autofill G/L Account"
                                }
                            })
                            @Html.ValidationMessageFor(m => m.ChartofAccountName, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
                <h5 class="text-primary mb-3">Address Information</h5>

                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.LabelFor(m => m.AddressLine1, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.AddressLine1, new { @class = "form-control", placeholder = "Enter address line 1..." })
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(m => m.Email, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.Email, new { @class = "form-control", placeholder = "Enter email address...", type = "email" })
                            <div class="invalid-feedback">Please provide a valid email address.</div>
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(m => m.AddressLine2, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.AddressLine2, new { @class = "form-control", placeholder = "Enter address line 2..." })
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.Street, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.Street, new { @class = "form-control", placeholder = "Enter street..." })
                        </div>

                    </div>


                    <div class="col-md-6">
                        <div class="form-group">
                            @Html.LabelFor(m => m.LandLine, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.LandLine, new { @class = "form-control", placeholder = "Enter landline number..." })
                        </div>

                        <div class="form-group">
                            @Html.LabelFor(m => m.MobileLine, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.MobileLine, new { @class = "form-control", placeholder = "Enter mobile number..." })
                        </div>
                        <div class="form-group">
                            @Html.LabelFor(m => m.PostalCode, new { @class = "font-weight-bold" })
                            @Html.TextBoxFor(m => m.PostalCode, new { @class = "form-control", placeholder = "Enter postal code..." })
                        </div>
                    </div>

                </div>

                <div class="form-actions text-right border-top pt-3">
                    <button type="reset" class="btn btn-light mr-2">
                        <i class="fas fa-undo mr-1"></i> Reset
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save mr-1"></i> Save
                    </button>
                </div>
            }
        </div>
    </div>
</div>

@section Styles {
    @Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
    @Styles.Render("~/plugins/wizardStepsStyles")
    @Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
    @Styles.Render("~/plugins/awesomeCheckboxStyles")
    @Styles.Render("~/plugins/clockpickerStyles")
    @Styles.Render("~/plugins/dateRangeStyles")
    @Styles.Render("~/Content/plugins/chosen/chosenStyles")
    @Styles.Render("~/plugins/switcheryStyles")
    @Styles.Render("~/plugins/jasnyBootstrapStyles")
    @Styles.Render("~/plugins/nouiSliderStyles")
    @Styles.Render("~/plugins/dataPickerStyles")
    @Styles.Render("~/Content/plugins/ionRangeSlider/ionRangeStyles")
    @Styles.Render("~/plugins/imagecropperStyles")
    @Styles.Render("~/Content/plugins/colorpicker/colorpickerStyles")
    @Styles.Render("~/plugins/select2Styles")
    @Styles.Render("~/plugins/touchSpinStyles")
    @Styles.Render("~/plugins/tagInputsStyles")
    @Styles.Render("~/plugins/duallistStyles")
}

@section Scripts {
    @Scripts.Render("~/plugins/wizardSteps")
    @Scripts.Render("~/plugins/validate")
    @Scripts.Render("~/plugins/typehead")
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/iCheck")
    @Scripts.Render("~/plugins/dataPicker")
    @Scripts.Render("~/plugins/ionRange")
    @Scripts.Render("~/plugins/nouiSlider")
    @Scripts.Render("~/plugins/jasnyBootstrap")
    @Scripts.Render("~/plugins/switchery")
    @Scripts.Render("~/plugins/chosen")
    @Scripts.Render("~/plugins/knob")
    @Scripts.Render("~/plugins/imagecropper")
    @Scripts.Render("~/plugins/colorpicker")
    @Scripts.Render("~/plugins/clockpicker")
    @Scripts.Render("~/plugins/dateRange")
    @Scripts.Render("~/plugins/select2")
    @Scripts.Render("~/plugins/touchSpin")
    @Scripts.Render("~/plugins/tagInputs")
    @Scripts.Render("~/plugins/duallist")

    <script>
        $('.ChartOfAccountsLookup').typeahead({
            source: function (query, process) {
                return $.getJSON(
                    '@Url.Action("GetChartOfAccountsAsync", "ChartOfAccount", new { Area = "Accounts" })',
                    { query: query },
                    function (data) {
                        var mapped = [];
                        ChartOfAccountsMap = {};
                        $.each(data, function (i, acc) {
                            mapped.push(acc.AccountName);
                            ChartOfAccountsMap[acc.AccountName] = acc;
                        });
                        process(mapped);
                    });
            },
            matcher: function (item) {
                return item.toLowerCase().includes(this.query.trim().toLowerCase());
            },
            sorter: function (items) {
                return items.sort();
            },
            highlighter: function (item) {
                var regex = new RegExp('(' + this.query + ')', 'gi');
                return item.replace(regex, "<strong>$1</strong>");
            },
            updater: function (item) {
                $('#ChartOfAccountId').val(ChartOfAccountsMap[item].Id);
                return item;
            }
        });
    </script>
}
